function aisresponse(e,t){ais_client.aisresponse(e),ais_client.log("aisresponse: Response Data"+(1==t?" (cache) ":""),!0),ais_client.log(e)}!function(e,t,n){t[e]=t[e]||n(),"undefined"!=typeof module&&module.exports?module.exports=t[e]:"function"==typeof define&&define.amd&&define(function(){return t[e]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function e(e,t){h.add(e,t),d||(d=g(h.drain))}function t(e){var t,n=typeof e;return null==e||"object"!=n&&"function"!=n||(t=e.then),"function"==typeof t?t:!1}function n(){for(var e=0;e<this.chain.length;e++)o(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function o(e,n,o){var i,r;try{n===!1?o.reject(e.msg):(i=n===!0?e.msg:n.call(void 0,e.msg),i===o.promise?o.reject(TypeError("Promise-chain cycle")):(r=t(i))?r.call(i,o.resolve,o.reject):o.resolve(i))}catch(a){o.reject(a)}}function i(o){var a,c=this;if(!c.triggered){c.triggered=!0,c.def&&(c=c.def);try{(a=t(o))?e(function(){var e=new s(c);try{a.call(o,function(){i.apply(e,arguments)},function(){r.apply(e,arguments)})}catch(t){r.call(e,t)}}):(c.msg=o,c.state=1,c.chain.length>0&&e(n,c))}catch(u){r.call(new s(c),u)}}}function r(t){var o=this;o.triggered||(o.triggered=!0,o.def&&(o=o.def),o.msg=t,o.state=2,o.chain.length>0&&e(n,o))}function a(e,t,n,o){for(var i=0;i<t.length;i++)!function(i){e.resolve(t[i]).then(function(e){n(i,e)},o)}(i)}function s(e){this.def=e,this.triggered=!1}function c(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function u(t){if("function"!=typeof t)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var o=new c(this);this.then=function(t,i){var r={success:"function"==typeof t?t:!0,failure:"function"==typeof i?i:!1};return r.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");r.resolve=e,r.reject=t}),o.chain.push(r),0!==o.state&&e(n,o),r.promise},this["catch"]=function(e){return this.then(void 0,e)};try{t.call(void 0,function(e){i.call(o,e)},function(e){r.call(o,e)})}catch(a){r.call(o,a)}}var l,d,h,f=Object.prototype.toString,g="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),l=function(e,t,n,o){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:o!==!1})}}catch(m){l=function(e,t,n){return e[t]=n,e}}h=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,n,o;return{add:function(i,r){o=new e(i,r),n?n.next=o:t=o,n=o,o=void 0},drain:function(){var e=t;for(t=n=d=void 0;e;)e.fn.call(e.self),e=e.next}}}();var p=l({},"constructor",u,!1);return u.prototype=p,l(p,"__NPO__",0,!1),l(u,"resolve",function(e){var t=this;return e&&"object"==typeof e&&1===e.__NPO__?e:new t(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");t(e)})}),l(u,"reject",function(e){return new this(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");n(e)})}),l(u,"all",function(e){var t=this;return"[object Array]"!=f.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t(function(n,o){if("function"!=typeof n||"function"!=typeof o)throw TypeError("Not a function");var i=e.length,r=Array(i),s=0;a(t,e,function(e,t){r[e]=t,++s===i&&n(r)},o)})}),l(u,"race",function(e){var t=this;return"[object Array]"!=f.call(e)?t.reject(TypeError("Not an array")):new t(function(n,o){if("function"!=typeof n||"function"!=typeof o)throw TypeError("Not a function");a(t,e,function(e,t){n(t)},o)})}),u}),function(){"use strict";Object.create||(Object.create=function(e){function t(){}if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");return t.prototype=e,new t})}();var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,o,i,r,a,s=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(c)){for(r=c.length,n=0;r>n;n+=1)a[n]=str(n,c)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;r>n;n+=1)"string"==typeof rep[n]&&(o=rep[n],i=str(o,c),i&&a.push(quote(o)+(gap?": ":":")+i));else for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(i=str(o,c),i&&a.push(quote(o)+(gap?": ":":")+i));return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var o;if(gap="",indent="","number"==typeof n)for(o=0;n>o;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,o,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o=walk(i,n),void 0!==o?i[n]=o:delete i[n]);return reviver.call(e,t,i)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=0,n=this.length;for(t;n>t;t+=1)if(this[t]===e)return t;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){var t=this.length-1;for(t;t>=0;t-=1)if(this[t]===e)return t;return-1})}(),function(){"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,o;if(null==this)throw new TypeError("this is null or not defined");var i=Object(this),r=i.length>>>0;if("[object Function]"!={}.toString.call(e))throw new TypeError(e+" is not a function");for(t&&(n=t),o=0;r>o;){var a;o in i&&(a=i[o],e.call(n,a,o,i)),o++}})}(),function(){"use strict";"undefined"==typeof window.console&&(window.console={});var e=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","trace","warn"],t=function(){console.log(arguments)},n=e.length,o=0;for(o;n>o;o+=1)"undefined"==typeof window.console[e[o]]&&(window.console[e[o]]="log"!==e[o]?t:function(){})}(),window.console&&"undefined"==typeof window.console.time&&(console.time=function(e,t){if(e){var n=(new Date).getTime();console.timeCounters||(console.timeCounters={});var o="KEY"+e.toString();(t||!console.timeCounters[o])&&(console.timeCounters[o]=n)}},console.timeEnd=function(e){var t=(new Date).getTime();if(console.timeCounters){var n,o="KEY"+e.toString(),i=console.timeCounters[o];if(i){n=t-i;var r=e+": "+n+"ms";console.info(r),delete console.timeCounters[o]}return n}}),Date.now||(Date.now=function(){return(new Date).getTime()}),function(e,t){t("object"==typeof exports&&exports?exports:e.Mustache={})}(this,function(e){function t(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return g.call(e,t)}function i(e){return!o(m,e)}function r(e){return String(e).replace(/[&<>"'\/]/g,function(e){return p[e]})}function a(t,o){function r(){if(k&&!A)for(;p.length;)delete m[p.pop()];else p=[];k=!1,A=!1}function a(e){if("string"==typeof e&&(e=e.split(y,2)),!f(e)||2!==e.length)throw new Error("Invalid tags: "+e);l=new RegExp(n(e[0])+"\\s*"),d=new RegExp("\\s*"+n(e[1])),h=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var l,d,h,g=[],m=[],p=[],k=!1,A=!1;a(o||e.tags);for(var T,x,S,B,E,C,L=new u(t);!L.eos();){if(T=L.pos,S=L.scanUntil(l))for(var I=0,z=S.length;z>I;++I)B=S.charAt(I),i(B)?p.push(m.length):A=!0,m.push(["text",B,T,T+1]),T+=1,"\n"===B&&r();if(!L.scan(l))break;if(k=!0,x=L.scan(_)||"name",L.scan(v),"="===x?(S=L.scanUntil(b),L.scan(b),L.scanUntil(d)):"{"===x?(S=L.scanUntil(h),L.scan(w),L.scanUntil(d),x="&"):S=L.scanUntil(d),!L.scan(d))throw new Error("Unclosed tag at "+L.pos);if(E=[x,S,T,L.pos],m.push(E),"#"===x||"^"===x)g.push(E);else if("/"===x){if(C=g.pop(),!C)throw new Error('Unopened section "'+S+'" at '+T);if(C[1]!==S)throw new Error('Unclosed section "'+C[1]+'" at '+T)}else"name"===x||"{"===x||"&"===x?A=!0:"="===x&&a(S)}if(C=g.pop())throw new Error('Unclosed section "'+C[1]+'" at '+L.pos);return c(s(m))}function s(e){for(var t,n,o=[],i=0,r=e.length;r>i;++i)t=e[i],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(o.push(t),n=t));return o}function c(e){for(var t,n,o=[],i=o,r=[],a=0,s=e.length;s>a;++a)switch(t=e[a],t[0]){case"#":case"^":i.push(t),r.push(t),i=t[4]=[];break;case"/":n=r.pop(),n[5]=t[2],i=r.length>0?r[r.length-1][4]:o;break;default:i.push(t)}return o}function u(e){this.string=e,this.tail=e,this.pos=0}function l(e,t){this.view=null==e?{}:e,this.cache={".":this.view},this.parent=t}function d(){this.cache={}}var h=Object.prototype.toString,f=Array.isArray||function(e){return"[object Array]"===h.call(e)},g=RegExp.prototype.test,m=/\S/,p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},v=/\s*/,y=/\s+/,b=/\s*=/,w=/\s*\}/,_=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},u.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},l.prototype.push=function(e){return new l(e,this)},l.prototype.lookup=function(e){var n,o=this.cache;if(e in o)n=o[e];else{for(var i,r,a=this;a;){if(e.indexOf(".")>0)for(n=a.view,i=e.split("."),r=0;null!=n&&r<i.length;)n=n[i[r++]];else n=a.view[e];if(null!=n)break;a=a.parent}o[e]=n}return t(n)&&(n=n.call(this.view)),n},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(e,t){var n=this.cache,o=n[e];return null==o&&(o=n[e]=a(e,t)),o},d.prototype.render=function(e,t,n){var o=this.parse(e),i=t instanceof l?t:new l(t);return this.renderTokens(o,i,n,e)},d.prototype.renderTokens=function(n,o,i,r){function a(e){return l.render(e,o,i)}for(var s,c,u="",l=this,d=0,h=n.length;h>d;++d)switch(s=n[d],s[0]){case"#":if(c=o.lookup(s[1]),!c)continue;if(f(c))for(var g=0,m=c.length;m>g;++g)u+=this.renderTokens(s[4],o.push(c[g]),i,r);else if("object"==typeof c||"string"==typeof c)u+=this.renderTokens(s[4],o.push(c),i,r);else if(t(c)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");c=c.call(o.view,r.slice(s[3],s[5]),a),null!=c&&(u+=c)}else u+=this.renderTokens(s[4],o,i,r);break;case"^":c=o.lookup(s[1]),(!c||f(c)&&0===c.length)&&(u+=this.renderTokens(s[4],o,i,r));break;case">":if(!i)continue;c=t(i)?i(s[1]):i[s[1]],null!=c&&(u+=this.renderTokens(this.parse(c),o,i,c));break;case"&":c=o.lookup(s[1]),null!=c&&(u+=c);break;case"name":c=o.lookup(s[1]),null!=c&&(u+=e.escape(c));break;case"text":u+=s[1]}return u},e.name="mustache.js",e.version="0.8.1",e.tags=["{{","}}"];var k=new d;e.clearCache=function(){return k.clearCache()},e.parse=function(e,t){return k.parse(e,t)},e.render=function(e,t,n){return k.render(e,t,n)},e.to_html=function(n,o,i,r){var a=e.render(n,o,i);return t(r)?void r(a):a},e.escape=r,e.Scanner=u,e.Context=l,e.Writer=d}),function(e){"use strict";function t(t,i){this.settings=e.extend({},o,i),this.modal=t,this.buildDOM(),this.addEventListeners(),this.index=e[n].lookup.push(this)-1,this.busy=!1}var n="remodal",o={hashTracking:!0,closeOnConfirm:!0,closeOnCancel:!0};e[n]={lookup:[]};var i,r,a=function(e){var t=e.css("transition-duration")||e.css("-webkit-transition-duration")||e.css("-moz-transition-duration")||e.css("-o-transition-duration")||e.css("-ms-transition-duration")||0,n=e.css("transition-delay")||e.css("-webkit-transition-delay")||e.css("-moz-transition-delay")||e.css("-o-transition-delay")||e.css("-ms-transition-delay")||0;return 1e3*(parseFloat(t)+parseFloat(n))},s=function(){if(e(document.body).height()<=e(window).height())return 0;var t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",document.body.appendChild(t);var n=t.offsetWidth;t.style.overflow="scroll";var o=document.createElement("div");o.style.width="100%",t.appendChild(o);var i=o.offsetWidth;return t.parentNode.removeChild(t),n-i},c=function(){e(document.body).css("padding-right","+="+s()),e("html, body").addClass(n+"_lock")},u=function(){e(document.body).css("padding-right","-="+s()),e("html, body").removeClass(n+"_lock")},l=function(e){var t,n,o={};t=e.replace(/\s*:\s*/g,":").replace(/\s*,\s*/g,","),n=t.split(",");var i,r,a;for(i=0,r=n.length;r>i;i++)n[i]=n[i].split(":"),a=n[i][1],("string"==typeof a||a instanceof String)&&(a="true"===a||("false"===a?!1:a)),("string"==typeof a||a instanceof String)&&(a=isNaN(a)?a:+a),o[n[i][0]]=a;return o};t.prototype.buildDOM=function(){this.body=e(document.body),this.bg=e("."+n+"-bg"),this.modalClose=e("<a href='#'>").addClass(n+"-close"),this.overlay=e("<div>").addClass(n+"-overlay"),this.modal.hasClass(n)||this.modal.addClass(n),this.modal.css("visibility","visible"),this.modal.append(this.modalClose),this.overlay.append(this.modal),this.body.append(this.overlay),this.confirm=this.modal.find("."+n+"-confirm"),this.cancel=this.modal.find("."+n+"-cancel");var t=a(this.overlay),o=a(this.modal),i=a(this.bg);this.td=o>t?o:t,this.td=i>this.td?i:this.td},t.prototype.addEventListeners=function(){var t=this;this.modalClose.bind("click."+n,function(e){e.preventDefault(),t.close()}),this.cancel.bind("click."+n,function(e){e.preventDefault(),t.modal.trigger("cancel"),t.settings.closeOnCancel&&t.close()}),this.confirm.bind("click."+n,function(e){e.preventDefault(),t.modal.trigger("confirm"),t.settings.closeOnConfirm&&t.close()}),e(document).bind("keyup."+n,function(e){27===e.keyCode&&t.close()}),this.overlay.bind("click."+n,function(o){var i=e(o.target);i.hasClass(n+"-overlay")&&t.close()})},t.prototype.open=function(){if(!this.busy){this.busy=!0,this.modal.trigger("open");var t=this.modal.attr("data-"+n+"-id");t&&this.settings.hashTracking&&(r=e(window).scrollTop(),location.hash=t),i&&i!==this&&(i.overlay.hide(),i.body.removeClass(n+"_active")),i=this,c(),this.overlay.show();var o=this;setTimeout(function(){o.body.addClass(n+"_active"),setTimeout(function(){o.busy=!1,o.modal.trigger("opened")},o.td+50)},25)}},t.prototype.close=function(){if(!this.busy){this.busy=!0,this.modal.trigger("close"),this.settings.hashTracking&&this.modal.attr("data-"+n+"-id")===location.hash.substr(1)&&(location.hash="",e(window).scrollTop(r)),this.body.removeClass(n+"_active");var t=this;setTimeout(function(){t.overlay.hide(),u(),t.busy=!1,t.modal.trigger("closed")},t.td+50)}},e&&(e.fn[n]=function(o){var i;return this.each(function(r,a){var s=e(a);null==s.data(n)&&(i=new t(s,o),s.data(n,i.index),i.settings.hashTracking&&s.attr("data-"+n+"-id")===location.hash.substr(1)&&i.open())}),i}),e(document).ready(function(){e(document).on("click","[data-"+n+"-target]",function(t){t.preventDefault();var o=t.currentTarget,i=o.getAttribute("data-"+n+"-target"),r=e("[data-"+n+"-id="+i+"]");e[n].lookup[r.data(n)].open()}),e(document).find("."+n).each(function(t,o){var i=e(o),r=i.data(n+"-options");r?("string"==typeof r||r instanceof String)&&(r=l(r)):r={},i[n](r)})});var d=function(t,o){var r=location.hash.replace("#","");if("undefined"==typeof o&&(o=!0),r){var a;try{a=e("[data-"+n+"-id="+r.replace(new RegExp("/","g"),"\\/")+"]")}catch(t){}if(a&&a.length){var s=e[n].lookup[a.data(n)];s&&s.settings.hashTracking&&s.open()}}else o&&i&&!i.busy&&i.settings.hashTracking&&i.close()};e(window).bind("hashchange."+n,d)}(window.jQuery||window.Zepto),function(){function e(){this.callbacks={bounce:this._nullhandler,echo_response:this._nullhandler,chooser:this._nullhandler,init:this._nullhandler,identity:this._nullhandler,logout_result:this._nullhandler,becomes_authenticated:this._nullhandler,becomes_unauthenticated:this._nullhandler,authz_query:this._nullhandler,resources:this._nullhandler,device:this._nullhandler,vcs:this._nullhandler,vcs_list:this._nullhandler,authz_query_list:this._nullhandler},this.baseurl="idp.securetve.com/rest/1.0/",this.responsefield="aisresponse",this.authstate=!1,this.platform_id="",this.aisuid="",this.use_logging=!1,this.log_target="",this.use_cache=!0,this.response_cache={},this.cache_time={init:3e4,chooser:3e4,authz_query:3e4,identity:3e4,bounce:2e3,echo_response:3e4,vcs:2e3,vcs_list:5e3,resources:3e4,authz_query_list:3e4},this.script_insert_type="",this.log_toggle=0,this.supportsLocalStorage=void 0,this.ls_prepend="AIS_client___",this.language_override="",this.protocol="http:"==window.location.protocol||"https:"==window.location.protocol?window.location.protocol+"//":"http://",this.log_object={},this.log_object_keys=[],this.log_object_size=20}e.prototype.assignhandler=function(e,t){this._isFunction(t)?this.callbacks[e]=t:this.log("unable to assign handler to callback type ("+e+") because it is not callable",!0)},e.prototype.setPlatformId=function(e){this.platform_id!=e&&this._reset_cache(!0),this.platform_id=e,this.log("setPlatformId ("+this.platform_id+")",!0)},e.prototype.setLanguageOverride=function(e){this.language_override=e,this.log("setLanguageOverride ("+this.language_override+")",!0)},e.prototype.setProtocol=function(e){this.protocol=e,this.log("setProtocol ("+this.protocol+")",!0)},e.prototype.setResponsefield=function(e){this.responsefield=e,this.log("setResponsefield ("+this.responsefield+")",!0)},e.prototype.aisresponse=function(e){if(void 0!==e.authenticated&&this.authstate!==this._mkboolean(e.authenticated)&&(this.authstate=this._mkboolean(e.authenticated),this._reset_cache(),this.authstate?(this.log("Authenticated",!0),this._dispatch("becomes_authenticated",e)):(this.log("Not Authenticated",!0),this._dispatch("becomes_unauthenticated",e))),void 0!==e.authorization&&(this._mkboolean(e.authorization)?this.log("Authorized: "+e.resource,!0):this.log("Not Authorized: "+e.resource,!0)),void 0!==e.aisuid?(this.aisuid=e.aisuid,this.log("Init: AISUID - "+this.aisuid,!0)):void 0!==e.identity&&(this.aisuid=e.identity.aisuid,this.log("Identity: AISUID - "+this.aisuid,!0)),this._set_cache(e),"authz_query_list"==e._type||"vcs_list"==e._type)for(i=0;i<e.documents.length;i++)this._set_cache(e.documents[i]);"logout_result"==e._type&&(this.log("aisresponse: clearing cache",!0),this._reset_cache(!0));var t=e._type;this._dispatch(t,e)},e.prototype.bounce=function(e){this.log("bounce ",!0),(1==e||0==this._use_cache("bounce"))&&this._call_ais("bounce")},e.prototype.echo=function(e,t){this.log("echo ",!0),(1==t||0==this._use_cache("echo_response",e))&&this._call_ais("echo",e)},e.prototype.init=function(e){this.log("init: ("+(1==this.authstate?"init":"chooser")+")",!0),(1==e||0==this._use_cache(1==this.authstate?"init":"chooser"))&&this._call_ais("init")},e.prototype.chooser=function(e){this.log("chooser ",!0),(1==e||0==this._use_cache("chooser"))&&this._call_ais("chooser")},e.prototype.init_increaseScope=function(e){this.log("init_increaseScope DEPRECATED, using chooser",!0),(1==e||0==this._use_cache("chooser"))&&this._call_ais("chooser")},e.prototype.identity=function(e){this.log("identity ",!0),(1==e||0==this._use_cache("identity"))&&this._call_ais("identity")},e.prototype.logout=function(){this.log("logout ",!0),this._reset_cache(),this._call_ais("logout")},e.prototype.resourceAccess=function(e,t){this.log("resourceAccess: "+e,!0),(1==t||0==this._use_cache("authz_query",e))&&this._call_ais("resourceAccess",e)},e.prototype.resourceAccessList=function(e,t){this.log("resourceAccessList: "+e.join(","),!0),void 0==e||"object"!=typeof e?this.log("resourceAccessList: no resourceid_array provided"+("object"!=typeof e),!0):(1==t||0==this._use_cache("authz_query_list",e))&&this._call_ais("resourceAccessList",e)},e.prototype.channelAccess=function(e,t){this.log("channelAccess: "+e,!0),(1==t||0==this._use_cache("authz_query",e))&&this._call_ais("channelAccess",e)},e.prototype.resources=function(e){this.log("resources ",!0),(1==e||0==this._use_cache("resources"))&&this._call_ais("resources")},e.prototype.registerDevice=function(e){this.log("registerDevice ",!0),this._call_ais("registerDevice",e)},e.prototype.vcsGet=function(e,t){this.log("vcsGet: "+e,!0),void 0==e||""==e?this.log("vcsGet: no contentid provided",!0):(1==t||0==this._use_cache("vcs",e))&&this._call_ais("vcsGet",e)},e.prototype.vcsSet=function(e,t){this.log("vcsSet: "+e+","+t,!0),this._call_ais("vcsSet",e,t)},e.prototype.vcsList=function(e,t){this.log("vcsList: "+(void 0!=e?e.join(","):"no contentid_array"),!0),(1==t||0==this._use_cache("vcs_list",e))&&this._call_ais("vcsList",e)},e.prototype.vcsListRecent=function(e,t){this.log("vcsListRecent: "+e,!0),(1==t||0==this._use_cache("vcs_list",e))&&this._call_ais("vcsListRecent",e)},e.prototype.loginFormat=function(e,t){return this.protocol+this.baseurl+this.platform_id+"/init/"+e+"?responsemethod=redirect&format=jsonp"+(void 0!=t&&""!=t?"&responsetarget="+t:"")+(""!=this.language_override?"&lang="+this.language_override:"")},e.prototype.logoutFormat=function(e){return this.protocol+this.baseurl+this.platform_id+"/slo/?responsemethod=redirect&format=jsonp"+(void 0!=e?"&responsetarget="+e:"")},e.prototype.login=function(e){return this.log("ais_client.login DEPRECATED. Use ais_client.loginFormat instead.",!0),this.protocol+this.baseurl+this.platform_id+"/init/"+e+"?format=jsonp"},e.prototype.setLogging=function(e,t){1==e?(this.use_logging=e,this.log("setLogging: Logging enabled ("+(void 0!=t&&document.getElementById(t)?"HTML - "+t:"console.log")+")",!0)):(this.log("setLogging: Logging disabled",!0),this.use_logging=e),void 0!=t?document.getElementById(t)&&(this.log_target=t):this.log_target=""},e.prototype.setCacheTime=function(e,t){var n=!1;if("number"==typeof t)switch(e){case"init":case"chooser":case"authz_query":case"identity":case"bounce":case"echo_response":case"vcs":case"resources":case"vcs_list":case"authz_query_list":this.cache_time[e]=t,n=!0}return this.log("setCache ("+e+","+t+") "+(1==n?"changed successfully":"invalid call"),!0),this.log(this.cache_time),n},e.prototype.setUseCache=function(e){1!=e&&0!=e||e==this.use_cache||(this.use_cache=e,this.log("setUseCache: changed to (use_cache="+e+")",!0)),this.log("setUseCache: (use_cache="+this.use_cache+")",!0)},e.prototype.setScriptInsert=function(e){this.script_insert_type="","jquery"==e&&(this.script_insert_type=e),this.log("setScriptInsert ("+e+")",!0)},e.prototype.setRedirectLocation=function(e){this.log("setRedirectLocation ("+e+")",!0),this._set("ais_client_redirect_location",e)},e.prototype.getRedirectLocation=function(){return this.log("getRedirectLocation ("+this._get("ais_client_redirect_location")+")",!0),this._get("ais_client_redirect_location")},e.prototype.clearRedirectLocation=function(){this._clear("ais_client_redirect_location"),this.log("clearRedirectLocation",!0)},e.prototype.log=function(e,t){var n="";if(n=1==t?"[AIS] "+e:e,this.log_object_keys.length>=this.log_object_size){var o=this.log_object_keys.shift();delete this.log_object[o]}var i=new Date,r=i.getFullYear()+"-"+i.getMonth()+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()+"."+i.getMilliseconds();if(this.log_object[r]=n,this.log_object_keys[this.log_object_keys.length]=r,1==this.use_logging&&(window.console&&console.log&&console.log(n),""!=this.log_target)){var a="";"object"==typeof e&&(a+="<br>",a+=this._create_object_log_output(e),n="[AIS] "+n+a),document.getElementById(this.log_target).innerHTML+="<div"+(0==this.log_toggle?"":' style="background: #E8E8E8;"')+">"+n+"</div>",this.log_toggle=1==this.log_toggle?0:1}},e.prototype._call_ais=function(e,t,n){var o=this.protocol+this.baseurl+this.platform_id;if("echo"==e?o+="/echo/"+t:"bounce"==e?o+="/bounce/":"init"==e?o+="/init/":"chooser"==e?o+="/chooser/":"identity"==e?o+="/identity/":"logout"==e?o+="/slo/":"resourceAccess"==e?o+="/identity/resourceAccess/"+t:"channelAccess"==e?o+="/identity/channelAccess/"+t:"resources"==e?o+="/identity/resourceAccess/":"registerDevice"==e?o+="/identity/registerDevice/"+t:"vcsGet"==e?o+="/vcs/"+t:"vcsList"==e?o+="/vcs/":"vcsListRecent"==e?o+="/vcs/":"vcsSet"==e?o+="/vcs/"+t:"resourceAccessList"==e&&(o+="/identity/resourceAccess/"),o+="?format=jsonp&responsefield="+this.responsefield,"vcsSet"==e&&(o+="&ph_pos="+n+"&trickmode=post"),"vcsList"==e&&void 0!=t&&null!=t&&""!=t&&(o+="&content_id="+t.join("&content_id=")),"vcsListRecent"==e&&void 0!=t&&null!=t&&""!=t&&(o+="&limit="+t),"resourceAccessList"==e&&(o+="&resource_id="+t.join("&resource_id=")),""==this.language_override||"resourceAccess"!=e&&"channelAccess"!=e&&"resourceAccessList"!=e||(o+="&lang="+this.language_override),this.log(e+": "+o,!0),"jquery"==this.script_insert_type)!function(e){e.ajax({url:o,dataType:"script",cache:!0,async:!0})}(jQuery);else{var i=document.createElement("script");i.setAttribute("src",o),document.getElementsByTagName("head")[0].appendChild(i)}},e.prototype._mkboolean=function(e){return/^true$/i.test(e)},e.prototype._isFunction=function(e){return!!e&&e.constructor==Function},e.prototype._nullhandler=function(e,t){},e.prototype._alerthandler=function(e,t){alert("alert handler received message of type: "+e+"\n with: "+t,!0)},e.prototype._dispatch=function(e,t){void 0!==this.callbacks[e]&&this._isFunction(this.callbacks[e])?(runner=this.callbacks[e],runner(e,t)):this.log("callable is not set for handler: "+e,!0)},e.prototype._create_object_log_output=function(e){var t="";t="{";for(key in e)"object"==typeof e[key]?(t+=""+("string"==typeof key?'"'+key+'"':key)+":",t+=this._create_object_log_output(e[key]),t+=", "):t+=""+("string"==typeof key?'"'+key+'"':key)+":"+("string"==typeof e[key]?'"'+e[key]+'"':e[key])+", ";return t=t.substring(0,t.length-2),t+="}"},e.prototype._use_cache=function(e){var t=!1;if(0==this.use_cache)return this.log("_use_cache: caching disabled",!0),t;var n=0,o="",i=new Date,r=e;"authz_query"==r||"vcs"==r?r+="-"+arguments[1]:"echo_response"==r?r+="-"+escape(arguments[1]):"vcs_list"==r&&(r+="-"+("object"!=typeof arguments[1]?arguments[1]:arguments[1].join("-")));var a=void 0;return 1==this.supportsLocalStorage&&(a=localStorage.getItem(this.ls_prepend+this.platform_id+"__response_cache_update__"+r)),void 0!==this.response_cache._response_cache_updates[r]?(n=this.response_cache._response_cache_updates[r],o="js"):void 0!=a&&(n=a,o="localStorage"),n>0&&i.getTime()-n<this.cache_time[e]?("js"==o?aisresponse(this.response_cache[r],!0):"localStorage"==o&&aisresponse(JSON.parse(localStorage.getItem(this.ls_prepend+this.platform_id+"__"+r)),!0),t=!0,this.log("_use_cache: "+r+" ("+o+" cached "+(this.cache_time[e]-(i.getTime()-n))+"/"+this.cache_time[e]+")",!0)):(t=!1,1==this.supportsLocalStorage&&(localStorage.removeItem(this.ls_prepend+this.platform_id+"__response_cache_update__"+r),localStorage.removeItem(this.ls_prepend+this.platform_id+"__"+r))),t},e.prototype._set_cache=function(e){var t=new Date,n=e._type;if("authz_query"==n)n=e._type+"-"+e.resource;else if("echo_response"==n)n+="-"+escape(e.response_value);else if("vcs"==n)n+="-"+escape(e.content_id);else if("vcs_list"==n)for(i=0;i<e.documents.length;i++)n+="-"+e.documents[i].content_id;if(void 0===this.response_cache[n]||t.getTime()-this.response_cache._response_cache_updates[n]>this.cache_time[e._type]){var o=void 0;1==this.supportsLocalStorage&&(o=localStorage.getItem(this.ls_prepend+this.platform_id+"__response_cache_update__"+n)),this.response_cache._response_cache_updates[n]=void 0!=o?o:t.getTime(),1==this.supportsLocalStorage&&localStorage.setItem(this.ls_prepend+this.platform_id+"__response_cache_update__"+n,t.getTime())}this.response_cache[n]=e,1==this.supportsLocalStorage&&localStorage.setItem(this.ls_prepend+this.platform_id+"__"+n,JSON.stringify(e)),this.log("_set_cache: "+n+" (caching length = "+this.cache_time[e._type]+")",!0),this.log(this.response_cache)},e.prototype._reset_cache=function(e){if(this.response_cache={_response_cache_updates:{}},1==e&&1==this.supportsLocalStorage){var t=[];for(i=0;i<=localStorage.length-1;i++)t[i]=localStorage.key(i);var n=this.ls_prepend+this.platform_id+"__";for(i=0;i<=t.length-1;i++)t[i].substring(0,n.length)==n&&(this.log("_reset_cache: Removing| "+t[i],!0),localStorage.removeItem(t[i]))}},e.prototype._set=function(e,t){if(1==this.supportsLocalStorage)return this.log('_set: using localStorage (key: "'+e+'", value: "'+t+'")',!0),localStorage.removeItem(e),localStorage.setItem(e,escape(t));var n="";if(arguments[2]){var o=new Date;o.setTime(o.getTime()+24*arguments[2]*60*60*1e3),n="; expires="+o.toGMTString()}return document.cookie=e+"="+escape(t)+n+"; path=/",void this.log('_set: using cookies (key: "'+e+'", value: "'+t+'", expires: "'+n+'", cookie_value: "'+e+"="+t+n+'; path=/")',!0)},e.prototype._get=function(e){if(1==this.supportsLocalStorage)return this.log('_get: using localStorage (key: "'+e+'", value: "'+localStorage.getItem(e)+'")',!0),unescape(localStorage.getItem(e));for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return this.log('_get: using cookies (key: "'+e+'", value: "'+i.substring(t.length,i.length)+'")',!0),unescape(i.substring(t.length,i.length))}return null},e.prototype._clear=function(e){1==this.supportsLocalStorage?localStorage.removeItem(e):this._set(e,"",-1)},e.prototype._setLocalStorageSupport=function(){this.supportsLocalStorage=this.__checkLocalStorageSupport()},e.prototype.__checkLocalStorageSupport=function(){try{return JSON.stringify({a:"b"}),"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},window.ais_client=new e,window.ais_client._reset_cache(),window.ais_client._setLocalStorageSupport()}(),jQuery.base64=function(e){function t(e,t){var n=a.indexOf(e.charAt(t));if(-1===n)throw"Cannot decode base64";return n}function n(e){var n,o,i=0,a=e.length,s=[];if(e=String(e),0===a)return e;if(a%4!==0)throw"Cannot decode base64";for(e.charAt(a-1)===r&&(i=1,e.charAt(a-2)===r&&(i=2),a-=4),n=0;a>n;n+=4)o=t(e,n)<<18|t(e,n+1)<<12|t(e,n+2)<<6|t(e,n+3),s.push(String.fromCharCode(o>>16,o>>8&255,255&o));switch(i){case 1:o=t(e,n)<<18|t(e,n+1)<<12|t(e,n+2)<<6,s.push(String.fromCharCode(o>>16,o>>8&255));break;case 2:o=t(e,n)<<18|t(e,n+1)<<12,s.push(String.fromCharCode(o>>16));

}return s.join("")}function o(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function i(e){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";e=String(e);var t,n,i=[],s=e.length-e.length%3;if(0===e.length)return e;for(t=0;s>t;t+=3)n=o(e,t)<<16|o(e,t+1)<<8|o(e,t+2),i.push(a.charAt(n>>18)),i.push(a.charAt(n>>12&63)),i.push(a.charAt(n>>6&63)),i.push(a.charAt(63&n));switch(e.length-s){case 1:n=o(e,t)<<16,i.push(a.charAt(n>>18)+a.charAt(n>>12&63)+r+r);break;case 2:n=o(e,t)<<16|o(e,t+1)<<8,i.push(a.charAt(n>>18)+a.charAt(n>>12&63)+a.charAt(n>>6&63)+r)}return i.join("")}var r="=",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s="1.0";return{decode:n,encode:i,VERSION:s}}(jQuery),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.pako=e()}}(function(){return function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return i(n?n:e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){"use strict";function o(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}function i(e,t){return t=t||{},t.raw=!0,o(e,t)}var r=e("./zlib/inflate.js"),a=e("./utils/common"),s=e("./utils/strings"),c=e("./zlib/constants"),u=e("./zlib/messages"),l=e("./zlib/zstream"),d=e("./zlib/gzheader"),h=function(e){this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==c.Z_OK)throw new Error(u[n]);this.header=new d,r.inflateGetHeader(this.strm,this.header)};h.prototype.push=function(e,t){var n,o,i,u,l,d=this.strm,h=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:t===!0?c.Z_FINISH:c.Z_NO_FLUSH,d.input="string"==typeof e?s.binstring2buf(e):e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new a.Buf8(h),d.next_out=0,d.avail_out=h),n=r.inflate(d,c.Z_NO_FLUSH),n!==c.Z_STREAM_END&&n!==c.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0===d.avail_out||n===c.Z_STREAM_END||0===d.avail_in&&o===c.Z_FINISH)&&("string"===this.options.to?(i=s.utf8border(d.output,d.next_out),u=d.next_out-i,l=s.buf2string(d.output,i),d.next_out=u,d.avail_out=h-u,u&&a.arraySet(d.output,d.output,i,u,0),this.onData(l)):this.onData(a.shrinkBuf(d.output,d.next_out)))}while(d.avail_in>0&&n!==c.Z_STREAM_END);return n===c.Z_STREAM_END&&(o=c.Z_FINISH),o===c.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c.Z_OK):!0},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===c.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=h,n.inflate=o,n.inflateRaw=i,n.ungzip=o},{"./utils/common":2,"./utils/strings":3,"./zlib/constants":5,"./zlib/gzheader":7,"./zlib/inflate.js":9,"./zlib/messages":11,"./zlib/zstream":12}],2:[function(e,t,n){"use strict";var o="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,o,i){if(t.subarray&&e.subarray)return void e.set(t.subarray(n,n+o),i);for(var r=0;o>r;r++)e[i+r]=t[n+r]},flattenChunks:function(e){var t,n,o,i,r,a;for(o=0,t=0,n=e.length;n>t;t++)o+=e[t].length;for(a=new Uint8Array(o),i=0,t=0,n=e.length;n>t;t++)r=e[t],a.set(r,i),i+=r.length;return a}},r={arraySet:function(e,t,n,o,i){for(var r=0;o>r;r++)e[i+r]=t[n+r]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,r))},n.setTyped(o)},{}],3:[function(e,t,n){"use strict";function o(e,t){if(65537>t&&(e.subarray&&a||!e.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",o=0;t>o;o++)n+=String.fromCharCode(e[o]);return n}var i=e("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(s){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){a=!1}for(var c=new i.Buf8(256),u=0;256>u;u++)c[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;c[254]=c[254]=1,n.string2buf=function(e){var t,n,o,r,a,s=e.length,c=0;for(r=0;s>r;r++)n=e.charCodeAt(r),55296===(64512&n)&&s>r+1&&(o=e.charCodeAt(r+1),56320===(64512&o)&&(n=65536+(n-55296<<10)+(o-56320),r++)),c+=128>n?1:2048>n?2:65536>n?3:4;for(t=new i.Buf8(c),a=0,r=0;c>a;r++)n=e.charCodeAt(r),55296===(64512&n)&&s>r+1&&(o=e.charCodeAt(r+1),56320===(64512&o)&&(n=65536+(n-55296<<10)+(o-56320),r++)),128>n?t[a++]=n:2048>n?(t[a++]=192|n>>>6,t[a++]=128|63&n):65536>n?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},n.buf2binstring=function(e){return o(e,e.length)},n.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,o=t.length;o>n;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,i,r,a,s=t||e.length,u=new Array(2*s);for(i=0,n=0;s>n;)if(r=e[n++],128>r)u[i++]=r;else if(a=c[r],a>4)u[i++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&s>n;)r=r<<6|63&e[n++],a--;a>1?u[i++]=65533:65536>r?u[i++]=r:(r-=65536,u[i++]=55296|r>>10&1023,u[i++]=56320|1023&r)}return o(u,i)},n.utf8border=function(e,t){var n;for(t=t||e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&128===(192&e[n]);)n--;return 0>n?t:0===n?t:n+c[e[n]]>t?n:t}},{"./common":2}],4:[function(e,t){"use strict";function n(e,t,n,o){for(var i=65535&e|0,r=e>>>16&65535|0,a=0;0!==n;){a=n>2e3?2e3:n,n-=a;do i=i+t[o++]|0,r=r+i|0;while(--a);i%=65521,r%=65521}return i|r<<16|0}t.exports=n},{}],5:[function(e,t){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],6:[function(e,t){"use strict";function n(){for(var e,t=[],n=0;256>n;n++){e=n;for(var o=0;8>o;o++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}function o(e,t,n,o){var r=i,a=o+n;e=-1^e;for(var s=o;a>s;s++)e=e>>>8^r[255&(e^t[s])];return-1^e}var i=n();t.exports=o},{}],7:[function(e,t){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=n},{}],8:[function(e,t){"use strict";var n=30,o=12;t.exports=function(e,t){var i,r,a,s,c,u,l,d,h,f,g,m,p,v,y,b,w,_,k,A,T,x,S,B,E;i=e.state,r=e.next_in,B=e.input,a=r+(e.avail_in-5),s=e.next_out,E=e.output,c=s-(t-e.avail_out),u=s+(e.avail_out-257),l=i.dmax,d=i.wsize,h=i.whave,f=i.wnext,g=i.window,m=i.hold,p=i.bits,v=i.lencode,y=i.distcode,b=(1<<i.lenbits)-1,w=(1<<i.distbits)-1;e:do{15>p&&(m+=B[r++]<<p,p+=8,m+=B[r++]<<p,p+=8),_=v[m&b];t:for(;;){if(k=_>>>24,m>>>=k,p-=k,k=_>>>16&255,0===k)E[s++]=65535&_;else{if(!(16&k)){if(0===(64&k)){_=v[(65535&_)+(m&(1<<k)-1)];continue t}if(32&k){i.mode=o;break e}e.msg="invalid literal/length code",i.mode=n;break e}A=65535&_,k&=15,k&&(k>p&&(m+=B[r++]<<p,p+=8),A+=m&(1<<k)-1,m>>>=k,p-=k),15>p&&(m+=B[r++]<<p,p+=8,m+=B[r++]<<p,p+=8),_=y[m&w];n:for(;;){if(k=_>>>24,m>>>=k,p-=k,k=_>>>16&255,!(16&k)){if(0===(64&k)){_=y[(65535&_)+(m&(1<<k)-1)];continue n}e.msg="invalid distance code",i.mode=n;break e}if(T=65535&_,k&=15,k>p&&(m+=B[r++]<<p,p+=8,k>p&&(m+=B[r++]<<p,p+=8)),T+=m&(1<<k)-1,T>l){e.msg="invalid distance too far back",i.mode=n;break e}if(m>>>=k,p-=k,k=s-c,T>k){if(k=T-k,k>h&&i.sane){e.msg="invalid distance too far back",i.mode=n;break e}if(x=0,S=g,0===f){if(x+=d-k,A>k){A-=k;do E[s++]=g[x++];while(--k);x=s-T,S=E}}else if(k>f){if(x+=d+f-k,k-=f,A>k){A-=k;do E[s++]=g[x++];while(--k);if(x=0,A>f){k=f,A-=k;do E[s++]=g[x++];while(--k);x=s-T,S=E}}}else if(x+=f-k,A>k){A-=k;do E[s++]=g[x++];while(--k);x=s-T,S=E}for(;A>2;)E[s++]=S[x++],E[s++]=S[x++],E[s++]=S[x++],A-=3;A&&(E[s++]=S[x++],A>1&&(E[s++]=S[x++]))}else{x=s-T;do E[s++]=E[x++],E[s++]=E[x++],E[s++]=E[x++],A-=3;while(A>2);A&&(E[s++]=E[x++],A>1&&(E[s++]=E[x++]))}break}}break}}while(a>r&&u>s);A=p>>3,r-=A,p-=A<<3,m&=(1<<p)-1,e.next_in=r,e.next_out=s,e.avail_in=a>r?5+(a-r):5-(r-a),e.avail_out=u>s?257+(u-s):257-(s-u),i.hold=m,i.bits=p}},{}],9:[function(e,t,n){"use strict";function o(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function r(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=R,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new v.Buf32(ge),t.distcode=t.distdyn=new v.Buf32(me),t.sane=1,t.back=-1,E):I}function a(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,r(e)):I}function s(e,t){var n,o;return e&&e.state?(o=e.state,0>t?(n=0,t=-t):(n=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||t>15)?I:(null!==o.window&&o.wbits!==t&&(o.window=null),o.wrap=n,o.wbits=t,a(e))):I}function c(e,t){var n,o;return e?(o=new i,e.state=o,o.window=null,n=s(e,t),n!==E&&(e.state=null),n):I}function u(e){return c(e,ve)}function l(e){if(ye){var t;for(m=new v.Buf32(512),p=new v.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(_(A,e.lens,0,288,m,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;_(T,e.lens,0,32,p,0,e.work,{bits:5}),ye=!1}e.lencode=m,e.lenbits=9,e.distcode=p,e.distbits=5}function d(e,t,n,o){var i,r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new v.Buf8(r.wsize)),o>=r.wsize?(v.arraySet(r.window,t,n-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(i=r.wsize-r.wnext,i>o&&(i=o),v.arraySet(r.window,t,n-o,i,r.wnext),o-=i,o?(v.arraySet(r.window,t,n-o,o,0),r.wnext=o,r.whave=r.wsize):(r.wnext+=i,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=i))),0}function h(e,t){var n,i,r,a,s,c,u,h,f,g,m,p,ge,me,pe,ve,ye,be,we,_e,ke,Ae,Te,xe,Se=0,Be=new v.Buf8(4),Ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return I;n=e.state,n.mode===H&&(n.mode=Q),s=e.next_out,r=e.output,u=e.avail_out,a=e.next_in,i=e.input,c=e.avail_in,h=n.hold,f=n.bits,g=c,m=u,Ae=E;e:for(;;)switch(n.mode){case R:if(0===n.wrap){n.mode=Q;break}for(;16>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(2&n.wrap&&35615===h){n.check=0,Be[0]=255&h,Be[1]=h>>>8&255,n.check=b(n.check,Be,2,0),h=0,f=0,n.mode=W;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&h)<<8)+(h>>8))%31){e.msg="incorrect header check",n.mode=de;break}if((15&h)!==j){e.msg="unknown compression method",n.mode=de;break}if(h>>>=4,f-=4,ke=(15&h)+8,0===n.wbits)n.wbits=ke;else if(ke>n.wbits){e.msg="invalid window size",n.mode=de;break}n.dmax=1<<ke,e.adler=n.check=1,n.mode=512&h?J:H,h=0,f=0;break;case W:for(;16>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(n.flags=h,(255&n.flags)!==j){e.msg="unknown compression method",n.mode=de;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=de;break}n.head&&(n.head.text=h>>8&1),512&n.flags&&(Be[0]=255&h,Be[1]=h>>>8&255,n.check=b(n.check,Be,2,0)),h=0,f=0,n.mode=D;case D:for(;32>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}n.head&&(n.head.time=h),512&n.flags&&(Be[0]=255&h,Be[1]=h>>>8&255,Be[2]=h>>>16&255,Be[3]=h>>>24&255,n.check=b(n.check,Be,4,0)),h=0,f=0,n.mode=P;case P:for(;16>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}n.head&&(n.head.xflags=255&h,n.head.os=h>>8),512&n.flags&&(Be[0]=255&h,Be[1]=h>>>8&255,n.check=b(n.check,Be,2,0)),h=0,f=0,n.mode=M;case M:if(1024&n.flags){for(;16>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}n.length=h,n.head&&(n.head.extra_len=h),512&n.flags&&(Be[0]=255&h,Be[1]=h>>>8&255,n.check=b(n.check,Be,2,0)),h=0,f=0}else n.head&&(n.head.extra=null);n.mode=q;case q:if(1024&n.flags&&(p=n.length,p>c&&(p=c),p&&(n.head&&(ke=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),v.arraySet(n.head.extra,i,a,p,ke)),512&n.flags&&(n.check=b(n.check,i,p,a)),c-=p,a+=p,n.length-=p),n.length))break e;n.length=0,n.mode=Z;case Z:if(2048&n.flags){if(0===c)break e;p=0;do ke=i[a+p++],n.head&&ke&&n.length<65536&&(n.head.name+=String.fromCharCode(ke));while(ke&&c>p);if(512&n.flags&&(n.check=b(n.check,i,p,a)),c-=p,a+=p,ke)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=F;case F:if(4096&n.flags){if(0===c)break e;p=0;do ke=i[a+p++],n.head&&ke&&n.length<65536&&(n.head.comment+=String.fromCharCode(ke));while(ke&&c>p);if(512&n.flags&&(n.check=b(n.check,i,p,a)),c-=p,a+=p,ke)break e}else n.head&&(n.head.comment=null);n.mode=U;case U:if(512&n.flags){for(;16>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(h!==(65535&n.check)){e.msg="header crc mismatch",n.mode=de;break}h=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=H;break;case J:for(;32>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}e.adler=n.check=o(h),h=0,f=0,n.mode=V;case V:if(0===n.havedict)return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=h,n.bits=f,L;e.adler=n.check=1,n.mode=H;case H:if(t===S||t===B)break e;case Q:if(n.last){h>>>=7&f,f-=7&f,n.mode=ce;break}for(;3>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}switch(n.last=1&h,h>>>=1,f-=1,3&h){case 0:n.mode=G;break;case 1:if(l(n),n.mode=te,t===B){h>>>=2,f-=2;break e}break;case 2:n.mode=$;break;case 3:e.msg="invalid block type",n.mode=de}h>>>=2,f-=2;break;case G:for(h>>>=7&f,f-=7&f;32>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if((65535&h)!==(h>>>16^65535)){e.msg="invalid stored block lengths",n.mode=de;break}if(n.length=65535&h,h=0,f=0,n.mode=Y,t===B)break e;case Y:n.mode=K;case K:if(p=n.length){if(p>c&&(p=c),p>u&&(p=u),0===p)break e;v.arraySet(r,i,a,p,s),c-=p,a+=p,u-=p,s+=p,n.length-=p;break}n.mode=H;break;case $:for(;14>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(n.nlen=(31&h)+257,h>>>=5,f-=5,n.ndist=(31&h)+1,h>>>=5,f-=5,n.ncode=(15&h)+4,h>>>=4,f-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=de;break}n.have=0,n.mode=X;case X:for(;n.have<n.ncode;){for(;3>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}n.lens[Ee[n.have++]]=7&h,h>>>=3,f-=3}for(;n.have<19;)n.lens[Ee[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Te={bits:n.lenbits},Ae=_(k,n.lens,0,19,n.lencode,0,n.work,Te),n.lenbits=Te.bits,Ae){e.msg="invalid code lengths set",n.mode=de;break}n.have=0,n.mode=ee;case ee:for(;n.have<n.nlen+n.ndist;){for(;Se=n.lencode[h&(1<<n.lenbits)-1],pe=Se>>>24,ve=Se>>>16&255,ye=65535&Se,!(f>=pe);){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(16>ye)h>>>=pe,f-=pe,n.lens[n.have++]=ye;else{if(16===ye){for(xe=pe+2;xe>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(h>>>=pe,f-=pe,0===n.have){e.msg="invalid bit length repeat",n.mode=de;break}ke=n.lens[n.have-1],p=3+(3&h),h>>>=2,f-=2}else if(17===ye){for(xe=pe+3;xe>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}h>>>=pe,f-=pe,ke=0,p=3+(7&h),h>>>=3,f-=3}else{for(xe=pe+7;xe>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}h>>>=pe,f-=pe,ke=0,p=11+(127&h),h>>>=7,f-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=de;break}for(;p--;)n.lens[n.have++]=ke}}if(n.mode===de)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=de;break}if(n.lenbits=9,Te={bits:n.lenbits},Ae=_(A,n.lens,0,n.nlen,n.lencode,0,n.work,Te),n.lenbits=Te.bits,Ae){e.msg="invalid literal/lengths set",n.mode=de;break}if(n.distbits=6,n.distcode=n.distdyn,Te={bits:n.distbits},Ae=_(T,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Te),n.distbits=Te.bits,Ae){e.msg="invalid distances set",n.mode=de;break}if(n.mode=te,t===B)break e;case te:n.mode=ne;case ne:if(c>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=h,n.bits=f,w(e,m),s=e.next_out,r=e.output,u=e.avail_out,a=e.next_in,i=e.input,c=e.avail_in,h=n.hold,f=n.bits,n.mode===H&&(n.back=-1);break}for(n.back=0;Se=n.lencode[h&(1<<n.lenbits)-1],pe=Se>>>24,ve=Se>>>16&255,ye=65535&Se,!(f>=pe);){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(ve&&0===(240&ve)){for(be=pe,we=ve,_e=ye;Se=n.lencode[_e+((h&(1<<be+we)-1)>>be)],pe=Se>>>24,ve=Se>>>16&255,ye=65535&Se,!(f>=be+pe);){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}h>>>=be,f-=be,n.back+=be}if(h>>>=pe,f-=pe,n.back+=pe,n.length=ye,0===ve){n.mode=se;break}if(32&ve){n.back=-1,n.mode=H;break}if(64&ve){e.msg="invalid literal/length code",n.mode=de;break}n.extra=15&ve,n.mode=oe;case oe:if(n.extra){for(xe=n.extra;xe>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=ie;case ie:for(;Se=n.distcode[h&(1<<n.distbits)-1],pe=Se>>>24,ve=Se>>>16&255,ye=65535&Se,!(f>=pe);){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(0===(240&ve)){for(be=pe,we=ve,_e=ye;Se=n.distcode[_e+((h&(1<<be+we)-1)>>be)],pe=Se>>>24,ve=Se>>>16&255,ye=65535&Se,!(f>=be+pe);){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}h>>>=be,f-=be,n.back+=be}if(h>>>=pe,f-=pe,n.back+=pe,64&ve){e.msg="invalid distance code",n.mode=de;break}n.offset=ye,n.extra=15&ve,n.mode=re;case re:if(n.extra){for(xe=n.extra;xe>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=de;break}n.mode=ae;case ae:if(0===u)break e;if(p=m-u,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=de;break}p>n.wnext?(p-=n.wnext,ge=n.wsize-p):ge=n.wnext-p,p>n.length&&(p=n.length),me=n.window}else me=r,ge=s-n.offset,p=n.length;p>u&&(p=u),u-=p,n.length-=p;do r[s++]=me[ge++];while(--p);0===n.length&&(n.mode=ne);break;case se:if(0===u)break e;r[s++]=n.length,u--,n.mode=ne;break;case ce:if(n.wrap){for(;32>f;){if(0===c)break e;c--,h|=i[a++]<<f,f+=8}if(m-=u,e.total_out+=m,n.total+=m,m&&(e.adler=n.check=n.flags?b(n.check,r,m,s-m):y(n.check,r,m,s-m)),m=u,(n.flags?h:o(h))!==n.check){e.msg="incorrect data check",n.mode=de;break}h=0,f=0}n.mode=ue;case ue:if(n.wrap&&n.flags){for(;32>f;){if(0===c)break e;c--,h+=i[a++]<<f,f+=8}if(h!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=de;break}h=0,f=0}n.mode=le;case le:Ae=C;break e;case de:Ae=z;break e;case he:return N;case fe:default:return I}return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=h,n.bits=f,(n.wsize||m!==e.avail_out&&n.mode<de&&(n.mode<ce||t!==x))&&d(e,e.output,e.next_out,m-e.avail_out)?(n.mode=he,N):(g-=e.avail_in,m-=e.avail_out,e.total_in+=g,e.total_out+=m,n.total+=m,n.wrap&&m&&(e.adler=n.check=n.flags?b(n.check,r,m,e.next_out-m):y(n.check,r,m,e.next_out-m)),e.data_type=n.bits+(n.last?64:0)+(n.mode===H?128:0)+(n.mode===te||n.mode===Y?256:0),(0===g&&0===m||t===x)&&Ae===E&&(Ae=O),Ae)}function f(e){if(!e||!e.state)return I;var t=e.state;return t.window&&(t.window=null),e.state=null,E}function g(e,t){var n;return e&&e.state?(n=e.state,0===(2&n.wrap)?I:(n.head=t,t.done=!1,E)):I}var m,p,v=e("../utils/common"),y=e("./adler32"),b=e("./crc32"),w=e("./inffast"),_=e("./inftrees"),k=0,A=1,T=2,x=4,S=5,B=6,E=0,C=1,L=2,I=-2,z=-3,N=-4,O=-5,j=8,R=1,W=2,D=3,P=4,M=5,q=6,Z=7,F=8,U=9,J=10,V=11,H=12,Q=13,G=14,Y=15,K=16,$=17,X=18,ee=19,te=20,ne=21,oe=22,ie=23,re=24,ae=25,se=26,ce=27,ue=28,le=29,de=30,he=31,fe=32,ge=852,me=592,pe=15,ve=pe,ye=!0;n.inflateReset=a,n.inflateReset2=s,n.inflateResetKeep=r,n.inflateInit=u,n.inflateInit2=c,n.inflate=h,n.inflateEnd=f,n.inflateGetHeader=g,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":2,"./adler32":4,"./crc32":6,"./inffast":8,"./inftrees":10}],10:[function(e,t){"use strict";var n=e("../utils/common"),o=15,i=852,r=592,a=0,s=1,c=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,f,g,m,p,v,y){var b,w,_,k,A,T,x,S,B,E=y.bits,C=0,L=0,I=0,z=0,N=0,O=0,j=0,R=0,W=0,D=0,P=null,M=0,q=new n.Buf16(o+1),Z=new n.Buf16(o+1),F=null,U=0;for(C=0;o>=C;C++)q[C]=0;for(L=0;g>L;L++)q[t[f+L]]++;for(N=E,z=o;z>=1&&0===q[z];z--);if(N>z&&(N=z),0===z)return m[p++]=20971520,m[p++]=20971520,y.bits=1,0;for(I=1;z>I&&0===q[I];I++);for(I>N&&(N=I),R=1,C=1;o>=C;C++)if(R<<=1,R-=q[C],0>R)return-1;if(R>0&&(e===a||1!==z))return-1;for(Z[1]=0,C=1;o>C;C++)Z[C+1]=Z[C]+q[C];for(L=0;g>L;L++)0!==t[f+L]&&(v[Z[t[f+L]]++]=L);if(e===a?(P=F=v,T=19):e===s?(P=u,M-=257,F=l,U-=257,T=256):(P=d,F=h,T=-1),D=0,L=0,C=I,A=p,O=N,j=0,_=-1,W=1<<N,k=W-1,e===s&&W>i||e===c&&W>r)return 1;for(var J=0;;){J++,x=C-j,v[L]<T?(S=0,B=v[L]):v[L]>T?(S=F[U+v[L]],B=P[M+v[L]]):(S=96,B=0),b=1<<C-j,w=1<<O,I=w;do w-=b,m[A+(D>>j)+w]=x<<24|S<<16|B|0;while(0!==w);for(b=1<<C-1;D&b;)b>>=1;if(0!==b?(D&=b-1,D+=b):D=0,L++,0===--q[C]){if(C===z)break;C=t[f+v[L]]}if(C>N&&(D&k)!==_){for(0===j&&(j=N),A+=I,O=C-j,R=1<<O;z>O+j&&(R-=q[O+j],!(0>=R));)O++,R<<=1;if(W+=1<<O,e===s&&W>i||e===c&&W>r)return 1;_=D&k,m[_]=N<<24|O<<16|A-p|0}}return 0!==D&&(m[A+D]=C-j<<24|64<<16|0),y.bits=N,0}},{"../utils/common":2}],11:[function(e,t){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],12:[function(e,t){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=n},{}]},{},[1])(1)});var BmAuth=BmAuth||{};!function(e){"use strict";var t={version:"2.0.11.2",module:{},constants:{accepted:{environments:["prod","test"],platforms:["web","ios","android","xbox360","xboxone","samsung","windows8","roku","appletv"],messageOrigin:{authn:["http://10.14.68.191:3050","http://auth.9c9media.ca","http://liveqa.auth.9c9media.ca"],tpCookie:["http://dev.auth.cms.9c9media.net","http://liveqa.auth.9c9media.ca","http://auth.9c9media.ca"]}},akamaiConfig:{responceMethod:"redirect",responseTarget:"qa",lang:"en"},ui:{container:".axis-auth-container",overlayBG:".axis-modal-bg",overlay:".remodal-overlay",id:"#axis-auth",element:null},cache:{authn:1547e7,identity:2506e6,authz:1296e4},timer:{authZWarningTreshold:2e3,authZTimeoutTreshold:6e3,identityWarningTreshold:2e3,identityTimeoutTreshold:6e3,bounceWarningTreshold:1e3,bounceTimeoutTreshold:3e3,configWarningTreshold:2e3,configTimeouTreshold:6e3,closeModalOnSuccess:2e3,closeModalOnSuccessMulti:8e3,thirdPartyCookieTimeout:4500,initWarningTreshold:2e3,initTimeoutTreshold:6e3,registerWarningTreshold:2e3,registerTimeoutTreshold:6e3,styelsheetTimeoutTreshold:4e3},authSetting:{environment:"local",inDebug:!0},url:{config:"http://10.14.68.191:50/config/",error:"http://10.14.68.191:50/error/",assets:"http://10.14.68.191/assets",assetsRoot:"http://10.14.68.191",tpCookieChecker:"http://auth.9c9media.ca/auth/pages/tpcchecker.aspx",faq:"http://esi2.ctv.ca/auth9/pages/faq/",authRoot:"http://10.14.68.191:3050/",aisBase:"http://idp.securetve.com/rest/1.0/"}},config:{brand:null,platform:null,environment:null,lang:"en",brandUrn:null,messages:{},isMultiAuthzFlow:!1,tpCookieUrl:""},vars:{signinStatus:null,domain:null,differed:{isAuthenticated:null,handleSignIn:null},bellmediaLogo:null},ready:null},n=BmAuth.Controller={},o={},i=function(){t.constants.authSetting.inDebug=!1,t.constants.url.config="http://auth.9c9media.ca/api/config/",t.constants.url.error="http://auth.9c9media.ca/api/error/",t.constants.url.assets="http://auth.9c9media.ca/assets",t.constants.url.assetsRoot="http://auth.9c9media.ca",t.constants.akamaiConfig.responseTarget="prod2",t.constants.authSetting.environment="prod",t.constants.url.tpCookieChecker="http://auth.9c9media.ca/auth/pages/tpcchecker.aspx",t.constants.url.authRoot="http://auth.9c9media.ca/auth/",t.log("main:","",{version:t.version,env:t.constants.authSetting.environment})},r=function(e,n,o,i){if(!e)throw new BmAuth.Error("BmAuth.init failed. The argument brand must have a value.","EBAB01");if("string"!=typeof e)throw new BmAuth.Error("BmAuth.init failed. The argument brand must be a string (brand: "+e+")","EBAB02");if(e=e.toLowerCase(),"string"!=typeof o?(t.errorhandler.onWarning(new BmAuth.Warning("The value "+o+" for environment in BmAuth init config is not string and therefore invalid. Therefore it is been set to prod to prevent blocking","WBAB02")),o=t.constants.accepted.environment[0]):o=o.toLowerCase(),-1===t.constants.accepted.environments.indexOf(o)&&(t.errorhandler.onWarning(new BmAuth.Warning("The value "+o+" for environment in BmAuth init config is invalid. Therefore it is been set to prod to prevent blocking","WBAB03")),o=t.constants.accepted.environments[0]),"string"!=typeof n?(t.errorhandler.onWarning(new BmAuth.Warning("The value "+n+" for platform in BmAuth init config is not string and therefore invalid. therefore it is been set to web to prevent blocking.","WBAB04")),n=t.constants.accepted.platforms[0]):n=n.toLowerCase(),-1===t.constants.accepted.platforms.indexOf(n)&&(t.errorhandler.onWarning(new BmAuth.Warning("The value "+n+" for platform in BmAuth init config is invalid. therefore it is been set to web to prevent blocking.","WBAB04")),n=t.constants.accepted.platforms[0]),t.config.brand=e,t.config.platform=n,t.config.environment=o,t.config.options=i||{},t.config.options.fromWebview=t.config.options.fromWebview?!0:!1,t.config.options.disableLogs=t.config.options.disableLogs?t.config.options.disableLogs:!1,t.config.options.fulfillOnClose=t.config.options.fulfillOnClose?t.config.options.fulfillOnClose:!1,"ios"===n){if(null===t.config.options.schema)throw new BmAuth.Error("Schema was not set in the webview querystring when the platform was ios","EBAB06");new RegExp("bmauth.").test(t.config.options.schema)===!1&&t.errorhandler.onWarning(new BmAuth.Warning("The format of schema used in the webview querystring is not acceptable (schema: "+t.config.options.schema+")","WBAB07"))}("ios"===n||"android"===n)&&(t.constants.timer.authZWarningTreshold=4e3,t.constants.timer.authZTimeoutTreshold=12e3,t.constants.timer.identityWarningTreshold=4e3,t.constants.timer.identityTimeoutTreshold=12e3,t.constants.timer.bounceWarningTreshold=1e3,t.constants.timer.bounceTimeoutTreshold=3e3,t.constants.timer.configWarningTreshold=4e3,t.constants.timer.configTimeouTreshold=12e3,t.constants.timer.closeModalOnSuccess=2e3,t.constants.timer.closeModalOnSuccessMulti=8e3,t.constants.timer.thirdPartyCookieTimeout=7500,t.constants.timer.initWarningTreshold=4e3,t.constants.timer.initTimeoutTreshold=12e3,t.constants.timer.registerWarningTreshold=4e3,t.constants.timer.registerTimeoutTreshold=12e3,t.constants.timer.styelsheetTimeoutTreshold=8e3),t.constants.domain=window.location.protocol+"//"+window.location.hostname};BmAuth.init=function(e,o,i,a){try{r(e,o,i,a),t.log("main","initiating BmAuth ",{brand:t.config.brand,platform:t.config.platform,environment:t.config.environment,options:t.config.options}),"object"==typeof n&&"function"==typeof n.init&&n.init.call()}catch(s){return Promise.reject(t.errorhandler.onError(s))}return t.ready},BmAuth.handleSignIn=function(){return n.handleSignIn()},BmAuth.handleSignOut=function(){return n.handleSignOut()},BmAuth.handleLocalSignOut=function(){n.handleLocalSignOut()},BmAuth.isAuthenticated=function(){return n.isAuthenticated()},BmAuth.getTrackingSuites=function(e){return n.getTrackingSuites(e)},BmAuth.canPlayVideo=function(e){return n.canPlayVideo(e)},BmAuth.videoHasLock=function(e){return n.videoHasLuck(e)},BmAuth.videosAddLockStatus=function(e){return n.videosAddLockStatus(e)},BmAuth.getSignInBduName=function(){return n.getSignInBduName()},BmAuth.getIdentity=function(){return n.getIdentity()},BmAuth.addListener=function(e,n){t.event.addListener(e,n)},BmAuth.removeListener=function(e,n){t.event.removeListener(e,n)},BmAuth.displayMessage=function(e){n.displayMessage(e)},BmAuth.registerDevice=function(e){return n.registerDevice(e)},BmAuth.closeModal=function(e){n.closeModal(e)},BmAuth.define=function(e){var i,r;if("object"!=typeof e)throw new BmAuth.Error("The define method expects a configuration object as the sole argument","EBAA01");if(!e.type&&!e.name&&!e.value)throw new BmAuth.Error("The define method's configuration object requires at least three properties: type, name and value","EBAA02");r=e.name.toLowerCase(),i=e.type.toLowerCase(),"controller"===i?n=e.value.call({},t,o):"api-method"===i?t[r]=e.value.call({},t):(t[i]||(t[i]={}),t[i][r]=e.value.call({},t))},BmAuth.newDefine=function(e){var i=e.name,r=e.type.toLowerCase();BmAuth.test||(BmAuth.test={}),"controller"===r?n=e.value.call({},t):"api-method"===r?(t[i]=e.value,BmAuth.test.api||(BmAuth.test.api={}),BmAuth.test.api[i]=e.value):(o[i]=e.value,BmAuth.test.module||(BmAuth.test.module={}),BmAuth.test.module[i]=e.value)},t.createModule=function(e,n){var o;if(e=e.toLowerCase(),!t.module[e])throw new BmAuth.Error("Module Creation Error: "+e+" module not found","EBAA04");return t.module[e].init?(o=Object.create(t.module[e]),o.init.call(o,n)):o=t.module[e],o},t.log=function(e,n,o,i){i=i||"log";var r=t.inDebug();if(r)switch(i){case"log":void 0===o?console.log("[BmAuth] "+e+" => "+n):console.log("[BmAuth] "+e+" => "+n,o);break;case"warning":null===n?console.warn("[BmAuth] ",o):console.warn("[BmAuth] "+e+" => "+n,o);break;case"error":null===n?console.error("[BmAuth] ",o):console.error("[BmAuth] "+e+" => "+n,o);break;case"info":void 0===o?console.info("[BmAuth] "+e+" => "+n):console.info("[BmAuth] "+e+" => "+n,o);break;default:void 0===o?console.log("[BmAuth] "+e+" => "+n):console.log("[BmAuth] "+e+" => "+n,o)}},t.getParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},t.inDebug=function(){try{if(t.constants.authSetting.inDebug===!1)return!1;var e=t.getParameterByName("BaDisableLogs");return""!==e?"false"===e:t.config.options?!t.config.options.disableLogs:!0}catch(n){return!1}},t.isAuthenticatedLocal=function(){return n.isAuthenticatedlocal()},t.forceSignOutLocal=function(){n.forceSignOutLocal()},t.resetJsCache=function(){n.resetJsCache()},t.domReady=new Promise(function(t,n){e(document).ready(t)}),t.ready=new Promise(function(e,n){t.domReady.then(function(){t.event.addInternalListener("onReady",e),t.event.addInternalListener("onReadyFailed",n)})}),BmAuth.api=t,i()}(jQuery),function(e,t){"use strict";e.Warning=function(e,t,n){this.message=e||"A non blocker exception got cought",
this.code=t||"warning-00",this.stack=(new Error).stack,this.options=n||void 0},e.Warning.prototype=Object.create(Error.prototype),e.Warning.prototype.constructor=e.Warning,e.Error=function(e,t,n){this.message=e||"A blocker exception got cought",this.code=t||"error-00",this.stack=(new Error).stack,this.options=n||void 0},e.Error.prototype=Object.create(Error.prototype),e.Error.prototype.constructor=e.Error,e.Error.fromError=function(e){return new this(e.message,"error-00",e.stack)},e.define({name:"ErrorHandler",type:"api-method",value:function(t){var n=[],o=function(t){void 0!==t&&t instanceof e.Warning&&n.push(t)},i=function(e){return{error:e,warnings:n}},r=function(e){s(e),a(e)},a=function(e){},s=function(n){n instanceof e.Warning?t.log(null,null,{message:n.message,code:n.code},"warning"):t.log(null,null,n,"error")};return{init:function(){},onError:function(n,o){return"string"==typeof n&&(n=new e.Error(n,"error-00")),n instanceof e.Error||n.code||(n.code="error-00"),r(n),t.constants.ui.element?o!==!1&&t.view.displayError(n):o===!0&&t.modal.display().then(function(){t.view.displayError(n)}),i(n)},onWarning:function(t){t instanceof e.Warning?(r(t),o(t)):this.onWarning(new e.Warning("The argument of onWarning was not of type BmAuth.Warning or BmAuth.Error","WBAA01"))},onException:function(n){n instanceof e.Warning?t.errorhandler.onWarning(n):t.errorhandler.onError(n)},getWarnings:function(){return n}}}})}(BmAuth,jQuery),function(e,t){"use strict";e.define({name:"event",type:"api-method",value:function(t){var n,o=["onSignInAttempt","onBduSelected","onAuthenticationStateChange","onInfoClicked","onAlreadyAuthenticated"],i={},r={},a={},s={},c=function(e,n,o){t.log("event","add dom listener: "+e+" on "+n),u(t.constants.ui.element,e,n,o)},u=function(e,t,n,o){e.addEventListener(t,function(t){for(var i=e.querySelectorAll(n),r=t.target,a=0,s=i.length;s>a;a++)for(var c=r,u=i[a];c&&c!==e;){if(c===u)return o.call(u,t);c=c.parentNode}},!1)},l=function(e,n){t.log("event","removing event:"+e+" from DOM"),t.constants.ui.element.removeEventListener(e,n,!1)},d=function(e){return-1!==o.indexOf(e)},h=function(n,o){"logout_result"!==n&&(t.log("event","no user listening to the event, stacked "+n),g(n,o)),d(n)&&t.errorhandler.onWarning(new e.Warning("No user was listening to the event "+n+" when it was being thrown, it is being stacked waiting for the listener to register to release the stack","WBAB01"))},f=function(e,t,n){s.push({eventName:e,target:t,callback:n})},g=function(e,t){a[e]||(a[e]=[]),a[e].push(t)},m=function(e){if(a[e]&&a[e].length>0){t.log("event","re-firing: "+e);for(var o=0,i=a[e].length;i>o;o++){var r=a[e].shift();n.trigger(e,r)}}},p=function(n){if(t.log("event","broadcastin message for android.",n),"undefined"==typeof androidInterface)throw new e.Error("Sending message to Android failed. No class instance with the name 'webAppInterfaceAndroid' was injected in the webview","EBAB05");androidInterface.sendMessage(JSON.stringify(n))},v=function(e){var n=t.config.options.schema||"bmauth";t.log("event","broadcasting message for ios "+n+"://url?msg=",e),window.location=n+"://url?msg="+encodeURIComponent(JSON.stringify(e))};return{init:function(){n=this,s=[]},addListenerToDom:function(e,t,n){f(e,t,n),c(e,t,n)},removeAllListenersFromDom:function(){t.log("event","removing all listeners"),s.forEach(function(e){l(e.eventName,e.callback)}),s=[]},broadcastForApp:function(n){switch(t.config.platform){case"ios":v(n);break;case"android":p(n);break;default:t.errorhandler.onWarning(new e.Warning("Broadcasting for app failed as the configured platform "+t.config.platform+" is not valid","warning-10")),v(n)}},addListener:function(e,n){return i[e]||(i[e]=[]),i[e].push(n),t.log("event","add listener: "+e+"["+i[e].length+"]"),m(e),[e,n]},removeListener:function(e,n){var o;if(i[e]){o=i[e].length;for(var r=0;o>r;r++)i[e][r]===n&&(i[e].splice(r,1),t.log("event","removed event: "+e+"["+i[e].length+"]"))}},trigger:function(){var e,n=Array.prototype.slice.call(arguments),o=n.shift();if(i[o]&&i[o].length>0){e=i[o],t.log("event","triggered "+o,{"callbacks.length":e.length,args:n});for(var r=e.length;r--;)e[r].apply(window,n)}else h(o,n)},addInternalListener:function(e,n){return r[e]||(r[e]=[]),r[e].push(n),t.log("event","add internal listener: "+e+"["+r[e].length+"]"),[e,n]},removeInternalListener:function(e,n){var o;if(r[e]){o=r[e].length;for(var i=0;o>i;i++)r[e][i]===n&&(r[e].splice(i,1),t.log("event","removed internal event: "+e+"["+r[e].length+"]"))}},triggerInternal:function(){var e,n=Array.prototype.slice.call(arguments),o=n.shift();if(r[o]&&r[o].length>0){e=r[o],t.log("event","internally triggered "+o,{"callbacks.length":e.length,args:n});for(var i=e.length;i--;)e[i].apply(window,n)}else h(o,n)}}}})}(BmAuth,jQuery),function(e,t){"use strict";e.define({name:"Modal",type:"api-method",value:function(n){var o,i=!1,r=!1,a={_startTime:null,_endTime:null,duration:null,start:function(){this._startTime=Date.now()},stop:function(){this._endTime=Date.now(),this.duration=this._endTime-this._startTime}},s=function(){n.view.insert("body",n.view.insertModal()),n.log("view","modal inserted into page"),o=t("[data-remodal-id=axisauth]").remodal({hashTracking:!1}),n.constants.ui.element=document.querySelector(n.constants.ui.id),r=!0,g()},c=function(){n.log("view","modal is opened"),o.open(),n.event.trigger("onModalOpen"),i=!0},u=function(){o&&o.close()},l=function(){n.event.removeAllListenersFromDom(),n.view.remove(n.constants.ui.overlayBG),n.view.remove(n.constants.ui.overlay),n.log("view","modal removed from page"),o=null,r=!1,n.constants.ui.element=null},d=function(t){n.log("view","inserting "+t+" CSS into the head");var o=document.createElement("link"),i=document.createElement("div");o.type="text/css",o.rel="stylesheet",o.href=n.constants.url.authRoot+"styles/"+t+".css",o.id="bmauth-css-"+t,o.className="bmauth-css",i.id="beacon-"+t,document.head.appendChild(o),document.body.appendChild(i);var r=n.vwfix.mayFix(t),a=new Promise(function(o,r){var a,s;a=window.setTimeout(function(){window.clearInterval(s),document.body.removeChild(i);var o=new e.Error("Stylesheet "+t+" did not get loaded into page by 8 seconds","EBAX11");n.errorhandler.onError(o),r(o)},n.constants.timer.styelsheetTimeoutTreshold),s=window.setInterval(function(){42===i.clientWidth&&(window.clearInterval(s),window.clearTimeout(a),document.body.removeChild(i),o())},30)});return Promise.all([a,r])},h=function(){return"cravetv"!==n.config.brand.toLowerCase()?d("main"):d("main").then(function(){d("cravetv")})},f=function(){t("head .bmauth-css").remove(),n.log("view","removed BmAuth CSSs from the head")},g=function(){var e=function(e){try{n.event.trigger("onModalClose"),n.log("view","modal is clossing"),i=!1,f(),l()}catch(t){n.errorhandler.onError(t)}};t(document).off("close","#axis-auth.remodal"),t(document).on("close","#axis-auth.remodal",e),n.event.addListenerToDom("click",".axis-auth-close",function(e){e.stopImmediatePropagation(),u()}),n.event.addListenerToDom("click",".axis-auth-info",function(e){n.tracking.onInfoClicked(),n.view.displayFAQ("cravetv"===n.config.brand?n.constants.url.faq+"crave-faq.html?lang="+n.config.lang:n.constants.url.faq+"main.html?lang="+n.config.lang)}),n.event.addListenerToDom("click",".axis-auth-back",function(e){e.stopImmediatePropagation(),n.view.navigateBack()})};return{display:function(){if(i)return Promise.resolve();a.start();var e=h();return e.then(function(){s(),c(),a.stop(),n.log("view","all CSSs was loaded in "+a.duration+"ms")}),e},close:function(e){e?setTimeout(function(){u()},e):u()}}}})}(BmAuth,jQuery),function(e){"use strict";e.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height()}}(jQuery),function(e,t,n){"use strict";e.define({name:"view",type:"api-method",value:function(o){var i={},r=["bdu-chooser","faq"],a={errorTextOnly:{name:"error-text-only",content:{paragraphs:["There has been a technical problem!","Please try again and if the problem persists, please contact your television service provider."],showBackButton:!0,closeLinkText:"Close"}},errorTpCookie:{name:"error-tpcookie",content:{showBackButton:!0,closeLinkText:"Close"}},successMessage:{name:"success-message",content:{logoSource:null,text:"You have successfully signed into"}},bduChooser:{name:"bdu-chooser",nameLong:"bdu-chooser-long",data:{}},bduLogin:{name:"bdu-login",data:{}},faq:{name:"faq",data:{url:null}}},s=function(e){var t;switch(e){case"EBAX00":t=a.errorTextOnly.content,t.paragraphs[0]=o.config.messages.error[e],t.paragraphs[1]=o.config.messages.error.error_p2,t.closeLinkText=o.config.messages.main.closeLinkText,t.header=o.config.messages.main.header,o.view.displayTemplate(a.errorTextOnly.name,t);break;case"error-01":t=a.errorTextOnly.content,t.paragraphs[0]=o.config.messages.error[e],t.paragraphs[1]=o.config.messages.error.error_p2,t.closeLinkText=o.config.messages.main.closeLinkText,t.header=o.config.messages.main.header,o.view.displayTemplate(a.errorTextOnly.name,t);break;case"EBAD01":case"EBAD02":case"EBAD03":case"EBAD04":case"EBAD05":case"EBAD06":case"EBAE02":case"EBAE03":case"EBAE04":case"EBAE05":case"EBAE06":case"EBAE07":t=a.errorTextOnly.content,t.paragraphs[0]=o.config.messages.error["error-60-p1"],t.paragraphs[1]=o.config.messages.error["error-60-p2"],t.closeLinkText=o.config.messages.main.closeLinkText,t.header=o.config.messages.main.header,o.view.displayTemplate(a.errorTextOnly.name,t);break;case"EBAC04":t=a.errorTextOnly.content,t.paragraphs[0]=o.config.messages.error["error-68-p1"],t.paragraphs[1]=o.config.messages.error["error-68-p2"],t.closeLinkText=o.config.messages.main.closeLinkText,t.header=o.config.messages.main.header,o.view.displayTemplate(a.errorTextOnly.name,t);break;case"EBAF01":case"error-31":case"error-32":t=a.errorTpCookie.content,t.pg1=o.config.messages.error["error-30-p1"],t.pg2a=o.config.messages.error["error-30-p2a"],t.pg2b=o.config.messages.error["error-30-p2b"],t.tpCookieUrl=o.config.tpCookieUrl,t.tpCookieUrlText=o.config.messages.error["error-30-urlText"],t.closeLinkText=o.config.messages.main.closeLinkText,t.header=o.config.messages.main.header,o.view.displayTemplate(a.errorTpCookie.name,t);break;case"EBAF02-activate":t=a.errorTextOnly.content,t.paragraphs[0]=o.config.messages.error["EBAF02-activate-p1"],t.paragraphs[1]=o.config.messages.error["EBAF02-activate-p2"],t.closeLinkText=o.config.messages.main.closeLinkText,t.header=o.config.messages.main.header,o.view.displayTemplate(a.errorTextOnly.name,t);break;default:o.view.displayTemplate(a.errorTextOnly.name,a.errorTextOnly.content)}o.event.addListenerToDom("click",".close-button",function(e){o.modal.close()})},c=function(e,t){var n;i[e]?(n=i[e],o.log("view","display template "+e+" (cached)")):(n=u(e,t),f(e)&&(i[e]=n),o.log("view","display template "+e)),l(o.constants.ui.container,n)},u=function(t,i){var r=o.template[t];if(!r)throw new e.Error("Template not found (templateName:"+t+")","EBAA03");return n.render(r,i)},l=function(e,n){t(e).html(n)},d=function(){return"undefined"!=typeof window.orientation?!0:!1},h=function(){var e=t("#axis-auth").find(".axis-auth-main"),n=e.find(".axis-auth-middle"),i=e.find(".axis-auth-logos-container"),r=n.hasScrollBar();if(r){e.addClass("with-scroll"),n.addClass("scrolled");var a=i[0].offsetWidth-i[0].clientWidth;d()?10>a&&n.addClass("mini-scrol"):(n.addClass("show-scroll"),n[0].style.width=n[0].clientWidth+a+"px")}else e.removeClass("with-scroll"),n.removeClass("scrolled"),"web"===o.config.platform&&(n.removeClass("show-scroll"),n[0].style.width="")},f=function(e){return-1!==r.indexOf(e)?!0:!1};return{init:function(){i={}},displayError:function(n){n&&void 0!==n.code?s(n.code):(s("error-00"),o.errorhandler.onWarning(new e.Warning("Error could not be displayed because it was not instance of error","WBAA02"))),i["bdu-chooser"]||t(".axis-auth-back").hide()},displayMessage:function(e){s(e),i["bdu-chooser"]||t(".axis-auth-back").hide()},displayAuthZNoMessage:function(e){var t,n=e.toUpperCase();t=JSON.parse(JSON.stringify(a.errorTextOnly.content)),t.paragraphs[0]=o.config.messages.error["authzNo-p1-left"]+n+o.config.messages.error["authzNo-p1-right"],t.paragraphs[1]=o.config.messages.error["authzNo-p2"],t.closeLinkText=o.config.messages.main.closeLinkText,t.header=o.config.messages.main.header,t.showBackButton=!1,o.view.displayTemplate(a.errorTextOnly.name,t),o.event.addListenerToDom("click",".close-button",function(){o.modal.close()})},displayACustomuthZNoMessage:function(e){var t;t=JSON.parse(JSON.stringify(a.errorTextOnly.content)),t.paragraphs[0]=e,t.paragraphs[1]="",t.closeLinkText=o.config.messages.main.closeLinkText,t.header=o.config.messages.main.header,t.showBackButton=!1,o.view.displayTemplate(a.errorTextOnly.name,t),o.event.addListenerToDom("click",".close-button",function(){o.modal.close()})},displayAuthZNoMessageMultiAuthz:function(e,t){var n={logoSource:e,header:o.config.messages.main.header,topText:o.config.messages.error["authzNo-multi-top"],bottomText:o.config.messages.error["authzNo-multi-bottom"],notAuthorizedResources:t.notAuthorized,brand:o.config.brand,buttonText:"ios"===o.config.platform||"android"===o.config.platform?"Back":"close"};o.view.displayTemplate("authzno-message-multi",n),o.event.addListenerToDom("click",".close-button",function(){o.modal.close()})},displaySuccessMessage:function(e){var t=a.successMessage.content;t={logoSource:e,header:o.config.messages.main.header,text:o.config.messages.success.signin},o.view.displayTemplate(a.successMessage.name,t)},displaySuccessMessageMultiAuthz:function(e,t){var n={logoSource:e,header:o.config.messages.main.header,text:o.config.messages.success.signin,accessToText:o.config.messages.success.successMultiAccessto,noAccessToText:o.config.messages.success.successMultiNoAccessto,contactTV:o.config.messages.success.contactTV,authorizedResources:t.authorized,notAuthorizedResources:t.notAuthorized,hasNoAuthz:t.notAuthorized.length>0?!0:!1,numYes:"logo"+t.authorized.length,numNo:"logo"+t.notAuthorized.length,topShort:t.notAuthorized.length>=2?"top-short":""};o.view.displayTemplate("success-message-all",n)},displayCrossAuthenticatedMessage:function(){var e=a.successMessage.content;e={logoSource:null,header:o.config.messages.main.header,text:o.config.messages.success["cross-site-signin"]},o.view.displayTemplate(a.successMessage.name,e)},displayBduChooser:function(e){a.bduChooser.data={logos:e,header:o.config.messages.main.header,subHeader:o.config.messages.bduChooser.subHeader,guestUsers:o.config.messages.bduChooser.guestUsers,providerNotListed:o.config.messages.bduChooser.providerNotListed,bellmediaLogo:o.vars.bellmediaLogo},o.view.displayTemplate(a.bduChooser.name,a.bduChooser.data),h()},loadBduLoginIframe:function(e){a.bduLogin.data={source:e,header:o.config.messages.main.header},o.view.displayTemplate(a.bduLogin.name,a.bduLogin.data)},loadBduLoginIframeHidden:function(e){a.bduLogin.data={source:e,header:o.config.messages.main.header},o.view.renderHiddenTemplate(a.bduLogin.name+"-hidden",a.bduLogin.data)},displayFAQ:function(e){a.faq.data={url:e,header:o.config.messages.main.header,subTitle:o.config.messages.faq.subTitle,faqs:o.config.faq},o.view.displayTemplate(a.faq.name,a.faq.data),t(".bmauth-answer").hide(),t(".bmauth-question").click(function(e){var n=t(this).parent().parent().find(".bmauth-faq-chevron"),o=t(this).parent().find(".bmauth-answer");o.is(":visible")?o.hide(200):o.show(200),n.toggleClass("downward")}),i["bdu-chooser"]||t(".axis-auth-back").hide()},navigateBack:function(){c("bdu-chooser"),h()},displayTemplate:function(e,t){c(e,t)},renderHiddenTemplate:function(e,n){var i=u(e,n);t(o.constants.ui.container).prepend(i)},insert:function(e,n){t(e).append(n)},empty:function(e){t(e).empty()},remove:function(e){t(e).remove()},insertModal:function(){this.insert("body",u("modal-base",{brand:o.config.brand}))}}}})}(BmAuth,jQuery,Mustache),function(e,t){"use strict";e.define({type:"api-method",name:"Storage",value:function(t){var n,o=2628e6,i=function(e){return"BMAuth_"+e},r=function(){try{return JSON.stringify({a:"b"}),"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},a=function(e,t,n,o,i,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var a="";if(n)switch(n.constructor){case Number:a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:a="; expires="+n;break;case Date:a="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+(i?"; domain="+i:"")+(o?"; path="+o:"")+(r?"; secure":""),!0},s=function(e){return e?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},c=function(e){return e?new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie):!1},u=function(e,t,n){return this.hasItem(e)?(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0):!1},l=function(){for(var e=[],t=0;t<localStorage.length;t++)"BMAuth_"===localStorage.key(t).substring(0,7)&&e.push(localStorage.key(t));for(t=0;t<e.length;t++)localStorage.removeItem(e[t])},d=function(){for(var e=document.cookie.split(/=[^;]*(?:;\s*|$)/),t=0;t<e.length;t++)/^BMAuth_/.test(e[t])&&(document.cookie=e[t]+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")};return{init:function(){n=r(),t.log("storage","browser local storage support is: "+n)},get:function(e){e=i(e);var o,r=new Date;try{return n?(o=localStorage.getItem(e),null!==o?(o=JSON.parse(o),o.expires?o.expires>Number(r.getTime())?(t.log("storage","localstorage.get "+e,o),o.data):(t.log("storage","localstorage.get "+e+" returned null since it was expired"),this.remove(e),null):(t.log("storage","localstorage.get "+e,o),o.data)):(t.log("storage","localstorage.get could not find "+e),null)):(o=s(e),null!==o?(o=JSON.parse(o),t.log("storage","cookie.get "+e,o),o):(t.log("storage","cookie.get could not find "+e),null))}catch(a){}},set:function(e,o,r){try{e=i(e);var s=new Date;if(n){var c={data:o,timestamp:s.getTime()};r&&(c.expires=Number(s.getTime())+Number(r)),t.log("storage","localstorage.set key:"+e+" value:",c),localStorage.removeItem(e),localStorage.setItem(e,JSON.stringify(c))}else t.log("storage","cookie.set key:"+e+" value:",o),r?s.setTime(s.getTime()+Number(r)):s.setFullYear(2030,1,14),a(e,JSON.stringify(o),s)}catch(u){t.errorhandler.onError(u)}},setSession:function(n,o){try{t.log("storage","set in sessionStorage (name: "+n+", value: "+o),sessionStorage.setItem(i(n),JSON.stringify(o))}catch(r){throw new e.Error("User was in a browser private mode that doesn't support session\\local storage","EBAF02")}},getSession:function(e){var n=sessionStorage.getItem(i(e));return t.log("storage","get from sessionStorage name: "+e),JSON.parse(n)},removeSession:function(e){sessionStorage.removeItem(i(e)),t.log("storage","removed from sessionStorage name: "+e)},setCacheDuration:function(e){t.log("storage","cache duration changed from "+o+" to "+e),o=e},hasItem:function(e){return e=i(e),n?localStorage.hasItem(e):c(e)},reset:function(){n?l():d(name),window.ais_client._reset_cache(!0)},remove:function(e){e=i(e),n?localStorage.removeItem(e):u(e)}}}})}(BmAuth,jQuery),function(e,t){"use strict";e.define({name:"tracking",type:"api-method",value:function(e){return{onSignInAttempt:function(){e.event.trigger("onSignInAttempt")},onBduSelected:function(t){e.event.trigger("onBduSelected",t)},onAuthnChanged:function(t){e.event.trigger("onAuthenticationStateChange",t)},onAlreadyAuthenticated:function(){e.event.trigger("onAlreadyAuthenticated")},onInfoClicked:function(){e.event.trigger("onInfoClicked")}}}})}(BmAuth,jQuery),function(e,t){"use strict";e.define({name:"vwfix",type:"api-method",value:function(n){var o,i=function(o,i){return new Promise(function(a,s){t.ajax({url:o,contentType:"application/javascript",jsonpCallback:"callback",dataType:"jsonp",success:function(e){try{r(e,i),a()}catch(t){s(t)}},error:function(t,i,r){n.log("vwfix","getCSS("+o+") "+r);var a=new e.Error("Reading the vw-fix js file failed. (filename: "+o+",error: "+r+")","EBAE08");s(a)}})})},r=function(e,o){var i=a(e.css);n.log("vwfix",o+" is being inserted into the head"),t("head").append('<style id="'+o+'">'+i+"</style>")},a=function(e){o=["vw","vh","vm"];var t=window.innerWidth,n=window.innerHeight,i=Math.min(t,n);return e.replace(new RegExp("\\b([0-9]*\\.?[0-9]+)("+o.join("|")+")\\b","gi"),function(e,o,r){switch(r){case"vw":return o*t/100+"px";case"vh":return o*n/100+"px";case"vm":return o*i/100+"px"}})};return{mayFix:function(e){return new Promise(function(t,o){var r=n.constants.url.authRoot+"styles/vwfix."+e+".js",a="vwfix."+e,s=document.createElement("_").style,c=["vw"].filter(function(e){return s.width="",s.width="10"+e,!s.width});c.length?(n.log("vwfix","inserting vw fix for "+e+".css"),i(r,a).then(t)["catch"](o)):t()})}}}})}(BmAuth,jQuery),function(e){"use strict";var t=function(){};t.prototype.start=function(){this._startTime=Date.now()},t.prototype.stop=function(){this._endTime=Date.now(),this.duration=this._endTime-this._startTime},t.prototype.reset=function(){this._startTime=null,this._endTime=null,this.duration=null},e.newDefine({name:"Timer",type:"api-method",value:t})}(BmAuth),function(e,t,n){"use strict";e.define({name:"AuthAdmin",type:"module",value:function(n){var o,i,r,a={_startTime:null,_endTime:null,duration:null,start:function(){this._startTime=null,this._endTime=null,this.duration=null,this._startTime=Date.now()},stop:function(){this._endTime=Date.now(),this.duration=this._endTime-this._startTime},isConfigWarningTreshold:function(){return this.duration>n.constants.timer.configWarningTreshold?!0:!1}},s=function(){var e=n.constants.url.config+n.config.brand+"/"+n.config.platform+"/"+("prod"===n.config.environment?"prod":"test");return n.log("admin","brandconfig urn is "+e),e},c=function(){return o.brand.faq},u=function(){n.config.brandUrn=o.brand.akamai.platform_id,n.config.lang=o.brand.lang.def,n.config.messages=d(),n.config.faq=c(),n.config.isMultiAuthzFlow=o.brand.hasMultiAuthzFloq,n.config.tpCookieUrl=o.brand.tpCookieUrl},l=function(){return new Promise(function(i,r){function l(t){a.stop(),a.isConfigWarningTreshold()&&n.errorhandler.onWarning(new e.Warning("AuthAdmin config request took "+a.duration+" ms","WBAD01",{duration:a.duration})),o=t.config,n.log("admin","recieved config in "+a.duration+"ms:",o);try{n.storage.setSession("brandConfig",o)}catch(s){n.config.messages=d();try{n.config.faq=c()}catch(l){}r(s)}u(),i()}function h(o,i){if(a.stop(),3>g)g++,n.errorhandler.onWarning(new e.Warning("AuthAdmin config request failed as warning on "+g+" try after "+a.duration+"ms. ("+i+")","WBAE01",{duration:a.duration})),a.start(),t.ajax(f).done(l).fail(function(e,t){h(e,t)});else{var s;s="timeout"===i?new e.Error("Getting brand config from authadmin failed. (reason: timeout "+a.duration+"ms)","EBAD01",{duration:a.duration}):new e.Error("Getting brand config from authadmin failed. (reason: "+i+")","EBAE01"),r(s)}}var f={contentType:"application/json",url:s(),timeout:n.constants.timer.configTimeouTreshold,dataType:"jsonp",jsonpCallback:"axisconfig",crossDomain:!0,cache:!0},g=0;a.start(),t.ajax(f).done(l).fail(function(e,t){h(e,t)})})},d=function(){return"en"===n.config.lang?{main:{header:"Sign in to Watch",d2cHeader:"Sign In",faqLinkText:"FAQ",helpLinktext:"HELP",backLinkText:"Back",closeLinkText:"Close"},bduChooser:{subHeader:"Choose your TV service provider to get access to live streaming and more content.",guestUsers:"Access for all guest users",providerNotListed:"Provider not listed? Stay tuned, we will be adding more TV providers shortly.",d2cSubheader:"How did you subscribe?",d2cTabText:"Directly From CraveTV",chooserTabText:"Through My TV Provider",newToCraveText:"New to CraveTV?",start30Trial:"Start your free one month trial"},error:{error_p2:"Please try again and if the problem persists, please contact your television service provider.","error-00":"There has been a technical problem!","error-01":"There has been a network issue!","error-60-p1":"Sorry, your request could not go through at this time.","error-60-p2":"Please try again later.","error-30-p1":"We have detected that your browser is blocking third party cookies which are needed for authentication. You are required to enable third party cookies","error-30-p2a":"Provided","error-30-p2b":"here are the tips on how to accomplish this.","error-30-urlText":"here","authzNo-p1-left":"To watch video, you must be subscribed to ","authzNo-p1-right":" with your television service provider.","authzNo-p2":"If you already subscribe to this channel and are still experiencing difficulties, please contact your service provider.","authzNo-multi-top":"To enjoy thousands of hours of spectacular content from these channels, please contact your service provider today to subscribe.","authzNo-multi-bottom":"If you are already a subscriber and are experiencing difficulties, please contact your TV service provider.","error-68-p1":"You have an invalid postal code, unfurtunately we can't proccess further","error-68-p2":"Please contact your service provier.","EBAF02-activate-p1":"Alert: You are in private browsing mode.","EBAF02-activate-p2":"In order to continue, you need to disable private browsing.For steps to disable private browsing, please visit FAQs on the app or '?' on this screen."},success:{signin:"You have successfully signed into","cross-site-signin":"Video Sign In successful.",successMultiAccessto:"Which provides you access to the following channel(s):",successMultiNoAccessto:"You are currently not subscribed to the following channel(s):",contactTV:"If you are already a subscriber and are experiencing difficulties, please contact your TV service provider."},faq:{subTitle:"Frequently Asked Questions"}}:{main:{header:"Se connecter pour regarder",d2cHeader:"[fr]Sign In",faqLinkText:"[fr]FAQ",helpLinktext:"[fr]HELP",backLinkText:"[fr]Back",closeLinkText:"Fermer"},bduChooser:{subHeader:"Choisissez votre fournisseur pour accder aux diffusions en direct et  du contenu supplmentaire.",guestUsers:"Accs pour les utilisateurs invits de Bell Mdia.",providerNotListed:"Votre fournisseur nest pas dans la liste? Restez  lafft, nous ajouterons des fournisseurs bientt.",d2cSubheader:"[fr]How did you subscribe",d2cTabText:"[fr]Directly From CraveTV",chooserTabText:"[fr]Through My TV Provider",newToCraveText:"[fr]New to CraveTV?",start30Trial:"[fr]Start you free 30 day trial"},error:{error_p2:"Veuillez essayer de nouveau. Si le problme persiste, veuillez contacter votre tldistributeur.","error-00":"Il y a un problme technique!","error-01":"There has been a network issue!","error-60-p1":"Dsol, votre requte ne peut pas tre achemin maintenant.","error-60-p2":"Veuillez ressayer plus tard.","error-30-p1":"Nous avons dtect que votre navigateur bloque les cookies tiers qui sont ncessaires afin de vous identifier. Veuillez les activer.","error-30-p2":"Voici les instructions afin dy parvenir.","authzNo-p1-left":"Vous devez etre abonne a  ","authzNo-p1-right":" aupres de votre fournisseur de services de television afin de visionner une video","authzNo-p2":"Si vous etes deja abonne a cette chaine et eprouvez toujours des difficultes, veuillez contacter votre fournisseur."},success:{signin:" Vous tes maintenant connect ","cross-site-signin":"Vous avez t authentifi multisite."},faq:{subTitle:"Foire aux questions"}}};return{init:function(){r=!1,o=null,i=void 0},getConfig:function(){return n.log("admin","getting brand config"),null===o?(o=n.storage.getSession("brandConfig"),null===o?l():(n.log("admin","reading brandConfig from session",o),u(),Promise.resolve())):(n.log("admin","reading brandConfig from cache",o),u(),Promise.resolve())},brandBduList:function(){return o.brand.bdus},resourceIds:function(){var e=[];for(var t in o.brand.akamai.resourceID)e.push(t);return e},getAuthZResources:function(){return o.brand.akamai.resourceID},resourceIdsLogos:function(){return o.brand.akamai.resourceId},getBrandTrackingSuites:function(){return o.brand.tracking.rsid},getBduFromName:function(e){for(var t=0,n=o.brand.bdus.length;n>t;t++)if(o.brand.bdus[t].name===e)return o.brand.bdus[t];return null},getResourceName:function(e){if(o.brand.akamai.resourceID[e]){var t=o.brand.akamai.resourceID[e].displayName;return void 0!==t?t:e}return e}}}})}(BmAuth,jQuery,ais_client),function(e,t,n){"use strict";e.define({name:"AuthN",type:"module",value:function(o){var i,r,a,s,c=0,u=!1,l=!1,d={status:void 0,signInBduName:null,signInBduLogoSrc:null,signInBdu:null,ttl:null},h={_startTime:null,_endTime:null,duration:null,start:function(){this._startTime=Date.now()},stop:function(){this._endTime=Date.now(),this.duration=this._endTime-this._startTime},isIdentityWarningTreshold:function(){return this.duration>o.constants.timer.identityWarningTreshold?!0:!1},isBounceWarningTreshold:function(){return this.duration>o.constants.timer.bounceWarningTreshold?!0:!1},isInitWarningTreshold:function(){return this.duration>o.constants.timer.initWarningTreshold?!0:!1},isRegisterWarningTreshold:function(){return this.duration>o.constants.timer.registerWarningTreshold?!0:!1},reset:function(){this._startTime=null,this._endTime=null,this.duration=null}},f=null,g=function(e){return n.loginFormat(e,o.constants.akamaiConfig.responseTarget)},m=function(e){return-1===o.constants.accepted.messageOrigin.authn.indexOf(e.origin)?!1:!0},p=function(e){var n=pako.inflateRaw(t.base64.decode(e),{to:"string"});n=n.slice(12,n.length-2),s=jQuery.parseJSON(n),C(s);var i="logout_result"!==s._type&&s.authenticated;return o.log("authn","akamai authentication redirect responnce isValid: "+i,s),i},v=function(e){d.signInBduName=e.data("name"),d.signInBduLogoSrc="BellMG"===d.signInBduName?e.data("img"):e.find("img").attr("src"),o.storage.set("signInBduName",d.signInBduName),o.tracking.onBduSelected(d.signInBduName)},y=function(e,n){try{n.stopImmediatePropagation();var i=t(e),r=g(i.data("urn"));return v(i),o.view.loadBduLoginIframe(r),w(r)}catch(a){return Promise.reject(a)}},b=function(t){var n,i=new Promise(function(t,i){n=function(n){if(m(n,r)&&l!==!0)try{var r=JSON.parse(n.data);if("aisRedirect"!==r.messageSender)return;if(o.log("authn","akamai authn redirect message recived:"),!p(r.response))throw new e.Error("Akamai authentication redirect failed as the response did not indicate the user was authenticated (responseType: "+s._type+", authenticated:"+s.authenticated+" ","EBAE02");l=!0,t()}catch(a){i(a)}},window.addEventListener("message",n,!1)});return i.then(function(){window.removeEventListener("message",n,!1)})["catch"](function(){window.removeEventListener("message",n,!1)}),i},w=function(t){function n(r){return b(t)["catch"](function(a){return i>r?(o.errorhandler.onWarning(new e.Warning("Akamai authentication redirect failed as warning on "+(r+1)+" try. (error:"+a+")","warning-90")),o.view.loadBduLoginIframeHidden(t),n(++r)):Promise.reject(a)})}var i=3;return n(0)},_=function(){try{if(null===d.status)return null;if(void 0!==d.status)return d.status;var t=o.storage.get("authn");return null!==t?(o.log("authn","isAuthn returns "+t+" after reading from storage"),t):(t=o.storage.getSession("authn"),null!==t?(o.log("authn","isAuthn returns "+t+" after reading from session"),t):(o.storage.reset(),o.log("authn","isAuthn returns null as storage return null"),null))}catch(n){return o.errorhandler.onWarning(new e.Warning("authN._isAuthenticatedLocal(), returns null due to an exception. (error: "+n+")","WBAA03")),null}},k=function(){var t=new Promise(function(t,i){var a=setTimeout(function(){i(new e.Error("Akamai identity request timeout (duration: "+o.constants.timer.identityTimeoutTreshold+")","EBAD02"))},o.constants.timer.identityTimeoutTreshold);h.start(),n.assignhandler("identity",function(n,r){try{if(clearTimeout(a),h.stop(),h.isIdentityWarningTreshold()&&o.errorhandler.onWarning(new e.Warning("Akamai identity request duration took "+h.duration+" ms","WBAD02",{
duration:h.duration})),o.log("authn","identity recieved in "+h.duration+" ms",r),f=r,T(f.identity.attributes.postal_code))t(r);else{var s=new e.Error("Akamai identity token has an invalid postal code (postalCode: "+f.identity.attributes.postal_code+")","EBAC04");i(s)}}catch(s){i(e.Error.fromError(s))}}),r=function(e,n){o.log("authn","identity resolved with null as Akamai logout_result event was listened"),clearTimeout(e),h.stop(),t(null)},o.event.addListener("logout_result",r),n.identity()});return t.then(function(){o.event.removeListener("logout_result",r)},function(){o.event.removeListener("logout_result",r)}),t},A=function(){function t(i){return k()["catch"](function(r){return n>i&&"EBAC04"!==r.code?(o.errorhandler.onWarning(new e.Warning("Akamai identity request failed as warning on "+(i+1)+" try. (error:"+r+")","WBAE02")),t(++i)):Promise.reject(r)})}var n=3;return t(0)},T=function(e){if(null===e)return!1;var t=new RegExp("^[ABCEGHJKLMNPRSTVXY]{1}\\d{1}[A-Z]{1}$","i");return e=e.trim().substring(0,3),t.test(e)?!0:!1},x=function(t){var i=new Promise(function(i,r){var s=setTimeout(function(){r(new e.Error("Akamai register device request timeout (duration: "+o.constants.timer.registerTimeoutTreshold+")","EBAD07"),t)},o.constants.timer.registerTimeoutTreshold);u=!0,h.start(),n.assignhandler("device",function(n,a){try{clearTimeout(s),h.stop(),h.isRegisterWarningTreshold()&&o.errorhandler.onWarning(new e.Warning("Akamai register device request duration took "+h.duration+" ms","WBAD06",{duration:h.duration})),o.log("authn","register device recieved in "+h.duration+" ms",a),i({type:"activated",response:a})}catch(c){r(e.Error.fromError(c),t)}}),a=function(e){o.log("authn","register device fullfiled with incorrectCode as Akamai logout_result event was listened"),clearTimeout(s),h.stop(),i({type:"incorrectCode",response:e})},o.event.addListener("logout_result",a),n.registerDevice(t)}),r=function(){o.event.removeListener("logout_result",a),u=!1};return i.then(r,r),i},S=function(t){function n(r){return x(t)["catch"](function(t){return i>r?(o.errorhandler.onWarning(new e.Warning("Akamai register device request failed as warning on "+(r+1)+" try. (error:"+t+")","WBAE07")),n(++r)):Promise.reject(t)})}var i=3;return n(0)},B=function(){var t=new Promise(function(t,i){function r(n,r){try{if(clearTimeout(a),h.stop(),h.isInitWarningTreshold()&&o.errorhandler.onWarning(new e.Warning("Akamai init request duration took "+h.duration+" ms","WBAD05",{duration:h.duration})),o.log("authn","init recieved in "+h.duration+" ms",r),r.authenticated===!0){for(var s in r.idps)if(r.idps.hasOwnProperty(s)){d.signInBduName=r.idps[s].name,o.storage.set("signInBduName",d.signInBduName),o.tracking.onBduSelected(d.signInBduName),o.log("authn","getting bduname:"+d.signInBduName+" after cross site authentciation");break}C(r)}t(r.authenticated)}catch(c){i(e.Error.fromError(c))}}o.log("authn","requesting akamai init");var a=setTimeout(function(){i(new e.Error("Akamai init request timeout (duration: "+o.constants.timer.initTimeoutTreshold+")","EBAD06"))},o.constants.timer.initTimeoutTreshold);h.start(),n.assignhandler("init",r),n.assignhandler("chooser",r),n.init()});return t},E=function(){function t(i){return B()["catch"](function(r){return n>i?(o.errorhandler.onWarning(new e.Warning("Akamai init request failed as warning on "+(i+1)+" try. (error:"+r+")","WBAE06")),t(++i)):Promise.reject(r)})}var n=3;return t(0)},C=function(e){d.ttl=e.expires-e.servertime,o.log("authn","authn TTL is set",d.ttl),d.ttl-=Math.floor(5*d.ttl/100)};return{init:function(){i=this,d.status=_(),o.log("authn","at init isAuthenticated:",d.status),c=0},resetJsCache:function(){u=!1,l=!1,d={status:!1,signInBduName:null,signInBduLogoSrc:null,signInBdu:null,ttl:null},f=null},handleAkamaiLogoutResult:function(){n.assignhandler("logout_result",function(e,t){u===!1&&i.forceSignOutLocal(),o.event.trigger("logout_result",t)})},getIdentity:function(){return null!==f?Promise.resolve(f):A()},forceSignOut:function(){o.log("authn","user is forced signed out"),o.event.trigger("onSignOutForced"),n.logout(),this.changeAuthnStatus(!1)},forceSignOutLocal:function(){(null!==d.status||d.status===!0)&&(o.log("authn","user is force signed out (local)"),o.event.trigger("onSignOutForced"),this.changeAuthnStatus(!1))},signOut:function(){o.log("authn","user signed out"),n.logout(),this.changeAuthnStatus(!1)},isAuthenticatedLocal:function(){return _()},isAuthenticatedGlobal:function(){return E()},changeAuthnStatus:function(e){o.vars.differed.isAuthenticated=null,o.log("authn","user authentication status changed from "+d.status+" to "+e),null!==d.status&&d.status!==e?(d.status=e,o.tracking.onAuthnChanged(e)):d.status=e,e===!0?o.storage.set("authn",!0):(o.storage.reset(),o.storage.setSession("authn",!1),l=!1,o.resetJsCache())},handleBduClick:function(){return new Promise(function(e,t){o.event.addListenerToDom("click",".bmauth-signin-logo",function(n){y(this,n).then(e)["catch"](t)}),o.event.addListenerToDom("click",".auth9_btnBMG",function(n){y(this,n).then(e)["catch"](t)})})},getSignInBduName:function(){try{return null!==d.signInBduName?d.signInBduName:(d.signInBduName=o.storage.get("signInBduName"),null===d.signInBduName&&o.errorhandler.onWarning(new e.Warning("Sign-in Bdu name was null when it was requested","WBAA04")),d.signInBduName)}catch(t){return o.errorhandler.onError(t),null}},getSignInSelectedLogo:function(){return d.signInBduLogoSrc&&null!==d.signInBduLogoSrc||o.errorhandler.onWarning(new e.Warning("Could not retrieve the user sign-in Selected BDU logo (bduName: "+d.signInBduName+")","WBAA05")),d.signInBduLogoSrc},updateAuthnTTL:function(){o.log("authn","updating authentication TTL");var e=o.storage.get("authn");o.storage.set("authn",e)},getSignInBdu:function(){try{return null!==d.signInBdu?d.signInBdu:(d.signInBdu=o.storage.get("signInBdu"),d.signInBdu)}catch(e){return o.errorhandler.onError(e),null}},setSignInBdu:function(t){try{null===t&&o.errorhandler.onWarning(new e.Warning("Setting sign in bdu in storage failed as the passed argument bdu was null","WBAZ00")),d.signInBdu=t,o.storage.set("signInBdu",t)}catch(n){o.errorhandler.onError(n)}},getAuthnTTL:function(){try{return null!==d.ttl?d.ttl:o.constants.cache.authn}catch(e){o.errorhandler.onError(e)}},registerDevice:function(e){return S(e)}}}})}(BmAuth,jQuery,ais_client),function(e,t,n){"use strict";var o=function(e){this.STORAGE_NAME="authz_",this.api=e,this._authorizedResources=[],this._authZtokens=[],this._authorizedResources=this.api.storage.get("authorizedResourceIDs"),null===this._authorizedResources&&(this._authorizedResources=[])};o.prototype.isAuthZWarningTreshold=function(e){return e>this.api.constants.timer.authZWarningTreshold?!0:!1},o.prototype._getAuthzRequestUrn=function(e){return this.api.constants.url.aisBase+this.api.config.brandUrn+"/identity/resourceAccess/"+e+"?format=jsonp&responsefield=authz"+e},o.prototype._handleAuthZQueryJob=function(n){var o=this;return new Promise(function(i,r){var a=o.api.storage.get(o.STORAGE_NAME+n);if(null!==a)o.api.log("authz","got authz token from the cache",a),i(a);else{var s={contentType:"application/json",url:o._getAuthzRequestUrn(n),timeout:o.api.constants.timer.authZTimeoutTreshold,dataType:"jsonp",jsonpCallback:"authz"+n,crossDomain:!0,cache:!0},c=new o.api.Timer,u=function(t){try{switch(c.stop(),o.isAuthZWarningTreshold(c.duration)&&o.api.errorhandler.onWarning(new e.Warning("Akamai authz request for "+n+" duration took "+c.duration+" ms.","WBAD04",{duration:c.duration})),o.api.log("authz","response recieved in "+c.duration+" ms",t),t._type){case"authz_query":o.api.storage.set(o.STORAGE_NAME+n,t,o.api.constants.cache.authz),i(t);break;case"logout_result":o.api.log("authz","authz resolved with null as Akamai logout_result event was listened"),o.api.forceSignOutLocal(),i(null);break;default:throw new e.Error("The "+t._type+" is anunexpeced response type for authz request","EBAE02")}}catch(a){r(e.Error.fromError(a))}};c.start(),t.ajax(s).done(u).fail(function(t,n){c.stop(),r(new e.Error("Akamai authz request timeout. "+JSON.stringify(t)+" "+n,"EBAD04"))})}})},o.prototype._handleAuthZQuery=function(t){var n=3,o=this,i=function r(i){return o._handleAuthZQueryJob(t).then(function(e){if(null!==e){-1===o._authZtokens.indexOf(e)&&o._authZtokens.push(e);var t;return e.authorization===!0?(-1===o._authorizedResources.indexOf(e.resource)&&o._authorizedResources.push(e.resource),o.api.log("authz","authorized resource",o._authorizedResources),t={authZ:!0,authZ_resources:{}},t.authZ_resources[e.resource]=!0,t.authz_tokens={},t.authz_tokens[e.resource]=e):(t={authZ:!1,authZ_resources:{}},t.authZ_resources[e.resource]=!1,e.message&&(t.message=e.message)),Promise.resolve(t)}return Promise.resolve(null)})["catch"](function(t){return n>i?(o.api.errorhandler.onWarning(new e.Warning("Akamai authz request for failed as warning on "+(i+1)+" try. (error:"+JSON.stringify(t)+")","WBAE04")),r(++i)):Promise.reject(t)})};return i(0)},o.prototype._handleAuthZQueryListSeperate=function(e){var n=[],o=this;return e.forEach(function(e){n.push(o._handleAuthZQuery(e))}),Promise.all(n).then(function(n){o.api.log("authz","all resouces have been received");var i=0,r=e.length,a=0,s={authZ:void 0,authZ_resources:{},authz_tokens:{}};for(i;r>i;i++)t.extend(s.authZ_resources,n[i].authZ_resources),t.extend(s.authz_tokens,n[i].authz_tokens),n[i].authZ===!0&&a++;return s.authZ=0===a?!1:!0,Promise.resolve(s)})["catch"](function(e){return Promise.reject(e)})},o.prototype._authzResources=function(t){return t instanceof Array?t.length>1?this._handleAuthZQueryListSeperate(t):1===t.length?this._handleAuthZQuery(t[0]):Promise.reject(new e.Error("Brand Resource_Ids count was not greater or equall to 1.","EBAC05")):Promise.reject(new e.Error("Brand Resource_Ids must be instanceof Array","EBAC05"))},o.prototype.resetJsCache=function(){this._authorizedResources=[],this._authZtokens=[]},o.prototype.authorizeResources=function(e){var t=this._authzResources(e),n=this;return t.then(function(e){n.api.storage.set("authorizedResourceIDs",n._authorizedResources)}),t},o.prototype.isResourceIdInAuthorizedList=function(e){var t=-1===this._authorizedResources.indexOf(e.Authentication.Resources[0].ResourceCode);return this.api.log("video","return "+t+" after checking if the resource ID is authz (video.id: "+e.Id+")"),t},o.prototype.getAuthzTokens=function(){return this._authZtokens},o.prototype.getAuthzWithLogo=function(){},e.newDefine({name:"Authz",type:"module",value:o})}(BmAuth,jQuery,ais_client),function(e,t){"use strict";e.define({type:"module",name:"TpCookie",value:function(n){var o=null,i={_startTime:null,_endTime:null,duration:null,timeOutTimer:null,start:function(){this._startTime=null,this._endTime=null,this.duration=null,this._startTime=Date.now()},stop:function(){this._endTime=Date.now(),this.duration=this._endTime-this._startTime},reset:function(){this._startTime=null,this._endTime=null,this.duration=null}},r={iframe:{source:n.constants.url.tpCookieChecker,id:"tp-cookie-check"},isSupported:null},a=function(){var e=t("<iframe />"),o=r.iframe.source+"?gl=1&"+(new Date).getTime();e.attr("src",o).hide(),e.attr("id",r.iframe.id),n.view.insert("body",e),n.log("tpcookie","planted the 3rd party cookie check iframe")},s=function(){n.view.remove("#"+r.iframe.id),n.log("tpcookie","removed the 3rd party cookie check iframe")},c=function(e){return-1!==n.constants.accepted.messageOrigin.tpCookie.indexOf(e.origin)?!0:!1},u=function(){return null!==r.isSupported?!0:!1},l=function(){var t,u=function(){window.removeEventListener("message",t,!1),o=!0,s()},l=new Promise(function(s,u){i.timeOutTimer=setTimeout(function(){u(new e.Error("3rd party cookie check timeout (duration: "+n.constants.timer.thirdPartyCookieTimeout+")","EBAD05"))},n.constants.timer.thirdPartyCookieTimeout),i.start(),t=function(t){if(c(t))try{var a=JSON.parse(t.data);if("BmAuthTPC"!==a.messageSender||o===!0)return;clearTimeout(i.timeOutTimer),i.stop(),n.log("tpcookie","message recived in "+i.duration+"ms",a),null!==a.data.isSupported&&(a.data.isSupported===!0?r.isSupported=!0:(r.isSupported=!1,null!==a.data.read&&n.errorhandler.onWarning(new e.Warning("Despite 3rd party cookie being read its value was not equal to what was planted","WBAA06")))),n.log("tpcookie","3rd party cookie check is resolved (isSupported: "+r.isSupported+")"),s(r.isSupported)}catch(l){u(e.Error.fromError(l))}},window.addEventListener("message",t,!1),a()});return l.then(u,u),l},d=function(){function t(i){return l()["catch"](function(r){return o>i?(n.errorhandler.onWarning(new e.Warning("toCookie request failed as warning on "+(i+1)+" try (error:"+r+")","WBAE05")),t(++i)):Promise.resolve(!1)})}var o=2;return t(0)};return{checkTpCookieEnabled:function(){try{return"ios"===n.config.platform?(r.isSupported=!0,n.log("tpcookie","3rd party cookie check is resolved ([ios forced true]isSupported: "+r.isSupported+")"),Promise.resolve(!0)):u()?(n.log("tpcookie","3rd party cookie check is resolved ([cached]isSupported: "+r.isSupported+")"),Promise.resolve(r.isSupported)):d()}catch(t){return Promise.reject(e.Error.fromError(t))}}}}})}(BmAuth,jQuery),function(e,t,n){"use strict";e.define({type:"controller",name:"main",value:function(t,o){var i,r,a,s,c=null,u=null,l=function(){n.setLogging(!1),n.setPlatformId(t.config.brandUrn),n.setCacheTime("identity",t.constants.cache.identity),n.setCacheTime("authz_query",t.constants.cache.authz),n.setCacheTime("authz_query_list",t.constants.cache.authz),n.setCacheTime("bounce",0),n.setCacheTime("init",0)},d=function(e,n,o){for(var i=JSON.parse(JSON.stringify(e)),r=0,a=i.length;a>r;r++)i[r].inChooser!==!1?(i[r].logos&&i[r].logos[o]&&(i[r].logo=n+i[r].logos[o]),"BellMG"!==i[r].name||(t.vars.bellmediaLogo=i[r].logo,i.splice(r,1),a--,r--)):(i.splice(r,1),a--,r--);return i},h=function(){var n,o;return o=r.getSignInBdu(),null===o&&(n=r.getSignInBduName(),null!==n&&(o=i.getBduFromName(n)),null!==o?(o.logo||(o.logo=t.constants.url.assets+o.logos.md),o.logos&&delete o.logos,delete o.id,r.setSignInBdu(o)):t.errorhandler.onWarning(new e.Warning("Could not find the signin bdu from the signin bduname ("+n+")","WBAC03"))),t.log("authn","selected bdu",o),o},f=function(e){return t.config.options.extraData&&-1!==t.config.options.extraData.indexOf(e)?!0:!1},g=function(e,n){var o={authorized:[],notAuthorized:[]},i=JSON.parse(JSON.stringify(e));for(var r in i)i[r].authorized=n[r],i[r].logo1=t.constants.url.assetsRoot+i[r].logo1,i[r].logo2=t.constants.url.assetsRoot+i[r].logo2,n[r]===!0?o.authorized.push(i[r]):o.notAuthorized.push(i[r]);return o},m=function(n){return new Promise(function(o,s){var c,u,l=a.authorizeResources(i.resourceIds()),d=r.getIdentity();Promise.all([l,d]).then(function(s){var l=s[0],d=s[1];if(null===l||null===d)throw new e.Error("After successful  authn step, identity or authz request returned a logout_result response","EBAE07");c={authenticated:l.authZ,passedAuthNStep:!0,passedAuthZStep:l.authZ,authZ_resources:l.authZ_resources,identity_token:d},u=h(),r.changeAuthnStatus(c.authenticated),c.authenticated===!0?(c.type="fullfiled_authenticated",f("bdu")&&(null!==u?(c.signInBdu=JSON.parse(JSON.stringify(u)),delete c.signInBdu.id,delete c.signInBdu.inChooser,delete c.signInBdu.customAuthzMessage):c.signInBdu=null),f("authz")&&(c.authzTokens=a.getAuthzTokens()),n===!1&&(t.config.isMultiAuthzFlow===!1?t.view.displaySuccessMessage(r.getSignInSelectedLogo()):t.view.displaySuccessMessageMultiAuthz(r.getSignInSelectedLogo(),g(i.getAuthZResources(),l.authZ_resources))),t.modal.close(t.config.isMultiAuthzFlow===!1?t.constants.timer.closeModalOnSuccess:t.constants.timer.closeModalOnSuccessMulti)):(c.type="fullfiled_authZNo",n===!1?r.forceSignOut():r.forceSignOutLocal(),n===!1&&(t.config.isMultiAuthzFlow===!1?null!==u&&u.customAuthzMessage===!0&&l.message?t.view.displayACustomuthZNoMessage(l.message):t.view.displayAuthZNoMessage(t.config.brand):t.view.displayAuthZNoMessageMultiAuthz(r.getSignInSelectedLogo(),g(i.getAuthZResources(),l.authZ_resources)))),o(n===!1?c:c.authenticated)})["catch"](s)})},p=function(e){return new Promise(function(n,o){var s,c=a.authorizeResources(e),u=r.getIdentity();Promise.all([c,u]).then(function(o){var r=o[0],a=o[1];null===r||null===a?n("logout_result"):(r.authZ===!0?(s={authorized:!0,authZ_token:r.authz_tokens[e[0]],identity_token:a},t.log("canPlayVideo","video authorized after authz check")):(s={authorized:!1,authZ_token:null,identity_token:null},t.modal.display().then(function(){t.view.displayAuthZNoMessage(i.getResourceName(e[0]))}),t.log("canPlayVideo","video not authorized after authz check")),n(s))})["catch"](o)})},v=function(t){if("object"!=typeof t)throw new e.Error("Video must be of type Object (video: "+t+")","EBAB03");if(!t.Authentication)throw new e.Error("Video.Authentication was missing form the video object (video.Id: "+t.Id+")","EBAC01");if("boolean"!=typeof t.Authentication.Required)throw new e.Error("Video.Authentication.Required was missing form the video object (video.Id: "+t.Id+")","EBAC02");if(t.Authentication.Required===!0&&0===t.Authentication.Resources.length)throw new e.Error("Video did not have Resource IDs while had authentication required (video.Id: "+t.Id+")","EBAC03")},y=function(e){return v(e),e.Authentication.Required===!1?(t.log("videoLock","return false as the video did not need authenticated check (video.id: "+e.Id+")"),!1):r.isAuthenticatedLocal()?a.isResourceIdInAuthorizedList(e):(t.log("videoLock","return true as user was not authenticated (video.id: "+e.Id+")"),!0)},b=function(e){switch(e.type){case"fullfiled_authenticated":e.cmd=null;break;case"fullfiled_authZNo":e.cmd=null;break;case"userClose":e.cmd="close";break;default:e.cmd=null}t.event.broadcastForApp(e)},w=function(e){if("EBAB05"!==e.code){var n={};n.cmd=null,n.type="error",n.error={code:e.code,message:e.message},t.log("webview","error occured",n,"warning"),t.event.broadcastForApp(n)}},_=function(e){if(e){var n=t.storage.getSession("onAlreadyAuthenticated");null===n&&(t.tracking.onAlreadyAuthenticated(),t.storage.setSession("onAlreadyAuthenticated",!0))}},k=function(e,n){var o=null;switch(t.config.platform){case"web":o=e.desktop;break;case"ios":o=n===!0?e.iosTablet:e.iosPhone;break;case"android":o=n===!0?e.androidTablet:e.androidPhone;break;case"xbox360":o=e.xbox360;break;case"xboxone":o=e.xboxOne;break;case"samsungtv":o=e.samsungTV;break;case"windows8":o=e.windows8;break;case"roku":o=e.roku;break;case"appletv":o=e.appleTV;break;default:o=e.desktop}return o},A=function(){return t.log("authn","authentication status is requested"),null===t.vars.differed.isAuthenticated&&(t.vars.differed.isAuthenticated="in_process",c=new Promise(function(e,n){t.ready.then(function(){var o=r.isAuthenticatedLocal();null!==o?e(o):r.isAuthenticatedGlobal().then(function(n){n===!0?(t.log("authn","isAuthenticated returns true after checking it with Akamai"),m(!0).then(e)["catch"](function(e){t.errorhandler.onError(e),r.forceSignOutLocal()})):(r.changeAuthnStatus(!1),t.log("authn","isAuthenticated returns false after checking it with Akamai"),e(!1))})["catch"](n)})["catch"](n)})),c["catch"](function(e){t.errorhandler.onError(e)}),c},T=function(){var n=new Promise(function(n,o){t.ready.then(function(){if(r.isAuthenticatedLocal()){t.errorhandler.onWarning(new e.Warning("BmAuth.handleSignIn() was called when the user was already authenticated","WBAB06")),t.tracking.onAuthnChanged(r.isAuthenticatedLocal());var a={authenticated:!0,passedAuthNStep:!0,passedAuthZStep:!0,authZ_resources:null,identity_token:null,type:"fullfiled_authenticated"};n(a)}else t.modal.display().then(function(){t.tracking.onSignInAttempt(),t.event.addListener("onModalClose",function(){var e={authenticated:!1,passedAuthNStep:!1,passedAuthZStep:!1,authZ_resources:{},identity_token:null,type:"userClose"};n(e)}),s.checkTpCookieEnabled().then(function(t){t===!1&&o(new e.Error("3rd Party cookie was disabled for the user","EBAF01"))});var a=i.brandBduList(),c=t.constants.url.assets;a=d(a,c,"md"),t.view.displayBduChooser(a),r.handleBduClick().then(function(){m(!1).then(n)["catch"](o)})["catch"](o)})["catch"](o)})["catch"](o)});if(t.config.options.fromWebview===!0&&t.event.addListener("onModalClose",function(){var e={cmd:"close",type:"userClose"};t.event.broadcastForApp(e)}),n.then(function(e){t.config.options.fromWebview===!0&&b(e)})["catch"](function(e){t.errorhandler.onError(e),r.forceSignOut(),t.config.options.fromWebview===!0&&w(e)}),t.config.options.fulfillOnClose===!1)return n;var o=new Promise(function(e,n){t.event.addListener("onModalClose",function(){e()})});return new Promise(function(e,t){Promise.all([n,o]).then(function(t){e(t[0])})["catch"](t)})};return{init:function(){var e=new Promise(function(e,n){t.storage.init(),t.event.init(),t.view.init(),i=t.createModule("authadmin"),r=t.createModule("authn"),a=new o.Authz(t),s=t.createModule("tpcookie"),t.config.options.fromWebview===!0&&(t.storage.reset(),t.resetJsCache()),i.getConfig().then(function(){l(),r.handleAkamaiLogoutResult(),t.log("main","BmAuth initiated and ready"),e()})["catch"](n)});return Promise.all([e,t.domReady]).then(function(){t.event.triggerInternal("onReady"),A().then(_)})["catch"](function(e){t.event.triggerInternal("onReadyFailed",e)})},handleSignIn:function(){return null===t.vars.differed.handleSignIn&&(t.vars.differed.handleSignIn="in_process",u=T()),u.then(function(e){t.vars.differed.handleSignIn=null,t.log("signin","fulfilled with",e)}),u},isAuthenticated:function(){return A()},handleSignOut:function(){return new Promise(function(e,n){t.ready.then(function(){r.signOut(),e()})["catch"](function(e){t.errorhandler.onError(e),n(e)})})},handleLocalSignOut:function(){return new Promise(function(e,n){t.ready.then(function(){r.forceSignOutLocal(),e()})["catch"](function(e){t.errorhandler.onError(e),n(e)})})},canPlayVideo:function(e){var n=this,o=new Promise(function(o,i){t.ready.then(function(){v(e),t.log("canPlayVideo:","info",e),e.Authentication.Required===!1?(t.log("canPlayVideo","video authorized wuthout authentication check"),o({authorized:!0,identity_token:null,authZ_token:null})):r.isAuthenticatedLocal()?p([e.Authentication.Resources[0].ResourceCode]).then(function(t){"logout_result"===t?n.handleSignIn().then(function(t){"fullfiled_authenticated"===t.type?p([e.Authentication.Resources[0].ResourceCode]).then(o)["catch"](i):o({authorized:!1,identity_token:null,authZ_token:null})})["catch"](i):o(t)})["catch"](i):n.handleSignIn().then(function(t){"fullfiled_authenticated"===t.type?p([e.Authentication.Resources[0].ResourceCode]).then(o)["catch"](i):o({authorized:!1,identity_token:null,authZ_token:null})})["catch"](i)})["catch"](i)});return o["catch"](function(e){t.errorhandler.onError(e,!0)}),t.config.options.fulfillOnClose===!1?(o.then(function(e){t.log("canPlayVideo","fulfilled with",e)}),o):new Promise(function(e,n){o.then(function(n){n.authorized===!1?t.event.addListener("onModalClose",function(){t.log("canPlayVideo","fulfilled with",n),e(n)}):(t.log("canPlayVideo","fulfilled with",n),e(n))})})},videoHasLock:function(e){try{return y(e)}catch(n){return t.log("videoLock: return true as an exception has occured (video.id: "+e.Id+")"),t.errorhandler.onException(n),!0}},videosAddLockStatus:function(n){var o=new Promise(function(o,i){t.ready.then(function(){if(t.log("videoLock","passed videos",n),!Array.isArray(n))throw new e.Error("The argument videos must be of type Array - (videos: "+n+")","EBAB04");for(var i=0,r=n.length;r>i;i++)try{n[i].Authentication.hasLock=y(n[i])}catch(a){"EBAC01"===a.code?(n[i].Authentication={},n[i].Authentication.hasLock=!0):"EBAC02"===a.code||"EBAC03"===a.code?n[i].Authentication.hasLock=!0:(n.splice(i,1),i--,r--),t.errorhandler.onError(a,!1)}o(n)})["catch"](i)});return o["catch"](t.errorhandler.onError),o},getSignInBduName:function(){var e=r.getSignInBduName();return t.log("authn","returning signInBduName (name: "+e+")"),e},getTrackingSuites:function(n){var o=new Promise(function(o,r){t.ready.then(function(){var r=i.getBrandTrackingSuites(),a=k(r,n);null===a&&t.errorhandler.onWarning(new e.Warning("Tracking suite for platform "+t.config.platform+" could not be found in auth admin config","WBAC01")),null===r.globalSuite&&t.errorhandler.onWarning(new e.Warning("Global tracking suite could not be found in auth admin config","WBAC02"));var s={globalSuite:r.globalSuite,brandPlatformSuite:a};o(s)})["catch"](r)});return o},getIdentity:function(){var e=new Promise(function(e,n){t.ready.then(function(){r.isAuthenticatedLocal()?r.getIdentity().then(e)["catch"](n):e(null)})["catch"](n)});return e["catch"](t.errorhandler.onException),e},displayMessage:function(e){t.modal.display().then(function(){t.view.displayMessage(e)})},registerDevice:function(e){t.log("activate","registerDecide called in contoller");var n=this,o=new Promise(function(o,i){t.ready.then(function(){r.isAuthenticatedLocal()?r.registerDevice(e).then(o)["catch"](i):n.handleSignIn().then(function(t){"userClose"===t.type?o({type:t.type}):t.authenticated===!0?r.registerDevice(e).then(o)["catch"](i):o({type:"notAuthenticated"})})["catch"](i)})});return o["catch"](t.errorhandler.onError),o},isAuthenticatedLocal:function(){return r.isAuthenticatedLocal()},closeModal:function(e){t.modal.close(e)},forceSignOutLocal:function(){r.forceSignOutLocal()},resetJsCache:function(){r.resetJsCache(),a.resetJsCache()}}}})}(BmAuth,jQuery,ais_client),function(e,t){"use strict";window[e].define({type:"template",name:"bdu-chooser",value:function(){return['<div class="axis-auth-header">','<a  class="axis-auth-info remodal-info"></a>','<a  class="axis-auth-close remodal-close"></a>',"<h1>{{header}}</h1>","</div>",'<div class="axis-auth-main">','<div class="axis-auth-message-container">',"<p>{{subHeader}}","</p>","</div>",'<div class="axis-auth-middle">','<div class="axis-auth-logos-container">',"{{#logos}}",'<div data-name="{{name}}" data-urn={{urn}} class="axis-auth-provider-logo bmauth-signin-logo">',"{{#logo}}",'<img src="{{logo}}" alt="{{displayName}}">',"{{/logo}}","{{^logo}}","<span>{{displayName}}</span>","{{/logo}}","</div>","{{/logos}}","</div>","</div>",'<div class="axis-auth-search-container"> ','<p><a data-name="BellMG" data-img="{{bellmediaLogo}}" data-urn="urn:bellmedia:com:idp:custom:prod" class="auth9_btnBMG">{{guestUsers}}</a>',"<br>",'<span class="auth9_txt3">',"{{providerNotListed}}","</span>","</p>","</div>","</div>"].join("")}})}("BmAuth",jQuery),function(e,t){"use strict";window[e].define({type:"template",name:"modal-base",value:function(){return['<div class="remodal-bg axis-modal-bg">','<div id="axis-auth" class="remodal bmauth-remodal {{brand}}" data-remodal-id="axisauth">','<div class="axis-auth-container axis-modal">',"</div>","</div>","</div>"].join("")}})}("BmAuth",jQuery),function(e){"use strict";window[e].define({type:"template",name:"error-text-only",value:function(){return['<div class="axis-auth-header">','<a class="axis-auth-info remodal-info"></a>',"{{#showBackButton}}",'<a class="axis-auth-back remodal-back"></a>',"{{/showBackButton}}",'<a class="axis-auth-close remodal-close"></a>',"<h1>{{header}}</h1>","</div>",'<div class="axis-auth-main no-footer">','<div class="axis-auth-middle">','<div class="axis-auth-error-container">','<div class="axis-auth-message-header">','<div class="axis-auth-disclaimer"></div>',"</div>",'<div class="axis-auth-message-body">',"{{#paragraphs}}","<p>{{.}}</p>","{{/paragraphs}}","</div>",'<div class="axis-auth-message-footer">','<button class="axis-auth-action-bottom axis-auth-ok-bottom close-button">{{closeLinkText}}</button>',"</div>","</div>","</div>","</div>"].join("")}})}("BmAuth"),function(e,t){"use strict";window[e].define({type:"template",name:"bdu-login",value:function(){return['<div class="axis-auth-header">','<a class="axis-auth-info remodal-info"></a>','<a class="axis-auth-back remodal-back"></a>','<a class="axis-auth-close remodal-close"></a>',"<h1>{{header}}</h1>","</div>",'<div class="axis-auth-main no-footer no-side-padding">','<div class="axis-auth-middle axis-auth-middle axis-auth-scroll-container">  ','<iframe src="{{source}}" name="ifrBmAuthApi" id="ifrBmAuthApi" scrolling="auto" frameborder="0"></iframe>',"</div>","</div>"].join("")}})}("BmAuth",jQuery),function(e,t){"use strict";window[e].define({type:"template",name:"bdu-login-hidden",value:function(){return['<div class="axis-auth-main no-footer no-side-padding" style="display: none;">','<div class="axis-auth-middle axis-auth-middle axis-auth-scroll-container">  ','<iframe src="{{source}}" name="ifrBmAuthApi" id="ifrBmAuthApi" scrolling="auto" frameborder="0"></iframe>',"</div>","</div>"].join("")}})}("BmAuth",jQuery),function(e,t){"use strict";window[e].define({type:"template",name:"success-message",value:function(){return['<div class="axis-auth-header">','<a class="axis-auth-info remodal-info"></a>','<a class="axis-auth-close remodal-close"></a>',"<h1>{{header}}</h1>","</div>",'<div class="axis-auth-main two-row"> ','<div class="axis-auth-middle">','<div class="axis-success-container">','<span class="axis-success-message">{{text}}</span> ','<div class="axis-auth-provider-logo">','<img src="{{logoSource}}">',"</div>","</div>","</div> ",'<div class="axis-auth-ad-placer">',"</div>","</div>"].join("")}})}("BmAuth",jQuery),function(e,t){"use strict";window[e].define({type:"template",name:"faq",value:function(){return['<div class="axis-auth-header">','<a class="axis-auth-back remodal-back"></a>','<a class="axis-auth-close remodal-close"></a>','<h1 lang="en" style="display:block;">{{header}}</h1>',"</div>",'<div class="axis-auth-main no-footer">','<div class="axis-auth-middle">','<div class="axis-faq-container">','<h2 lang="en" style="display:block;">{{subTitle}}</h2>','<div class="bmauth-faqs">',"{{#faqs}}",'<div class="bmauth-faq">','<div class="bmuth-faq-item-l">','<span class="bmauth-faq-chevron"></span>',"</div>",'<div class="bmuth-faq-item-r">','<span class="bmauth-question">{{question}}</span>','<div class="bmauth-answer" >{{{answer}}}</div>',"</div>","</div>","{{/faqs}}","</div>","</div>","</div>","</div>"].join("")}})}("BmAuth",jQuery),function(e){"use strict";window[e].define({type:"template",name:"success-message-all",value:function(){return['<div class="axis-auth-header">','<a class="axis-auth-info remodal-info"></a>','<a class="axis-auth-close remodal-close"></a>',"<h1>{{header}}</h1>","</div>",'<div class="axis-auth-main two-row {{topShort}}"> ','<div class="axis-auth-middle multi-authz ">','<div class="axis-success-container  {{numYes}}">','<span class="axis-success-message">{{text}}</span> ','<div class="axis-auth-provider-logo">','<img src="{{logoSource}}">',"</div>","<div>",'<span class="axis-success-message bmauth-accessto-message">{{accessToText}}</span> ','<div class="bmauth-accessto-channels">',"{{#authorizedResources}}",'<div class="bmauth-authzyes-logo">','<img src="{{logo1}}">',"</img>","</div>","{{/authorizedResources}}","</div>","</div>","</div>","</div> ",'<div class="axis-auth-ad-placer multi-authz">',"{{#hasNoAuthz}}",'<span class="axis-success-message bmauth-noaccessto-message">{{noAccessToText}}</span> ','<div class="bmauth-noaccessto-channels {{numNo}}">',"{{#notAuthorizedResources}}",'<div class="bmauth-authzyes-logo">','<img src="{{logo2}}">',"</img>","</div>","{{/notAuthorizedResources}}","</div>",'<span class="axis-success-message bmauth-contacttv-message">{{contactTV}}</span> ',"{{/hasNoAuthz}}","</div>","</div>"].join("")}})}("BmAuth"),function(e){"use strict";window[e].define({type:"template",name:"authzno-message-multi",value:function(){return['<div class="axis-auth-header">','<a class="axis-auth-info remodal-info"></a>',"{{#showBackButton}}",'<a class="axis-auth-back remodal-back"></a>',"{{/showBackButton}}",'<a class="axis-auth-close remodal-close"></a>',"<h1>Sign in to Watch</h1>","</div>",'<div class="axis-auth-main no-footer {{brand}}">','<div class="axis-auth-middle">','<div class="axis-auth-error-container multi-authz">','<div class="axis-auth-message-body logo5">','<span class="axis-success-message bmauth-authzno-top">{{topText}}</span> ','<div class="bmauth-noaccessto-channels">',"{{#notAuthorizedResources}}",'<div class="bmauth-authzyes-logo">','<img src="{{logo2}}">',"</img>","</div>","{{/notAuthorizedResources}}","</div>",'<span class="axis-success-message bmauth-authzno-bottom">{{bottomText}}</span> ',"</div>",'<div class="axis-auth-message-footer">','<button class="axis-auth-action-bottom axis-auth-ok-bottom close-button">{{buttonText}}</button>',"</div>","</div>","</div>","</div>"].join("");

}})}("BmAuth"),function(e){"use strict";window[e].define({type:"template",name:"error-tpcookie",value:function(){return['<div class="axis-auth-header">','<a class="axis-auth-info remodal-info"></a>',"{{#showBackButton}}",'<a class="axis-auth-back remodal-back"></a>',"{{/showBackButton}}",'<a class="axis-auth-close remodal-close"></a>',"<h1>{{header}}</h1>","</div>",'<div class="axis-auth-main no-footer">','<div class="axis-auth-middle">','<div class="axis-auth-error-container">','<div class="axis-auth-message-header">','<div class="axis-auth-disclaimer"></div>',"</div>",'<div class="axis-auth-message-body">',"<p>{{pg1}}</p>",'<p>{{pg2a}} <a href="{{tpCookieUrl}}" target="_blank" >{{tpCookieUrlText}}<a/> {{pg2b}}</p>',"</div>",'<div class="axis-auth-message-footer">','<button class="axis-auth-action-bottom axis-auth-ok-bottom close-button">{{closeLinkText}}</button>',"</div>","</div>","</div>","</div>"].join("")}})}("BmAuth");