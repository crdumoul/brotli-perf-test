dojo.require("dojox.collections.ArrayList");dojo.require("wc.widget.Tooltip");CheckoutHelperJS={langId:"-1",storeId:"",catalogId:"",orderId:"",shipmentTypeId:"",varAddressId:"",orderItemIds:[],updateWaitTimeOut:1500,keyPressCount:{},ajaxCheckOut:true,singlePageCheckout:true,selectedAddressesArray:{},dataDirty:{},fieldDirtyFlag:false,resetRequestedShipDateValue:"1970-01-01T00:00:00.000Z",shoppingCartPage:false,pendingOrderDetailsPage:false,RequestShippingDateAction:false,shipChargeEnabled:false,tempOrderId:"",tempUserType:"",tempEmailAddresses:"",msFlag:"",tempIsQuote:false,tempOrderTotal:"0",orderItemCounter:"0",orderItemArr:new Array(),orderItemArrLength:"0",shipModeId:"",procesShipmentType:"",mattelSubOrderID:"",mattelSubOrderCount:"",mattelAddressIdForOrderItemAdd:"",mattelShipModeIdForOrderItemAdd:"",setOrderItemCounter:function(counter){this.orderItemCounter=counter;
},tempPaymentInstructions:{},lastAddressLinkIdToFocus:"",lastFocusId:"",SubmitMSAddress:false,pageLoadRequestFromMS:false,shipAddressId:"",setLastFocus:function(id){this.lastFocusId=id;},getLastFocus:function(){return this.lastFocusId;},tabPressed:function(event){if(event.keyCode==9){tabPressed=true;
}},setLastAddressLinkIdToFocus:function(lastLinkId){this.lastAddressLinkIdToFocus=lastLinkId;},getLastAddressLinkIdToFocus:function(){return this.lastAddressLinkIdToFocus;},orderPrepared:"false",setOrderPrepared:function(inPrepareIndicator){this.orderPrepared=inPrepareIndicator;},isOrderPrepared:function(){return this.orderPrepared;
},saveCheckoutOrderParameters:function(orderId,userType,addressListForMailNotification,isQuote){this.tempOrderId=orderId;this.tempUserType=userType;this.tempEmailAddresses=addressListForMailNotification;this.tempIsQuote=isQuote;},setOrderPayments:function(orderTotal,paymentInstructions){this.tempOrderTotal=orderTotal+0;
this.tempPaymentInstructions=paymentInstructions;},isOrderPaymentFullyAllocated:function(){var allocatedAmount=0;if(this.tempPaymentInstructions.length>=1){for(var i=0;i<this.tempPaymentInstructions.length;i++){allocatedAmount=allocatedAmount+this.tempPaymentInstructions[i].amount.value;}}if(allocatedAmount==this.tempOrderTotal){return true;
}else{if(allocatedAmount<this.tempOrderTotal){MessageHelper.displayErrorMessage(MessageHelper.messages["EDPPaymentMethods_CANNOT_RECONCILE_PAYMENT_AMT"]);return false;}else{if(allocatedAmount>this.tempOrderTotal){MessageHelper.displayErrorMessage(MessageHelper.messages["EDPPaymentMethods_PAYMENT_AMOUNT_LARGER_THAN_ORDER_AMOUNT"]);
return false;}else{MessageHelper.displayErrorMessage(MessageHelper.messages["EDPPaymentMethods_PAYMENT_AMOUNT_PROBLEM"]);return false;}}}},getSavedParameter:function(paramName){return this[paramName];},setShipChargeEnabled:function(enabled){this.shipChargeEnabled=enabled;},updateParamObject:function(params,key,value,toArray,index){if(params==null){params=[];
}if(params[key]!=null&&toArray){if(dojo.lang.isArrayLike(params[key])){if(index!=null&&index!=""){params[key][index]=value;}else{params[key].push(value);}}else{var tmpValue=params[key];params[key]=[];params[key].push(tmpValue);params[key].push(value);}}else{if(index!=null&&index!=""&&index!=-1){params[key+"_"+index]=value;
}else{if(index==-1){var i=1;while(params[key+"_"+i]!=null){i++;}params[key+"_"+i]=value;}else{params[key]=value;}}}return params;},checkRequestShippingDateBox:function(checkBoxName,divName,suffix){var thisCheckBoxName;var thisDivName;if(suffix!=null&&suffix!=""){checkBoxName=checkBoxName+"_"+suffix;divName=divName+"_"+suffix;
}var checkBox=dojo.byId(checkBoxName);if(checkBox.checked){dojo.byId(divName).style.visibility="visible";dojo.byId(divName).style.display="block";}else{dojo.byId(divName).style.visibility="hidden";dojo.byId(divName).style.display="none";if(this.shipmentTypeId=="1"){dojo.byId("requestedShippingDate").blur();
}else{if(this.shipmentTypeId=="2"){dojo.byId("MS_requestedShippingDate_"+suffix).blur();}}}var addressId,shipModeId="";if(this.shipmentTypeId=="1"){addressId=document.getElementById("singleShipmentAddress").value;shipModeId=document.getElementById("singleShipmentShippingMode").value;}else{if(this.shipmentTypeId=="2"){addressId=document.getElementById("MS_ShipmentAddress_"+suffix).value;
shipModeId=document.getElementById("MS_ShippingMode_"+suffix).value;}else{console.debug("shipmentTypeId is undefined. Single shipment has Id 1; multiple shipment has Id 2.");}}if(!checkBox.checked&&this.isAjaxCheckOut()){var params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;
params["langId"]=this.langId;params.orderId=".";this.updateParamObject(params,"addressId",addressId,false,-1);this.updateParamObject(params,"shipModeId",shipModeId,false,-1);if(dijit.byId("requestedShippingDate")!=null||dijit.byId("MS_requestedShippingDate_"+suffix)!=null){this.updateParamObject(params,"requestedShipDate",this.resetRequestedShipDateValue,false,-1);
}var orderItemId=null;var qty=-1;var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){if(document.getElementById("qty_"+(i+1))!=null){qty=document.getElementById("qty_"+(i+1)).value;}orderItemId=document.getElementById("orderItem_"+(i+1)).value;if(qty!=-1){if(this.shipmentTypeId=="1"){this.updateParamObject(params,"orderItemId",orderItemId,false,-1);
break;}else{if(this.shipmentTypeId=="2"){if(suffix!=null&&suffix!=""&&orderItemId==suffix){this.updateParamObject(params,"orderItemId",orderItemId,false,-1);break;}}else{console.debug("shipmentTypeId is undefined. Single shipment has Id 1; multiple shipment has Id 2.");}}}}if(!submitRequest()){return;
}cursor_wait();CheckoutHelperJS.RequestShippingDateAction=true;wc.service.invoke("OrderItemAddressShipMethodUpdate",params);}},checkShippingInstructionsBox:function(checkBoxName,divName,suffix){var thisCheckBoxName;var thisDivName;if(suffix!=null&&suffix!=""){thisCheckBoxName=checkBoxName+"_"+suffix;
thisDivName=divName+"_"+suffix;}else{thisCheckBoxName=checkBoxName;thisDivName=divName;}var thisCheckBox=dojo.byId(thisCheckBoxName);if(thisCheckBox.checked){dojo.byId(thisDivName).style.visibility="visible";dojo.byId(thisDivName).style.display="block";}else{dojo.byId(thisDivName).style.visibility="hidden";
dojo.byId(thisDivName).style.display="none";}var addressId,shipModeId="";if(this.shipmentTypeId=="1"){addressId=document.getElementById("singleShipmentAddress").value;shipModeId=document.getElementById("singleShipmentShippingMode").value;}else{if(this.shipmentTypeId=="2"){var orderItemId,tempAddressId,tempShipModeId="";
addressId=document.getElementById("MS_ShipmentAddress_"+suffix).value;shipModeId=document.getElementById("MS_ShippingMode_"+suffix).value;var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){orderItemId=document.getElementById("orderItem_"+(i+1)).value;
tempAddressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;tempShipModeId=document.getElementById("MS_ShippingMode_"+orderItemId).value;if(tempShipModeId==shipModeId&&tempAddressId==addressId){var tempDivName=divName+"_"+orderItemId;var tempCheckBoxName=checkBoxName+"_"+orderItemId;
if(thisCheckBox.checked){dojo.byId(tempDivName).style.visibility="visible";dojo.byId(tempDivName).style.display="block";dojo.byId(tempCheckBoxName).checked="checked";}else{dojo.byId(tempDivName).style.visibility="hidden";dojo.byId(tempDivName).style.display="none";dojo.byId(tempCheckBoxName).checked="";
}}}}}else{console.debug("shipmentTypeId is undefined. Single shipment has Id 1; multiple shipment has Id 2.");}}if(!thisCheckBox.checked&&this.isAjaxCheckOut()){var params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";var orderItemId=null;
if(this.shipmentTypeId=="1"){if(document.getElementById("shipInstructions")!=null){this.updateParamObject(params,"shipInstructions","",false);document.getElementById("shipInstructions").value="";}orderItemId=document.getElementById("orderItem_1").value;this.updateParamObject(params,"addressId",addressId,false);
this.updateParamObject(params,"orderItemId",orderItemId,false);}else{if(this.shipmentTypeId=="2"){if(suffix!=null&&suffix!=""){if(document.getElementById("MS_shipInstructions_"+suffix)!=null){this.updateParamObject(params,"shipInstructions","",false);document.getElementById("MS_shipInstructions_"+suffix).value="";
}this.updateParamObject(params,"addressId",addressId,false,-1);this.updateParamObject(params,"orderItemId",suffix,false);this.setShippingInstuctionsForAllOtherItems(addressId,shipModeId,"");}}else{console.debug("shipmentTypeId is undefined. Single shipment has Id 1; multiple shipment has Id 2.");}}if(!submitRequest()){return;
}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params);}},initializeShipmentPage:function(shipmentTypeId){this.shipmentTypeId=shipmentTypeId;},initializeMSFlag:function(msFlag){this.msFlag=msFlag;},getMSFlag:function(){return this.msFlag;},setCommonParameters:function(langId,storeId,catalogId){this.langId=langId;
this.storeId=storeId;this.catalogId=catalogId;},orderItemIdForDelete:null,isSaveForLater:false,deleteFromCart:function(orderItemId,forWishlist,isASet){if(!this.isAjaxCheckOut()){return;}console.info("orderItemId in deleteFromCart: "+orderItemId);var tPoductId=document.getElementById("t_product_id_"+orderItemId);
if(this.isSaveForLater==false){if(tPoductId.value!=null||tPoductId.value!=undefined){try{analyticTagVar_addInfo=document.getElementById("t_product_id_"+orderItemId).value;Mattel.Analytics.addEvent("loadRemoveProdCartEvent");analyticTagVar_addInfo=undefined;}catch(err){Mattel.Utils.log(err);}}}this.isSaveForLater=false;
var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=(this.orderId!=null&&this.orderId!="undefined"&&this.orderId!="")?this.orderId:".";if(orderItemId.indexOf(",")!=-1){var arr_oi=orderItemId.split(",");arr_oi=deleteDuplicatesFromArray(arr_oi);
for(i=0;i<arr_oi.length;i++){if(!this.isEmpty(arr_oi[i])){console.info("arr_oi[i]: "+arr_oi[i]);this.updateParamObject(params,"orderItemId",arr_oi[i],false,-1);}}}else{this.updateParamObject(params,"orderItemId",orderItemId,false,-1);}var isOrderItemWCSSet=document.getElementById("isWCSSet_"+orderItemId);
if(isOrderItemWCSSet!=null&&isOrderItemWCSSet!=undefined){params.isWCSSet=isOrderItemWCSSet.value;}params.mattelOrderType="Standard Orders";params.inventoryValidation="true|Standard Orders";if(orderItemId==null){this.updateParamObject(params,"orderItemId",this.orderItemIdForDelete,false,-1);}if(this.shoppingCartPage){params.calculationUsage="-1,-2,-5,-6,-7";
}else{params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";}if(!isASet){var giftOptions=document.getElementById("gift_oid_"+orderItemId);var addOns=document.getElementById("addon_oid_"+orderItemId);if(giftOptions!=null&&giftOptions!=undefined){var arr1=giftOptions.value.split(",");for(i=0;i<arr1.length;i++){if(!this.isEmpty(arr1[i])){this.updateParamObject(params,"orderItemId",arr1[i],false,-1);
}}}}if(addOns!=null&&addOns!=undefined){var arr2=addOns.value.split(",");for(i=0;i<arr2.length;i++){if(!this.isEmpty(arr2[i])){this.updateParamObject(params,"orderItemId",arr2[i],false,-1);}}}var setComponents=document.getElementById("setComponents_"+orderItemId);if(setComponents!=null&&setComponents!=undefined&&setComponents.value!=""){var compArr=setComponents.value.split(",");
for(i=0;i<compArr.length;i++){this.updateParamObject(params,"orderItemId",compArr[i],false,-1);}}var x=document.getElementById("totalNumberOfItems").value;var y=x;for(var i=0;i<x;i++){var qtyObj=document.getElementById("freeGift_qty_"+(i+1));if(qtyObj!=null||qtyObj!=undefined){qty=qtyObj.value;if(qty!=null&&qty!=undefined&&qty==-1){y=y-1;
}}}this.shoppingCartPage="true";if(y==1){wc.service.invoke("AjaxDeleteOrderItem1",params);}else{if(forWishlist){wc.service.invoke("AjaxDeleteOrderItemFromCart",params);}else{if(this.shoppingCartPage||this.pendingOrderDetailsPage){wc.service.invoke("AjaxDeleteOrderItem",params);}else{wc.service.invoke("AjaxDeleteOrderItemForShippingBillingPage",params);
}}}},deleteFromCartFromShippingPage:function(orderItemId,forWishlist){if(!this.isAjaxCheckOut()){return;}var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;var tProductId=document.getElementById("t_product_id_"+orderItemId);params.orderId=(this.orderId!=null&&this.orderId!="undefined"&&this.orderId!="")?this.orderId:".";
if(tProductId.value!=null||tProductId.value!=undefined){try{analyticTagVar_addInfo=document.getElementById("t_product_id_"+orderItemId).value;Mattel.Analytics.addEvent("loadRemoveMSProdCartEvent");analyticTagVar_addInfo=undefined;}catch(err){Mattel.Utils.log(err);}}if(orderItemId.indexOf(",")!=-1){var arr_oi=orderItemId.split(",");
arr_oi=deleteDuplicatesFromArray(arr_oi);for(i=0;i<arr_oi.length;i++){if(!this.isEmpty(arr_oi[i])){console.info("arr_oi[i]: "+arr_oi[i]);this.updateParamObject(params,"orderItemId",arr_oi[i],false,-1);}}}else{this.updateParamObject(params,"orderItemId",orderItemId,false,-1);}var isOrderItemWCSSet=document.getElementById("isWCSSet_"+orderItemId);
if(isOrderItemWCSSet!=null&&isOrderItemWCSSet!=undefined){params.isWCSSet=isOrderItemWCSSet.value;}params.mattelOrderType="Standard Orders";params.inventoryValidation="true|Standard Orders";if(orderItemId==null){this.updateParamObject(params,"orderItemId",this.orderItemIdForDelete,false,-1);}if(this.shoppingCartPage){params.calculationUsage="-1,-2,-5,-6,-7";
}else{params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";}var giftOptions=document.getElementById("gift_oid_"+orderItemId);var addOns=document.getElementById("addon_oid_"+orderItemId);if(giftOptions!=null&&giftOptions!=undefined){var arr1=giftOptions.value.split(",");for(i=0;i<arr1.length;i++){if(!this.isEmpty(arr1[i])){console.info("arr1: "+arr1[i]);
this.updateParamObject(params,"orderItemId",arr1[i],false,-1);}}}if(addOns!=null&&addOns!=undefined){var arr2=addOns.value.split(",");for(i=0;i<arr2.length;i++){if(!this.isEmpty(arr2[i])){console.info("arr2: "+arr2[i]);this.updateParamObject(params,"orderItemId",arr2[i],false,-1);}}}var setComponents=document.getElementById("setComponents_"+orderItemId);
if(setComponents!=null&&setComponents!=undefined&&setComponents.value!=""){var compArr=setComponents.value.split(",");for(i=0;i<compArr.length;i++){this.updateParamObject(params,"orderItemId",compArr[i],false,-1);}}var x=document.getElementById("totalNumberOfItems").value;var y=x;for(var i=0;i<x;i++){var qtyObj=document.getElementById("freeGift_qty_"+(i+1));
if(qtyObj!=null||qtyObj!=undefined){qty=qtyObj.value;if(qty!=null&&qty!=undefined&&qty==-1){y=y-1;}}}if(y==1){wc.service.invoke("AjaxDeleteOrderItem1",params);}else{if(forWishlist){wc.service.invoke("AjaxDeleteOrderItemFromCart",params);}else{wc.service.invoke("AjaxDeleteOrderItemForShippingBillingPage",params);
}}},addToWishListAndDeleteFromCart:function(catEntryIdentifier,orderItemId){if(!this.isAjaxCheckOut()){return;}var params=[];params.catEntryId=catEntryIdentifier;params.URL="SuccessfulAJAXRequest";params.orderItemId=orderItemId;params.updateable=0;params.langId=this.langId;params.storeId=this.storeId;
params.catalogId=this.catalogId;if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxInterestItemAddAndDeleteFromCart",params);},updateAddressIdOFItemsOnCreateEditAddress:function(addressId){var params=[];params.orderId=".";params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;
params["langId"]=this.langId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";if(this.shipmentTypeId=="1"){params.addressId=addressId;}else{var orderItemId=null;for(var i=0;i<this.orderItemIds.length;i++){orderItemId=this.orderItemIds[i];
this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"addressId",addressId,false,-1);}}if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxUpdateOrderItemsAddressId",params);},saveOrderItemsList:function(orderItemId,addressId){if(orderItemId=="-1"){var totalItems=document.getElementById("totalNumberOfItems").value;
for(var i=0;i<totalItems;i++){this.orderItemIds[i]=document.getElementById("orderItem_"+(i+1)).value;}}else{if(orderItemId==0&&this.shipmentTypeId=="1"){if(document.getElementById("singleShipmentAddress")){if(addressId==document.getElementById("singleShipmentAddress").value){var totalItems=document.getElementById("totalNumberOfItems").value;
for(var i=0;i<totalItems;i++){this.orderItemIds[i]=document.getElementById("orderItem_"+(i+1)).value;}}else{this.orderItemIds=[];}}else{this.orderItemIds=[];}return;}else{var totalItems=document.getElementById("totalNumberOfItems").value;var temp=null;var orderItemId=null;var j=0;for(var i=0;i<totalItems;
i++){orderItemId=document.getElementById("orderItem_"+(i+1)).value;if(document.getElementById("MS_ShipmentAddress_"+orderItemId)){temp=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;if(temp==addressId){this.orderItemIds[j++]=orderItemId;}}}}}},setShippingInstuctionsForAllOtherItems:function(addressId,shipModeId,shipInstructions){var orderItemId,addressId1,shipModeId1="";
var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){orderItemId=document.getElementById("orderItem_"+(i+1)).value;addressId1=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;
shipModeId1=document.getElementById("MS_ShippingMode_"+orderItemId).value;if(shipModeId1==shipModeId&&addressId1==addressId){document.getElementById("MS_shipInstructions_"+orderItemId).value=shipInstructions;}}}},shipAsComplete:function(checkBox){if(!this.isAjaxCheckOut()){return;}var params=[];params.orderId=".";
params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";if(checkBox.checked){this.updateParamObject(params,"ShipAsComplete","Y",true);}else{this.updateParamObject(params,"ShipAsComplete","N",true);}orderItemId=document.getElementById("orderItem_1").value;
this.updateParamObject(params,"orderItemId",orderItemId,false);if(!submitRequest()){return;}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params);},updateAddressIdForOrderItem:function(addressId){if(addressId==null||addressId.length==0){return true;}var params=[];params["storeId"]=this.storeId;
params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";this.updateParamObject(params,"addressId",addressId,false);wc.service.invoke("AjaxSetAddressIdOfOrderItems",params);
},updateShipModeIdForOrder:function(shipModeId){var params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params["shipModeId"]=shipModeId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";
params.check="*n";wc.service.invoke("AjaxSetShipModeIdForOrder",params);},applyPromotionCode:function(formName,returnView){var form=document.forms[formName];if(trim(form.promoCode.value)==""){MessageHelper.formErrorHandleClient(form.promoCode.id,MessageHelper.messages["OFFER_CODE_EMPTY"]);return;}if(this.isAjaxCheckOut()){service=wc.service.getServiceById("AjaxPromotionCodeManage");
service.formId=formName;if(form.URL!=null){form.URL.value="";}if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxPromotionCodeManage");}else{if(returnView==null||returnView==""||returnView=="undefined"){returnView="OrderShippingBillingView";}var input=document.createElement("INPUT");input.setAttribute("type","hidden");
input.setAttribute("name","errorViewName");input.setAttribute("value",returnView);form.appendChild(input);form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7&URL="+returnView;if(!submitRequest()){return;}form.submit();}},applyMattelPromotionCode:function(formName,returnView){var form=document.forms[formName];
if(typeof form!="undefined"){form=form.replace(/^\s+|\s+$/g,"");}if(trim(form.promoCode.value)==""){MessageHelper.displayPromoCodeErrorMessage(MessageHelper.messages["OFFER_CODE_EMPTY"]);Mattel.Analytics.publishFormErrors();return;}service=wc.service.getServiceById("AjaxPromotionCodeManage");service.formId=formName;
if(form.URL!=null){form.URL.value="";}cursor_wait();wc.service.invoke("AjaxPromotionCodeManage");},applyMattelPromotionCode:function(orderId,returnView,taskType){var promoCode;if(typeof document.getElementById("promoCode")!="undefined"){promoCode=document.getElementById("promoCode").value;promoCode=promoCode.replace(/^\s+|\s+$/g,"");
}if(trim(promoCode)==""){MessageHelper.displayPromoCodeErrorMessage(MessageHelper.messages["OFFER_CODE_EMPTY"]);Mattel.Analytics.publishFormErrors();return;}var params=[];if(""==this.storeId){params["storeId"]=document.getElementById("storeId").value;}else{params["storeId"]=this.storeId;}if(""==this.catalogId){params["catalogId"]=document.getElementById("catalogId").value;
}else{params["catalogId"]=this.catalogId;}params["langId"]=this.langId;params["orderId"]=orderId;params["returnView"]=returnView;params["taskType"]=taskType;params["URL"]="/";params["promoCode"]=promoCode;if(!submitRequest()){return;}wc.service.invoke("AjaxPromotionCodeManage",params);},removePromotionCode:function(formName,promoCode,returnView){var form=document.forms[formName];
form.taskType.value="R";form.promoCode.value=promoCode;if(this.isAjaxCheckOut()){service=wc.service.getServiceById("AjaxPromotionCodeManage");service.formId=formName;if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxPromotionCodeManage");}else{if(returnView==null||returnView==""||returnView=="undefined"){returnView="OrderShippingBillingView";
}form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7&URL="+returnView;if(!submitRequest()){return;}form.submit();}},removeMattelPromotionCode:function(formName,promoCode,returnView){var form=document.forms[formName];form.taskType.value="R";form.promoCode.value=promoCode;
service=wc.service.getServiceById("AjaxPromotionCodeManage");service.formId=formName;cursor_wait();wc.service.invoke("AjaxPromotionCodeManage");},removeMattelPromotionCode:function(orderId,returnView,taskType,promoCode){var params=[];if(""==this.storeId){params["storeId"]=document.getElementById("storeId").value;
}else{params["storeId"]=this.storeId;}if(""==this.catalogId){params["catalogId"]=document.getElementById("catalogId").value;}else{params["catalogId"]=this.catalogId;}params["langId"]=this.langId;params["orderId"]=orderId;params["returnView"]=returnView;params["taskType"]=taskType;params["URL"]="/";params["promoCode"]=promoCode;
wc.service.invoke("AjaxPromotionCodeManage",params);},applyCoupon:function(formName,returnView,couponId){var form=document.forms[formName];form.setAttribute("action","CouponsAddRemove");form.couponId.value=couponId;form.taskType.value="A";if(!submitRequest()){return;}if(this.isAjaxCheckOut()){service=wc.service.getServiceById("AjaxCouponsAddRemove");
service.formId=formName;cursor_wait();wc.service.invoke("AjaxCouponsAddRemove");}else{form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7&URL="+returnView;form.submit();}},removeCouponFromOrder:function(formName,returnView,couponId){var form=document.forms[formName];
form.setAttribute("action","CouponsAddRemove");form.couponId.value=couponId;form.taskType.value="R";if(!submitRequest()){return;}if(this.isAjaxCheckOut()){service=wc.service.getServiceById("AjaxCouponsAddRemove");service.formId=formName;cursor_wait();wc.service.invoke("AjaxCouponsAddRemove");}else{form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7&URL="+returnView;
form.submit();}},setAjaxCheckOut:function(ajaxCheckOut){this.ajaxCheckOut=ajaxCheckOut;},isAjaxCheckOut:function(){return this.ajaxCheckOut;},setSinglePageCheckout:function(singlePageCheckout){this.singlePageCheckout=singlePageCheckout;},isSinglePageCheckout:function(){return this.singlePageCheckout;
},checkoutOrder:function(orderId,userType,addressListForMailNotification,isQuote){if(isQuote==undefined||isQuote==null){isQuote=false;}if(this.isOrderPrepared()=="false"){if(this.isOrderPaymentFullyAllocated()){this.saveCheckoutOrderParameters(orderId,userType,addressListForMailNotification,isQuote);
wc.service.invoke("AjaxPrepareOrderForSubmit");return;}else{return;}}params=[];params["orderId"]=orderId;params["notifyMerchant"]=1;params["notifyShopper"]=1;params["notifyOrderSubmitted"]=1;params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;var purchaseOrderForm=document.forms["purchaseOrderNumberInfo"];
if(purchaseOrderForm){var purchaseOrderNumber=purchaseOrderForm.purchase_order_number.value;if(purchaseOrderForm.purchaseOrderNumberRequired.value=="true"&&purchaseOrderForm.purchase_order_number.value==""){MessageHelper.formErrorHandleClient(purchaseOrderForm.purchase_order_number,MessageHelper.messages["ERROR_PONumberEmpty"]);
return;}else{if(!MessageHelper.isValidUTF8length(purchaseOrderForm.purchase_order_number.value,128)){MessageHelper.formErrorHandleClient(purchaseOrderForm.purchase_order_number,MessageHelper.messages["ERROR_PONumberTooLong"]);return;}}}params["purchaseorder_id"]=purchaseOrderNumber;if(userType=="G"){addressListForMailNotification=trim(addressListForMailNotification);
var emailList=[];emailList=addressListForMailNotification.split(" ");var uniqueList=[];for(var j=0;j<emailList.length;j++){uniqueList[emailList[j]]=emailList[j];}var totalLength=0;for(i in uniqueList){totalLength=totalLength+1;}var temp="";var k=0;for(i in uniqueList){k=k+1;temp=temp+uniqueList[i];if(k<totalLength){temp=temp+",";
}}params["notify_EMailSender_recipient"]=temp;var smsOrderNotificationCheckbox=document.getElementById("sendMeSMSNotification");if(smsOrderNotificationCheckbox!=null&&smsOrderNotificationCheckbox!="undefined"){if(smsOrderNotificationCheckbox.checked){var mobileCountryCode=document.getElementById("mobileCountryCode");
var mobilePhone1=document.getElementById("mobilePhone1");if(mobileCountryCode!=null&&mobileCountryCode!="undefined"&&mobilePhone1!=null&&mobilePhone1!="undefined"){params["SMS"]=mobileCountryCode.value+mobilePhone1.value;}}}}if(!submitRequest()){return;}cursor_wait();if(!isQuote){wc.service.invoke("AjaxSubmitOrder",params);
}else{params["URL"]="";this.setOrderId(orderId);wc.service.invoke("AjaxSubmitQuote",params);}},prepareOrderSchedule:function(){if(document.getElementById("scheduleOrderInputSection")!=null){var scheduleOrderStartDateObj=dijit.byId("ScheduleOrderStartDate");if(!this.validateDate(scheduleOrderStartDateObj,"ScheduleOrderStartDate")){return;
}var interval=dojo.byId("ScheduleOrderFrequency").value;var key1="WC_ScheduleOrder_"+document.getElementById("orderIdToSchedule").value+"_strStartDate";var key2="WC_ScheduleOrder_"+document.getElementById("orderIdToSchedule").value+"_interval";if((interval=="undefined")&&(scheduleOrderStartDateObj.value==null)){dojo.cookie(key1,null,{expires:-1});
dojo.cookie(key2,null,{expires:-1});}else{var t=dojo.date.stamp.fromISOString(scheduleOrderStartDateObj);var now=new Date();t.setHours(now.getHours(),now.getMinutes(),now.getSeconds(),now.getMilliseconds());t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true});
dojo.cookie(key1,t);dojo.cookie(key2,interval);}}},scheduleOrder:function(orderId,isRecurring,userType){if(userType==="G"&&isRecurring){MessageHelper.displayErrorMessage(MessageHelper.messages["ERROR_GUEST_USER_SUBMIT_RECURRING_ORDER"]);return;}var params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;
params["langId"]=this.langId;params["orderId"]=orderId;if(isRecurring!=undefined&&isRecurring==true){params["startDate"]=dojo.cookie("WC_ScheduleOrder_"+orderId+"_strStartDate");if(dojo.cookie("WC_ScheduleOrder_"+orderId+"_interval")=="1"){params["fulfillmentInterval"]="1";params["fulfillmentIntervalUOM"]="DAY";
params["timePeriod"]="1";params["timePeriodUOM"]="DAY";}else{if(dojo.cookie("WC_ScheduleOrder_"+orderId+"_interval")=="2"){params["fulfillmentInterval"]="1";params["fulfillmentIntervalUOM"]="DAY";}else{if(dojo.cookie("WC_ScheduleOrder_"+orderId+"_interval")=="3"){params["fulfillmentInterval"]="1";params["fulfillmentIntervalUOM"]="WEE";
}else{if(dojo.cookie("WC_ScheduleOrder_"+orderId+"_interval")=="4"){params["fulfillmentInterval"]="2";params["fulfillmentIntervalUOM"]="WEE";}else{if(dojo.cookie("WC_ScheduleOrder_"+orderId+"_interval")=="5"){params["fulfillmentInterval"]="3";params["fulfillmentIntervalUOM"]="WEE";}else{if(dojo.cookie("WC_ScheduleOrder_"+orderId+"_interval")=="6"){params["fulfillmentInterval"]="4";
params["fulfillmentIntervalUOM"]="WEE";}}}}}}}else{params["strStartDate"]=dojo.cookie("WC_ScheduleOrder_"+orderId+"_strStartDate");params["interval"]=dojo.cookie("WC_ScheduleOrder_"+orderId+"_interval");}var purchaseOrderForm=document.forms["purchaseOrderNumberInfo"];if(purchaseOrderForm){var purchaseOrderNumber=purchaseOrderForm.purchase_order_number.value;
if(purchaseOrderForm.purchaseOrderNumberRequired.value=="true"&&purchaseOrderForm.purchase_order_number.value==""){MessageHelper.formErrorHandleClient(purchaseOrderForm.purchase_order_number,MessageHelper.messages["ERROR_PONumberEmpty"]);return;}else{if(!MessageHelper.isValidUTF8length(purchaseOrderForm.purchase_order_number.value,128)){MessageHelper.formErrorHandleClient(purchaseOrderForm.purchase_order_number,MessageHelper.messages["ERROR_PONumberTooLong"]);
return;}}params["purchaseorder_id"]=purchaseOrderNumber;}if(!submitRequest()){return;}cursor_wait();if(isRecurring!=undefined&&isRecurring==true){wc.service.invoke("SubmitRecurringOrder",params);}else{wc.service.invoke("ScheduleOrder",params);}},validateDate:function(dateObj,elementId){var now=new Date();
if(dateObj.getValue()!=null&&(dateObj.compare(dateObj.getValue(),now)<0)){if(now.toDateString()===dateObj.getValue().toDateString()){return true;}if((elementId!=null)&&(document.getElementById(elementId)!=null)){MessageHelper.formErrorHandleClient(document.getElementById(elementId).id,MessageHelper.messages["PAST_DATE_ERROR"]);
}else{MessageHelper.displayErrorMessage(MessageHelper.messages["PAST_DATE_ERROR"]);}return false;}else{return true;}},validateDateOnBlur:function(dateObj,elementId){var now=new Date();if(dateObj.getValue()!=null&&(dateObj.compare(dateObj.getValue(),now)<0)){if(now.toDateString()===dateObj.getValue().toDateString()){return true;
}if((elementId!=null)&&(document.getElementById(elementId)!=null)){MessageHelper.formErrorHandleClient(document.getElementById(elementId).id,MessageHelper.messages["PAST_DATE_ERROR"]);}else{MessageHelper.displayErrorMessage(MessageHelper.messages["PAST_DATE_ERROR"]);}return false;}else{if(dateObj.state=="Error"){if((elementId!=null)&&(document.getElementById(elementId)!=null)){MessageHelper.formErrorHandleClient(document.getElementById(elementId).id,dateObj.getErrorMessage(false));
}else{MessageHelper.displayErrorMessage(dataObj.getErrorMessage(false));}return false;}else{return true;}}},createAddress:function(orderItemId,addressType){this.saveOrderItemsList(orderItemId,"-1");if(!submitRequest()){return;}var checkForOpera=true;cursor_wait(checkForOpera);wc.render.updateContext("editShippingAddressContext",{"shippingAddress":"-1","addressType":addressType});
this.showHideDivs("editAddressContents","mainContents");},showHideDivs:function(showArea,hideArea){document.getElementById(hideArea).style.display="none";document.getElementById(showArea).style.display="block";},restorePreviousAddressDetails:function(){var valueRestored=false;if(!this.isAjaxCheckOut()){for(i in this.selectedAddressesArray){if(document.getElementById(i)!=null&&document.getElementById(i).value==-1){document.getElementById(i).value=this.selectedAddressesArray[i];
valueRestored=true;if(this.shipmentTypeId=="1"){this.displayAddressDetails(document.getElementById("singleShipmentAddress").value,"Shipping");}}}}if(this.isAjaxCheckOut()||!valueRestored){if(this.shipmentTypeId=="2"){for(var i=0;i<this.orderItemIds.length;i++){var orderItemId=this.orderItemIds[i];var element=document.getElementById("MS_ShipmentAddress_"+orderItemId);
if(element!=null&&element.value==-1){element.value=document.getElementById("addressId_"+orderItemId).value;}}}else{if(this.shipmentTypeId=="1"){var element=document.getElementById("singleShipmentAddress");if(element!=null&&document.getElementById("addressId_all")){element.value=document.getElementById("addressId_all").value;
if(!this.isAjaxCheckOut()){this.displayAddressDetails(element.value,"Shipping");}}}}}for(var i=1;i<4;i++){if(document.getElementById("PaymentForm"+i)!=null){var paymentForm=document.getElementById("PaymentForm"+i);if(paymentForm.billing_address_id.value==-1){paymentForm.billing_address_id.value=document.getElementById("selectedAddressId_"+i).value;
if(!this.isAjaxCheckOut()){CheckoutPayments.displayBillingAddressDetailsWeb10(paymentForm.billing_address_id,i);}}if(wc.render.getContextById("billingAddressDropDownBoxContext").properties["billingAddress"+i]==-1){wc.render.getContextById("billingAddressDropDownBoxContext").properties["billingAddress"+i]=paymentForm.billing_address_id.value;
}}}},editAddress:function(addressSelectBoxName,orderItemId,profileshipping,profilebilling){var addressBox=document.getElementById(addressSelectBoxName);this.saveOrderItemsList(orderItemId,addressBox.value);if(addressBox.options[addressBox.selectedIndex].text==profileshipping||addressBox.options[addressBox.selectedIndex].text==profilebilling){if(addressSelectBoxName!=null){MessageHelper.formErrorHandleClient(addressSelectBoxName,MessageHelper.messages["ERROR_QUICKCHECKOUT_ADDRESS_CHANGE"]);
}else{MessageHelper.displayErrorMessage(MessageHelper.messages["ERROR_QUICKCHECKOUT_ADDRESS_CHANGE"]);}return;}if(!submitRequest()){return;}cursor_wait();wc.render.updateContext("editShippingAddressContext",{"shippingAddress":addressBox.value});this.showHideDivs("editAddressContents","mainContents");
},editBillingAddress:function(orderItemId,paymentArea,profileshipping,profilebilling){var form=document.forms["PaymentForm"+paymentArea];var addressBox=form.billing_address_id;this.saveOrderItemsList(orderItemId,addressBox.value);if(addressBox.options[addressBox.selectedIndex].text==profileshipping||addressBox.options[addressBox.selectedIndex].text==profilebilling){if(addressBox!=null){MessageHelper.formErrorHandleClient(addressBox,MessageHelper.messages["ERROR_QUICKCHECKOUT_ADDRESS_CHANGE"]);
}else{MessageHelper.displayErrorMessage(MessageHelper.messages["ERROR_QUICKCHECKOUT_ADDRESS_CHANGE"]);}return;}if(!submitRequest()){return;}cursor_wait();wc.render.updateContext("editShippingAddressContext",{"shippingAddress":addressBox.value});this.showHideDivs("editAddressContents","mainContents");
},cancelEditAddress:function(){this.showHideDivs("mainContents","editAddressContents");this.restorePreviousAddressDetails();if(this.getLastAddressLinkIdToFocus()!=null&&this.getLastAddressLinkIdToFocus()!="undefined"&&this.getLastAddressLinkIdToFocus()!=""){document.getElementById(this.getLastAddressLinkIdToFocus()).focus();
this.setLastAddressLinkIdToFocus("");}},getShipmentTypeId:function(){return this.shipmentTypeId;},paymentDataDirty:function(paymentAreaNumber,flag){this.dataDirty[paymentAreaNumber]=flag;console.debug("Information in payment area "+paymentAreaNumber+" has been modified.");},isPaymentDataDirty:function(paymentAreaNumber){return this.dataDirty[paymentAreaNumber];
},displayStoreAddressDetails:function(addressSelectBox){var selectedAddressId=addressSelectBox.value;for(j=0;j<addressSelectBox.options.length;j++){if(addressSelectBox.options[j].value==selectedAddressId){dojo.byId("addressDetails_"+addressSelectBox.options[j].value).style.display="block";}else{dojo.byId("addressDetails_"+addressSelectBox.options[j].value).style.display="none";
}}},updateStoreAddressForAllItems:function(addressSelectBox){if(!this.isAjaxCheckOut()){return;}var addressId=addressSelectBox.value;params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";
var orderItemId=null;var totalItems=document.getElementById("totalNumberOfItems").value;var addressId=document.getElementById("singleShipmentAddress").value;for(var i=0;i<totalItems;i++){orderItemId=document.getElementById("orderItem_"+(i+1)).value;this.updateParamObject(params,"orderItemId",orderItemId,false,-1);
this.updateParamObject(params,"physicalStoreId",addressId,false,-1);}if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxUpdateOrderItem",params);},updateShippingModeAndAddressForOrderItem:function(shippingModeSelectBox,orderItemId,pickUpInStoreShipMode){if(!this.isAjaxCheckOut()){return;
}var selectedShippingMode=shippingModeSelectBox.value;if(pickUpInStoreShipMode==selectedShippingMode){document.getElementById("MS_ShipMode_Section_"+orderItemId).className="nodisplay";document.getElementById("MS_ShipAdvancedOptions_Section_"+orderItemId).className="nodisplay";document.getElementById("MS_ShippingAddress_Section_"+orderItemId).className="nodisplay";
document.getElementById("MS_StoreAddress_Section_"+orderItemId).className="";}else{document.getElementById("MS_ShipMode_Section_"+orderItemId).className="";document.getElementById("MS_ShipAdvancedOptions_Section_"+orderItemId).className="";document.getElementById("MS_ShippingAddress_Section_"+orderItemId).className="";
document.getElementById("MS_StoreAddress_Section_"+orderItemId).className="nodisplay";}params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params["orderId"]=".";params["orderItemId"]=orderItemId;params["shipModeId"]=selectedShippingMode;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";
if(pickUpInStoreShipMode==selectedShippingMode){var physicalStoreId=document.getElementById("MS_StoreSelectBox_"+orderItemId).value;params["physicalStoreId"]=physicalStoreId;}else{if(document.getElementById("MS_ShipmentAddress_"+orderItemId)){var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;
params["addressId"]=addressId;}}if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxUpdateOrderItem",params);},updateStoreAddressForOrderItem:function(storeAddressSelectBox,orderItemId){if(!this.isAjaxCheckOut()){return;}var selectedPickUpStoreId=storeAddressSelectBox.value;params=[];params["storeId"]=this.storeId;
params["catalogId"]=this.catalogId;params["langId"]=this.langId;params["orderId"]=".";params["orderItemId"]=orderItemId;params["physicalStoreId"]=selectedPickUpStoreId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxUpdateOrderItem",params);
},setFieldDirtyFlag:function(value){this.fieldDirtyFlag=value;},getFieldDirtyFlag:function(){return this.fieldDirtyFlag;},checkForDirtyFlag:function(){if(this.getFieldDirtyFlag()){if(document.getElementById("ShoppingCart_NonAjaxUpdate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("ShoppingCart_NonAjaxUpdate"),MessageHelper.messages["ERROR_UPDATE_FIRST_SHOPPING_CART"]);
return true;}else{if(document.getElementById("MultipleShipment_NonAjaxShipInfoUpdate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("MultipleShipment_NonAjaxShipInfoUpdate"),MessageHelper.messages["ERROR_UPDATE_FIRST"]);return true;}else{if(document.getElementById("SingleShipment_NonAjaxShipInfoUpdate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("SingleShipment_NonAjaxShipInfoUpdate"),MessageHelper.messages["ERROR_UPDATE_FIRST"]);
return true;}else{MessageHelper.displayErrorMessage(MessageHelper.messages["ERROR_UPDATE_FIRST"]);return true;}}}}return false;},showHideCheckoutSMS:function(checkboxElementId,smsElementId){var smsOrderNotificationCheckbox=document.getElementById(checkboxElementId);if(smsOrderNotificationCheckbox!=null&&smsOrderNotificationCheckbox!="undefined"){if(smsOrderNotificationCheckbox.checked){showElementById(smsElementId);
}else{hideElementById(smsElementId);}}},getCountryArray:function(){if(document["countries"]==null){countries=new Array();var theDiv=document.getElementById("countryListSelectionHelper");if(typeof theDiv=="undefined"){return null;}var divJSON=eval("("+theDiv.innerHTML+")");var countriesObject=divJSON.countries;
for(var i=0;i<countriesObject.length;i++){var countryObject=countriesObject[i];countries[countryObject.code]=new Object();countries[countryObject.code].name=countryObject.displayName;countries[countryObject.code].countryCallingCode=countryObject.callingCode;if(countryObject.states.length>0){countries[countryObject.code].states=new Object();
for(var j=0;j<countryObject.states.length;j++){var state=countryObject.states[j];countries[countryObject.code].states[state.code]=state.displayName;}}}}return countries;},loadCountryCode:function(countryDropDownId,countryCallingCodeId){this.getCountryArray();var countryCode=document.getElementById(countryDropDownId).value;
document.getElementById(countryCallingCodeId).value=countries[countryCode].countryCallingCode;},expediteShipping:function(checkBox,inputOrderItemId){if(!this.isAjaxCheckOut()){return;}var params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;if(checkBox.checked){this.updateParamObject(params,"isExpedited","Y",true);
}else{this.updateParamObject(params,"isExpedited","N",true);}if(inputOrderItemId!=null){this.updateParamObject(params,"orderItemId",inputOrderItemId,false);}if(!submitRequest()){return;}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params);},updateCartWait:function(quantityBox,orderItemId,event){if(event.keyCode==dojo.keys.TAB){return;
}if(!this.isAjaxCheckOut()){return;}if(this.keyPressCount[orderItemId]==null&&isNaN(this.keyPressCount[orderItemId])){this.keyPressCount[orderItemId]=0;}this.keyPressCount[orderItemId]=parseInt(this.keyPressCount[orderItemId])+1;setTimeout(dojo.hitch(this,"updateCart",quantityBox,orderItemId,this.keyPressCount[orderItemId]),this.updateWaitTimeOut);
try{analyticTagVar_addInfo=document.getElementById("t_product_id_"+orderItemId).value;Mattel.Analytics.addEvent("loadCartQuantityChangeEvent");analyticTagVar_addInfo=undefined;}catch(err){Mattel.Utils.log(err);}},currentQty:"",getCurrentQty:function(Obj){this.currentQty=Obj.value;},updateCart:function(quantityBox,orderItemId,keyPressCountValue){if(keyPressCountValue<this.keyPressCount[orderItemId]){return;
}var quantity=(quantityBox.value);if(!isNonNegativeInteger(quantity)){MessageHelper.mattelQtyFormErrorHandleClient(MessageHelper.messages["QUANTITY_INPUT_ERROR"],orderItemId);}else{if(this.currentQty==quantity){console.debug("Same Quantity");return;}else{var params=[];params.orderId=".";params["storeId"]=this.storeId;
params["catalogId"]=this.catalogId;params["langId"]=this.langId;params["mattelOrderType"]="Standard Orders";if(quantity!=0){if(this.shoppingCartPage){params.calculationUsage="-1,-2,-5,-6,-7,-21";params.inventoryValidation="true|Standard Orders";}else{params.calculationUsage="-1,-2,-3,-4,-5,-6,-7,-21";
}}else{if(this.shoppingCartPage){params.calculationUsage="-1,-2,-5,-6,-7";params.inventoryValidation="true|Standard Orders";}else{params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";}}this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"quantity",quantity,false,-1);
var giftOptions=document.getElementById("gift_oid_"+orderItemId);var addOns=document.getElementById("addon_oid_"+orderItemId);if(giftOptions!=null&&giftOptions!=undefined){var arr1=giftOptions.value.split(",");for(i=0;i<arr1.length;i++){if(!this.isEmpty(arr1[i])){this.updateParamObject(params,"orderItemId",arr1[i],false,-1);
this.updateParamObject(params,"quantity",quantity,false,-1);}}}if(addOns!=null&&addOns!=undefined){var arr2=addOns.value.split(",");for(i=0;i<arr2.length;i++){if(!this.isEmpty(arr2[i])){this.updateParamObject(params,"orderItemId",arr2[i],false,-1);this.updateParamObject(params,"quantity",quantity,false,-1);
}}}var setComponents=document.getElementById("setComponents_"+orderItemId);if(setComponents!=null&&setComponents!=undefined){var arr3=setComponents.value.split(",");for(i=0;i<arr3.length;i++){if(!this.isEmpty(arr3[i])){this.updateParamObject(params,"orderItemId",arr3[i],false,-1);this.updateParamObject(params,"quantity",quantity,false,-1);
}}}if(quantity==0){var x=document.getElementById("totalNumberOfItems").value;var y=x;for(var i=0;i<x;i++){var qtyObj=document.getElementById("freeGift_qty_"+(i+1));if(qtyObj!=null||qtyObj!=undefined){qty=qtyObj.value;if(qty!=null&&qty!=undefined&&qty==-1){y=y-1;}}}if(y==1){wc.service.invoke("AjaxUpdateOrderItem1",params);
}else{wc.service.invoke("AjaxUpdateOrderItem",params);}}else{wc.service.invoke("AjaxUpdateOrderItem",params);}}}},initDojoEventListenerShoppingCartPage:function(){if(document.getElementById("totalNumberOfItems")!=null){var totalItems=document.getElementById("totalNumberOfItems").value;if(totalItems!=null&&totalItems>0){for(var i=0;
i<totalItems;i++){var object=dojo.byId("quantity_"+(i+1));if(object!=null){dojo.connect(object,"onchange",setDirtyFlag);}}}else{console.debug("error: element 'totalNumberOfItems' was expected but undefined.");return;}}},updateShoppingCart:function(form,validateQuantityOnly){if(validateQuantityOnly!=undefined&&validateQuantityOnly==true&&!this.isAjaxCheckOut()){return true;
}MessageHelper.hideAndClearMessage();var totalItems=document.getElementById("totalNumberOfItems").value;if(totalItems!=null){for(var i=0;i<totalItems;i++){var quantity=null;if(form!=undefined){quantity=form["quantity_"+(i+1)];}else{if(dojo.byId("qty_"+(i+1))!=null){quantity=dojo.byId("qty_"+(i+1));}}if(quantity!=null||quantity!=undefined){var v=quantity.value;
if(!isNonNegativeInteger(v)){MessageHelper.formErrorHandleClient(quantity.id,MessageHelper.messages["QUANTITY_INPUT_ERROR"]);return;}}}if(validateQuantityOnly!=undefined&&validateQuantityOnly==true){return true;}if(!submitRequest()){return;}var beginIndex=wc.render.getContextById("ShopCartPaginationDisplay_Context").properties["beginIndex"];
if(beginIndex==null||beginIndex==""){beginIndex=0;}form.URL.value=form.URL.value+"&beginIndex="+beginIndex;form.submit();this.setFieldDirtyFlag(false);}else{console.debug("error: element 'totalNumberOfItems' was expected but undefined.");return;}},canCheckoutContinue:function(userType){if(document.getElementById("recurringOrder")&&document.getElementById("recurringOrder").checked&&document.getElementById("shipTypeOnline")&&document.getElementById("shipTypeOnline").checked){if(document.getElementById("nonRecurringOrderItems")&&document.getElementById("nonRecurringOrderItems").value!=""){MessageHelper.displayErrorMessage(MessageHelper.messages["RECURRINGORDER_ERROR"]);
return false;}else{if(userType!=undefined&&userType==="G"){MessageHelper.displayErrorMessage(MessageHelper.messages["ERROR_GUEST_USER_SUBMIT_RECURRING_ORDER"]);return false;}}}return true;},updateCartWithQuickCheckoutProfile:function(quickOrderId){var params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;
params["langId"]=this.langId;params.toOrderId=".";params["shippingAddressFromOrderProfile"]="1";params["shippingModeFromOrderProfile"]="1";params["URL"]="dummy";params["payInfoFrom"]=quickOrderId;wc.service.declare({id:"QuickCheckOutOrderCopy",actionId:"QuickCheckOutOrderCopy",url:"AjaxOrderCopy",successHandler:function(serviceResponse){cursor_clear();
document.location.href="OrderProcessServiceOrderPrepare?storeId="+CheckoutHelperJS.storeId+"&catalogId="+CheckoutHelperJS.catalogId+"&langId="+CheckoutHelperJS.langId+"&orderId=.&URL=OrderShippingBillingView?langId="+CheckoutHelperJS.langId+"&storeId="+CheckoutHelperJS.storeId+"&catalogId="+CheckoutHelperJS.catalogId+"&quickCheckoutProfileForPayment=true";
},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage);}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey);}}cursor_clear();}});if(!submitRequest()){return;}cursor_wait();
wc.service.invoke("QuickCheckOutOrderCopy",params);},addNewShippingAddress:function(addressType){this.displayAddressDetails(-1,addressType);},updateAddressForAllItems:function(addressSelectBox){if(addressSelectBox.value!=-1){this.selectedAddressesArray[addressSelectBox.name]=addressSelectBox.value;}if(!this.isAjaxCheckOut()){return;
}var addressId=addressSelectBox.value;if(addressId==-1){return;}params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";
params.check="*n";var addressId=document.getElementById("singleShipmentAddress").value;this.updateParamObject(params,"addressId",addressId,false);if(typeof updateGiftRegistrantAddressForItemsExt!="undefined"&&typeof updateGiftRegistrantAddressForItemsExt!=null){params=updateGiftRegistrantAddressForItemsExt(params,addressId);
}var enabledShipInstructions=false;var shipInstructions;if(document.getElementById("shipInstructions")!=null){shipInstructions=document.getElementById("shipInstructions").value;reWhiteSpace=new RegExp(/^\s+$/);if(reWhiteSpace.test(shipInstructions)){shipInstructions="";}enabledShipInstructions=true;}if(!submitRequest()){return;
}cursor_wait();if(!enabledShipInstructions||shipInstructions==undefined||shipInstructions==""){wc.service.invoke("OrderItemAddressShipMethodUpdate",params);}else{wc.service.invoke("OrderItemAddressShipInstructionsUpdate",params);}},setAddressId:function(addressId){this.varAddressId=addressId;},getAddressId:function(){return this.varAddressId;
},updateShipModeOnLoadForAllItems:function(shipModeId){var shpModeRadioButtons=document.getElementsByName("shippingModeOption");for(i=0;i<shpModeRadioButtons.length;i++){if(shpModeRadioButtons[i].checked){shpMode=shpModeRadioButtons[i].id;shpMode=shpMode.replace("shippingModeOption_","");shipModeId=shpMode;
}}if(shipModeId==-1){return;}params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";this.updateParamObject(params,"shipModeId",shipModeId,false);
cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate",params);},mattelUpdateAddressForAllItems:function(addressSelectBox,fetchShipModeId){var Obj1=document.getElementsByName("shippingAddressBoxDiv");if($(Obj1)){$(Obj1).removeClass("main");}if(null!=addressSelectBox&&undefined!=addressSelectBox){var addressId=addressSelectBox.id;
addressId=addressId.replace("shippingAddress_","");if(addressId==-1){return;}var divName="shippingAddressDiv_"+addressId;Obj2=document.getElementById(divName);if($(Obj2)){$(Obj2).addClass("main");}params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;
params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7,-22";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";this.setAddressId(addressId);SubmitShippingAddressFormJS.setDefaultAddId(addressId);this.updateParamObject(params,"addressId",addressId,false);if(typeof updateGiftRegistrantAddressForItemsExt!="undefined"&&typeof updateGiftRegistrantAddressForItemsExt!=null){params=updateGiftRegistrantAddressForItemsExt(params,addressId);
}cursor_wait();console.log("Calling service for mattelUpdateAddressForAllItems for Address ID: "+addressId);wc.service.invoke("OrderItemAddressUpdate",params);}else{console.error("addressSelectBox is null or undefined");}},mattelGiftReceiptEnclosure:function(addressId,orderId){var params=[];params.addressId=addressId;
params.orderId=orderId;params.action="giftReceiptUpdate";wc.service.invoke("AjaxShippingDetailsAdd",params);return;},mattelGetShipModesForZipCode:function(zipCode){if(zipCode!=""){console.debug("zipCode: "+zipCode);wc.render.updateContext("MattelSingleShipmentShipModes_Context",{"zipCode":zipCode,"addressId":"N/A","orderId":orderId});
}},updateShipModeForAllItems:function(shipmentSelectBox){var shipModeId=shipmentSelectBox.id;shipModeId=shipModeId.replace("shippingModeOption_","");if(shipModeId==-1){return;}params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";
params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";this.updateParamObject(params,"shipModeId",shipModeId,false);cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate",params);},updateShippingInstructionsForAllItems:function(){if(!this.isAjaxCheckOut()){return;
}params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";var orderItemId=null;var shipInstructions=document.getElementById("shipInstructions").value;reWhiteSpace=new RegExp(/^\s+$/);if(reWhiteSpace.test(shipInstructions)){shipInstructions="";
}if(!MessageHelper.isValidUTF8length(shipInstructions,4000)){MessageHelper.formErrorHandleClient(document.getElementById("shipInstructions").id,MessageHelper.messages["ERROR_ShippingInstructions_TooLong"]);return;}orderItemId=document.getElementById("orderItem_1").value;this.updateParamObject(params,"orderItemId",orderItemId,false);
this.updateParamObject(params,"shipInstructions",shipInstructions,false);if(!submitRequest()){return;}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params);},updateShippingChargeForShipModeAjax:function(curOrderId,shipModeId,shipChargeType,shipAcctNum){if(!this.isAjaxCheckOut()){return;}params=[];
params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=curOrderId;params.URL="";params["shipModeId"]=shipModeId;params["shipChargTypeId"]=shipChargeType;if(shipAcctNum!=null&&shipAcctNum!=undefined){params["shipCarrAccntNum"]=shipAcctNum;}else{params["shipCarrAccntNum"]="";
}if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxOrderShipChargeUpdate",params);},updateShippingChargeForShipMode:function(myForm){if(this.isAjaxCheckOut()){return;}myForm.URL.value="OrderProcessServiceOrderPrepare?storeId="+CheckoutHelperJS.storeId+"&catalogId="+CheckoutHelperJS.catalogId+"&langId="+CheckoutHelperJS.langId+"&orderId=.&URL=OrderShippingBillingView?forceShipmentType=2";
myForm.submit();},hideShipChargeAccountField:function(selectValue,acctFieldId){if(document.getElementById(selectValue).value.indexOf("ByCarrier")>-1){document.getElementById(acctFieldId).style.display="block";}else{document.getElementById(acctFieldId).style.display="none";}},updateRequestedShipDate:function(jsDate){if(jsDate==null||jsDate.getDisplayedValue()==null){return;
}var now=new Date();var checkbox=dojo.byId("requestShippingDateCheckbox");if(checkbox.checked&&jsDate.compare(jsDate.getValue(),now)<=0){if(document.getElementById("requestedShippingDate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("requestedShippingDate").id,MessageHelper.messages["REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR"]);
}else{MessageHelper.displayErrorMessage(MessageHelper.messages["REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR"]);}return;}if(!this.isAjaxCheckOut()){return;}var t="";if(jsDate.getDisplayedValue()!=""){t=dojo.date.stamp.fromISOString(jsDate);t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true});
}else{if(jsDate.getDisplayedValue()==""){t=this.resetRequestedShipDateValue;}}jsDate._close();this.updateShippingDateForAllItems(t);},updateShippingDateForAllItems:function(date){params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";
params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";this.updateParamObject(params,"requestedShipDate",date,false);if(!submitRequest()){return;}cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate",params);},displayAddressDetails:function(addressSelectBoxValue,addressType){if(!this.isAjaxCheckOut()){this.displayAddressDetailsWeb10(addressSelectBoxValue,addressType);
}else{if(addressSelectBoxValue!=-1){if(!submitRequest()){return;}var checkForOpera=true;cursor_wait(checkForOpera);wc.render.updateContext("shippingAddressContext",{"shippingAddress":addressSelectBoxValue});}else{this.createAddress(-1,addressType);}}},displayAddressDetailsWeb10:function(addressSelectBoxValue,addressType){var selectedAddressId=addressSelectBoxValue;
var addressSelectBox=dojo.byId("singleShipmentAddress");for(j=0;j<addressSelectBox.options.length;j++){if(addressSelectBox.options[j].value==selectedAddressId){dojo.byId("addressDetails_"+addressSelectBox.options[j].value).style.display="block";}else{dojo.byId("addressDetails_"+addressSelectBox.options[j].value).style.display="none";
}}if(selectedAddressId==-1){this.createAddress(-1,addressType);}},initDojoEventListenerSingleShipmentPage:function(){var totalItems=document.getElementById("totalNumberOfItems").value;if(totalItems!=null&&totalItems>0){if(dojo.byId("singleShipmentAddress")!=null){dojo.connect(dojo.byId("singleShipmentAddress"),"onchange",setDirtyFlag);
}if(dojo.byId("WC_ShippingAddressSelectSingle_div_2")!=null){dojo.connect(dojo.byId("WC_ShippingAddressSelectSingle_div_2"),"onclick",setDirtyFlag);}if(dojo.byId("singleShipmentShippingMode")!=null){dojo.connect(dojo.byId("singleShipmentShippingMode"),"onchange",setDirtyFlag);}if(dojo.byId("shipAsComplete")!=null){dojo.connect(dojo.byId("shipAsComplete"),"onclick",setDirtyFlag);
}if(dojo.byId("shippingInstructionsCheckbox")!=null){dojo.connect(dojo.byId("shippingInstructionsCheckbox"),"onclick",setDirtyFlag);}if(dojo.byId("requestShippingDateCheckbox")!=null){dojo.connect(dojo.byId("requestShippingDateCheckbox"),"onclick",setDirtyFlag);}if(dojo.byId("shipInstructions")!=null){dojo.connect(dojo.byId("shipInstructions"),"onchange",setDirtyFlag);
}if(dojo.byId("expediteShipping")!=null){dojo.connect(dojo.byId("expediteShipping"),"onchange",setDirtyFlag);}if(dojo.byId("expediteShipping_1")!=null){for(var i=0;i<totalItems;i++){if(dojo.byId("qty_"+(i+1))!=null&&dojo.byId("qty_"+(i+1)).value!="-1"){var object=dojo.byId("expediteShipping_"+(i+1));
dojo.connect(object,"onchange",setDirtyFlag);}}}}else{console.debug("error: element 'totalNumberOfItems' was expected but undefined.");return;}},updateSingleShipmentShoppingCart:function(form){var formAction="OrderChangeServiceShipInfoUpdate?";var updateShippingURL="OrderChangeServiceShipInfoUpdate?";
var instructions=null;var t=null;if(dojo.byId("shippingInstructionsCheckbox")!=null){if(dojo.byId("shippingInstructionsCheckbox").checked){if(document.getElementById("shipInstructions")!=null&&document.getElementById("shipInstructions").value!=null){if(MessageHelper.isValidUTF8length(document.getElementById("shipInstructions").value,4000)){instructions=document.getElementById("shipInstructions").value;
}else{MessageHelper.formErrorHandleClient(document.getElementById("shipInstructions").id,MessageHelper.messages["ERROR_ShippingInstructions_TooLong"]);return;}}}else{if(document.getElementById("shipInstructions")!=null){instructions="";}}}if(dojo.byId("requestShippingDateCheckbox")!=null){var jsDateObj=dijit.byId("requestedShippingDate");
if(dojo.byId("requestShippingDateCheckbox").checked){if(jsDateObj!=null&&jsDateObj.getDisplayedValue()!=null){var now=new Date();if(jsDateObj.compare(jsDateObj.getValue(),now)<=0){if(document.getElementById("requestedShippingDate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("requestedShippingDate").id,MessageHelper.messages["REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR"]);
}else{MessageHelper.displayErrorMessage(MessageHelper.messages["REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR"]);}return;}var t="";if(jsDateObj.getDisplayedValue()!=""){t=dojo.date.stamp.fromISOString(jsDateObj);t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true});
}else{if(jsDateObj.getDisplayedValue()==""){t=this.resetRequestedShipDateValue;}}}}else{if(jsDateObj!=null){t=this.resetRequestedShipDateValue;}}}if(document.getElementById("singleShipmentAddress").value!=-1){updateShippingURL=updateShippingURL+"addressId="+document.getElementById("singleShipmentAddress").value;
}else{MessageHelper.formErrorHandleClient(document.getElementById("singleShipmentAddress").id,MessageHelper.messages["SHIPPING_INVALID_ADDRESS"]);return;}formAction=formAction+"shipModeId="+document.getElementById("singleShipmentShippingMode").value;if(this.shipChargeEnabled){formAction=formAction+"&shippingChargeType="+document.getElementById("shipChargTypeId_1").value;
formAction=formAction+"&shipCarrAccntNum="+document.getElementById("shipCarrAccntNum_1").value;}var shipInstructions="";if(instructions!=null){shipInstructions="shipInstructions%3D"+instructions+"%26orderItemId_1%3D"+document.getElementById("orderItem_1").value;}if(t!=null){formAction=formAction+"&requestedShipDate="+t;
}if(dojo.byId("shipAsComplete")!=null){if(dojo.byId("shipAsComplete").checked){formAction=formAction+"&ShipAsComplete=Y";}else{formAction=formAction+"&ShipAsComplete=N";}}if(document.getElementById("expediteShipping_1")!=null){var totalNumberOfItemsOnPage=document.getElementById("totalNumberOfItems").value;
for(var i=0;i<totalNumberOfItemsOnPage;i++){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!="-1"){var orderItemId=document.getElementById("orderItem_"+(i+1)).value;if(document.getElementById("orderItemId_"+(i+1))!=null){document.getElementById("orderItemId_"+(i+1)).value=orderItemId;
}var object=document.getElementById("expediteShipping_"+(i+1));if(object.checked){document.getElementById("isExpedited_"+(i+1)).value="Y";}else{document.getElementById("isExpedited_"+(i+1)).value="N";}}}}form.action=formAction;var beginIndex=wc.render.getContextById("traditionalShipmentDetailsContext").properties["beginIndex"];
if(beginIndex==null||beginIndex==""){beginIndex=0;}form.URL.value=updateShippingURL+"&requestedShipDate*=&shipModeId*=&orderItemId*=&URL=OrderChangeServiceShipInfoUpdate%3F"+shipInstructions+"%26allocate%3D***%26backorder%3D***%26remerge%3D***%26check%3D*n"+"%26URL%3DOrderShippingBillingView%3F%26beginIndex%3D"+beginIndex;
if(!submitRequest()){return;}form.submit();},moveAllItemsToSingleShipment:function(){var orderItemId=document.getElementById("orderItem_1").value;var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;
params["langId"]=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";if(addressId==-3){var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=2;i<=totalItems;i++){if(document.getElementById("orderItem_"+i)!=null&&document.getElementById("orderItem_"+i)!="undefined"){var giftOrderItemId=document.getElementById("orderItem_"+i).value;
var validAddressId=document.getElementById("MS_ShipmentAddress_"+giftOrderItemId).value;if(validAddressId!=-3){this.updateParamObject(params,"addressId",validAddressId,false);break;}}else{break;}}}else{this.updateParamObject(params,"addressId",addressId,false);}if(!submitRequest()){return;}cursor_wait();
wc.service.invoke("OrderItemAddressShipMethodUpdate1",params);},addNewShippingAddressForMS:function(orderItemId){this.updateAddressIdForThisItem(-1,orderItemId);this.orderItemIds.push(orderItemId);},mattelAddNewShippingAddressForMS:function(addressId,orderItemId,url){if(addressId=="addAddress"){var idObj="#MS_ShipmentAddress_"+orderItemId;
var divClone=$(idObj).clone();$.v_modal({transition:"fade",href:url,originalDiv:divClone,originalDivId:idObj,onComplete:function(){Mattel.init();$(this).v_modal.resize();}});Mattel.init();}else{this.updateAddressIdForThisItem(addressId,orderItemId);this.orderItemIds.push(orderItemId);}},updateAddressIdForThisItem:function(addressBoxValue,orderItemId){if(addressBoxValue!=-1){var addressBox=dojo.byId("MS_ShipmentAddress_"+orderItemId);
if(addressBox){this.selectedAddressesArray[addressBox.name]=addressBoxValue;}}if(addressBoxValue==-1){return;}paramsObj=[];paramsObj["storeId"]=this.storeId;paramsObj["catalogId"]=this.catalogId;paramsObj["langId"]=this.langId;paramsObj.orderId=".";paramsObj.calculationUsage="-1,-2,-3,-4,-5,-6,-7,-22";
paramsObj.allocate="***";paramsObj.backorder="***";paramsObj.remerge="***";paramsObj.check="*n";this.shipmentTypeId="2";var addressId=addressBoxValue;this.setAddressId(addressId);var shipModeObj=dojo.byId("add_"+addressId);if(shipModeObj!=undefined&&shipModeObj!=null){var shipMode=shipModeObj.value.replace("shippingModeOption_","");
console.info("shipMode: "+shipMode);}this.updateParamObject(paramsObj,"shipToRegistrant","0",false,-1);this.updateParamObject(paramsObj,"addressId",addressId,false,-1);this.updateParamObject(paramsObj,"orderItemId",orderItemId,false,-1);if(shipMode!=undefined&&shipMode!=null){this.updateParamObject(paramsObj,"shipModeId",shipMode,false,-1);
}var giftOptions=document.getElementById("gift_oid_"+orderItemId);var addOns=document.getElementById("addon_oid_"+orderItemId);var wcsSet=document.getElementById("setComponents_"+orderItemId);if(giftOptions!=null&&giftOptions!=undefined){var arr1=giftOptions.value.split(",");for(i=0;i<arr1.length;i++){if(!this.isEmpty(arr1[i])){this.updateParamObject(paramsObj,"orderItemId",arr1[i],false,-1);
this.updateParamObject(paramsObj,"addressId",addressId,false,-1);if(shipMode!=undefined&&shipMode!=null){this.updateParamObject(paramsObj,"shipModeId",shipMode,false,-1);}}}}if(addOns!=null&&addOns!=undefined){var arr2=addOns.value.split(",");for(i=0;i<arr2.length;i++){if(!this.isEmpty(arr2[i])){this.updateParamObject(paramsObj,"orderItemId",arr2[i],false,-1);
this.updateParamObject(paramsObj,"addressId",addressId,false,-1);if(shipMode!=undefined&&shipMode!=null){this.updateParamObject(paramsObj,"shipModeId",shipMode,false,-1);}}}}if(wcsSet!=null&&wcsSet!=undefined&&wcsSet.value!=""){var arr3=wcsSet.value.split(",");for(i=0;i<arr3.length;i++){this.updateParamObject(paramsObj,"orderItemId",arr3[i],false,-1);
this.updateParamObject(paramsObj,"addressId",addressId,false,-1);if(shipMode!=undefined&&shipMode!=null){this.updateParamObject(paramsObj,"shipModeId",shipMode,false,-1);}}}CheckoutHelperJS.procesShipmentType=2;cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate",paramsObj);},updateShipModeForSubOrder:function(subOrderId,shipMode){var tempObj="AllOrderItemsMap_"+subOrderId;
var subOrderCount=document.getElementById("counter_"+subOrderId).value;var orderItemsList=document.getElementById(tempObj).value;this.mattelSubOrderID=subOrderId;this.mattelSubOrderCount=subOrderCount;var arr1=new Array();console.info("orderItemsList: "+orderItemsList);arr1=orderItemsList.split(",");
this.orderItemArr=arr1;this.orderItemCounter=0;this.orderItemArrLength=arr1.length;shipMode=shipMode.value;shipMode=shipMode.replace("shippingModeOption_","");this.shipModeId=shipMode;this.updateShipModeForSubOrderItems(shipMode,orderItemsList);},updateShipModeForSubOrderItems:function(shipModeId,orderItemsList){if(shipModeId==-1){return;
}params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";var arr3=new Array();arr3=orderItemsList.split(",");for(i=0;i<arr3.length;i++){var orderItemId=arr3[i];console.info("orderItemId: "+orderItemId);this.updateParamObject(params,"orderItemId",orderItemId,false,-1);
this.updateParamObject(params,"shipModeId",shipModeId,false,-1);var giftOptions=document.getElementById("gift_oid_"+orderItemId);var addOns=document.getElementById("addon_oid_"+orderItemId);if(giftOptions!=null&&giftOptions!=undefined){var arr1=giftOptions.value.split(",");for(j=0;j<arr1.length;j++){if(!this.isEmpty(arr1[j])){this.updateParamObject(params,"orderItemId",arr1[j],false,-1);
this.updateParamObject(params,"shipModeId",shipModeId,false,-1);}}}if(addOns!=null&&addOns!=undefined){var arr2=addOns.value.split(",");for(k=0;k<arr2.length;k++){if(!this.isEmpty(arr2[k])){this.updateParamObject(params,"orderItemId",arr2[k],false,-1);this.updateParamObject(params,"shipModeId",shipModeId,false,-1);
}}}}params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdateMS",params);},updateShipModeForThisItem:function(shipModeId,orderItemId){if(shipModeId==-1){return;}params=[];
params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"shipModeId",shipModeId,false,-1);var giftOptions=document.getElementById("gift_oid_"+orderItemId);
var addOns=document.getElementById("addon_oid_"+orderItemId);if(giftOptions!=null&&giftOptions!=undefined){var arr1=giftOptions.value.split(",");for(i=0;i<arr1.length;i++){if(!this.isEmpty(arr1[i])){this.updateParamObject(params,"orderItemId",arr1[i],false,-1);this.updateParamObject(params,"shipModeId",shipModeId,false,-1);
}}}if(addOns!=null&&addOns!=undefined){var arr2=addOns.value.split(",");for(i=0;i<arr2.length;i++){if(!this.isEmpty(arr2[i])){this.updateParamObject(params,"orderItemId",arr2[i],false,-1);this.updateParamObject(params,"shipModeId",shipModeId,false,-1);}}}params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";
params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdateMS",params);},updateShippingInstructionsForThisItem:function(textArea,orderItemId){var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;
var shipModeId=document.getElementById("MS_ShippingMode_"+orderItemId).value;var shipInstructions=textArea.value;reWhiteSpace=new RegExp(/^\s+$/);if(reWhiteSpace.test(shipInstructions)){shipInstructions="";}if(this.isAjaxCheckOut()){if(!MessageHelper.isValidUTF8length(shipInstructions,4000)){MessageHelper.formErrorHandleClient(textArea.id,MessageHelper.messages["ERROR_ShippingInstructions_TooLong"]);
return;}}this.setShippingInstuctionsForAllOtherItems(addressId,shipModeId,shipInstructions);if(!this.isAjaxCheckOut()){return;}params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";this.updateParamObject(params,"addressId",addressId,false,-1);
this.updateParamObject(params,"shipModeId",shipModeId,false,-1);this.updateParamObject(params,"shipInstructions",shipInstructions,false,-1);this.updateParamObject(params,"orderItemId",orderItemId,false,-1);if(!submitRequest()){return;}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params);
},updateRequestedShipDateForThisItem:function(jsDate,orderItemId){if(jsDate==null||jsDate.getDisplayedValue()==null){return;}var now=new Date();var checkbox=dojo.byId("MS_requestShippingDateCheckbox_"+orderItemId);if(checkbox.checked&&jsDate.compare(jsDate.getValue(),now)<=0){if(document.getElementById("MS_requestedShippingDate_"+orderItemId)!=null){MessageHelper.formErrorHandleClient(document.getElementById("MS_requestedShippingDate_"+orderItemId).id,MessageHelper.messages["REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR"]);
}else{MessageHelper.displayErrorMessage(MessageHelper.messages["REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR"]);}return;}if(!this.isAjaxCheckOut()){return;}var t="";if(jsDate.getDisplayedValue()!=""){t=dojo.date.stamp.fromISOString(jsDate);t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true});
}else{if(jsDate.getDisplayedValue()==""){t=this.resetRequestedShipDateValue;}}jsDate._close();var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;var shipModeId=document.getElementById("MS_ShippingMode_"+orderItemId).value;params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;
params["langId"]=this.langId;params.orderId=".";this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"requestedShipDate",t,false,-1);params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";
if(!submitRequest()){return;}cursor_wait();CheckoutHelperJS.RequestShippingDateAction=true;wc.service.invoke("OrderItemAddressShipMethodUpdate",params);},createAddressForMS:function(orderItemId,addressType){if(!submitRequest()){return;}cursor_wait();wc.render.updateContext("editShippingAddressContext",{"shippingAddress":"-1","addressType":addressType});
this.showHideDivs("editAddressContents","mainContents");},displayAddressDetailsForMSHelper:function(orderItemId,addressType){this.displayAddressDetailsForMS(-1,orderItemId,addressType);},displayAddressDetailsForMS:function(addressSelectBoxValue,orderItemId,addressType){if(this.isAjaxCheckOut()){if(addressSelectBoxValue==-1){this.createAddressForMS(orderItemId,addressType);
}}else{if(addressSelectBoxValue==-1){this.createAddressForMS(orderItemId,addressType);}else{dojo.byId("MS_shippingAddressDisplayArea_"+orderItemId).innerHTML=dojo.byId("addressDetails_"+addressSelectBoxValue).innerHTML;}}},initDojoEventListenerMultiShipmentPage:function(){var totalItems=document.getElementById("totalNumberOfItems").value;
if(totalItems!=null&&totalItems>0){var list_clickable=new dojox.collections.ArrayList([]);var list_editable=new dojox.collections.ArrayList([]);for(var i=0;i<totalItems;i++){var orderItemId=document.getElementById("orderItem_"+(i+1)).value;var object="";if(orderItemId!=null){object=dojo.byId("MS_shippingInstructionsCheckbox_"+orderItemId);
if(object!=null){list_clickable.add(object);}object=dojo.byId("MS_requestShippingDateCheckbox_"+orderItemId);if(object!=null){list_clickable.add(object);}object=dojo.byId("shipAsComplete");if(object!=null){list_clickable.add(object);}object=dojo.byId("editAddressButton");if(object!=null){list_clickable.add(object);
}object=dojo.byId("MS_expediteShipping_"+orderItemId);if(object!=null){list_clickable.add(object);}object=dojo.byId("MS_ShipmentAddress_"+orderItemId);if(object!=null){list_editable.add(object);}object=dojo.byId("MS_ShippingMode_"+orderItemId);if(object!=null){list_editable.add(object);}object=dojo.byId("MS_shipInstructions_"+orderItemId);
if(object!=null){list_editable.add(object);}object=dojo.byId("qty_"+(i+1));if(object!=null){list_editable.add(object);}}else{var j=i+1;console.debug("error: element 'orderItem_'"+j+" was expected but undefined.");}}for(var i=0;i<list_clickable.count;i++){var item=list_clickable.item(i);dojo.connect(item,"onclick",setDirtyFlag);
}for(var i=0;i<list_editable.count;i++){var item=list_editable.item(i);dojo.connect(item,"onchange",setDirtyFlag);}}else{console.debug("error: element 'totalNumberOfItems' was expected but undefined.");return;}},updateMultiShipmentShoppingCart:function(form){var updateShippingAction="OrderChangeServiceShipInfoUpdate";
var updateShippingURL="OrderShippingBillingView?";var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){var orderItemId=document.getElementById("orderItem_"+(i+1)).value;if(document.getElementById("orderItemId_"+(i+1))!=null){document.getElementById("orderItemId_"+(i+1)).value=orderItemId;
}var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;if(addressId!=-1){if(document.getElementById("addressId_"+(i+1))!=null){document.getElementById("addressId_"+(i+1)).value=addressId;}}else{MessageHelper.formErrorHandleClient(document.getElementById("MS_ShipmentAddress_"+orderItemId).id,MessageHelper.messages["SHIPPING_INVALID_ADDRESS"]);
return;}if(form.elements["shipModeId_"+(i+1)]!=null){form.elements["shipModeId_"+(i+1)].value=document.getElementById("MS_ShippingMode_"+orderItemId).value;}var instructions=null;var t=null;var shippingInstructionsCheckbox=dojo.byId("MS_shippingInstructionsCheckbox_"+orderItemId);if(shippingInstructionsCheckbox!=null){if(shippingInstructionsCheckbox.checked){if(document.getElementById("MS_shipInstructions_"+orderItemId)!=null&&document.getElementById("MS_shipInstructions_"+orderItemId).value!=null){if(MessageHelper.isValidUTF8length(document.getElementById("MS_shipInstructions_"+orderItemId).value,4000)){instructions=document.getElementById("MS_shipInstructions_"+orderItemId).value;
}else{MessageHelper.formErrorHandleClient(document.getElementById("MS_shipInstructions_"+orderItemId).id,MessageHelper.messages["ERROR_ShippingInstructions_TooLong"]);return;}}}else{if(document.getElementById("MS_shipInstructions_"+orderItemId)!=null){instructions="";}}}var requestShippingDateCheckbox=dojo.byId("MS_requestShippingDateCheckbox_"+orderItemId);
if(requestShippingDateCheckbox!=null){t=this.resetRequestedShipDateValue;var jsDateObj=dijit.byId("MS_requestedShippingDate_"+orderItemId);if(requestShippingDateCheckbox.checked){if(jsDateObj!=null&&jsDateObj.getDisplayedValue()!=null){var now=new Date();if(jsDateObj.compare(jsDateObj.getValue(),now)<=0){if(document.getElementById("MS_requestedShippingDate_"+orderItemId)!=null){MessageHelper.formErrorHandleClient(document.getElementById("MS_requestedShippingDate_"+orderItemId).id,MessageHelper.messages["REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR"]);
}else{MessageHelper.displayErrorMessage(MessageHelper.messages["REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR"]);}return;}var t="";if(jsDateObj.getDisplayedValue()!=""){t=dojo.date.stamp.fromISOString(jsDateObj);t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true});
}else{if(jsDateObj.getDisplayedValue()==""){t=this.resetRequestedShipDateValue;}}}}else{if(jsDateObj!=null){t=this.resetRequestedShipDateValue;}}}if(instructions!=null){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){if(document.getElementById("shipInstructions_"+(i+1))!=null){document.getElementById("shipInstructions_"+(i+1)).value=instructions;
}}}if(t!=null){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){if(document.getElementById("requestedShipDate_"+(i+1))!=null){document.getElementById("requestedShipDate_"+(i+1)).value=t;}}}if(document.getElementById("MS_expediteShipping_"+orderItemId)!=null&&document.getElementById("isExpedited_"+(i+1))!=null){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){if(document.getElementById("MS_expediteShipping_"+orderItemId).checked){document.getElementById("isExpedited_"+(i+1)).value="Y";
}else{document.getElementById("isExpedited_"+(i+1)).value="N";}}}}var checkBox=document.getElementById("shipAsComplete");if(document.getElementById("ShipAsComplete")!=null){if(checkBox.checked){document.getElementById("ShipAsComplete").value="Y";}else{document.getElementById("ShipAsComplete").value="N";
}}updateShippingURL=updateShippingURL+"orderItemId*=";updateShippingURL=updateShippingURL+"&quantity*=";updateShippingURL=updateShippingURL+"&addressId*=";updateShippingURL=updateShippingURL+"&shipModeId*=";updateShippingURL=updateShippingURL+"&shipInstructions*=";updateShippingURL=updateShippingURL+"&requestedShipDate*=";
updateShippingURL=updateShippingURL+"&isExpedited*=";updateShippingURL=updateShippingURL+"&ShipAsComplete*=";updateShippingURL=updateShippingURL+"&orderItem*=";updateShippingURL=updateShippingURL+"&MS_ShipmentAddress*=";updateShippingURL=updateShippingURL+"&MS_ShippingMode*=";updateShippingURL=updateShippingURL+"&MS_shippingInstructionsCheckbox*=";
updateShippingURL=updateShippingURL+"&MS_shipInstructions*=";updateShippingURL=updateShippingURL+"&MS_requestShippingDateCheckbox*=";updateShippingURL=updateShippingURL+"&MS_requestedShippingDate*=";updateShippingURL=updateShippingURL+"&MS_expediteShipping*=";updateShippingURL=updateShippingURL+"&qty*=";
updateShippingURL=updateShippingURL+"&shipAsComplete*=";var beginIndex=wc.render.getContextById("multipleShipmentDetailsContext").properties["beginIndex"];if(beginIndex==null||beginIndex==""){beginIndex=0;}updateShippingURL=updateShippingURL+"&beginIndex="+beginIndex;form.action=updateShippingAction;
form.URL.value=updateShippingURL;if(!submitRequest()){return;}form.submit();},showHideEditAddressLink:function(addressSelectBox,orderItemId){if(addressSelectBox.value=="-3"){if(dojo.byId("editAddressLink_"+orderItemId)!=null&&dojo.byId("editAddressLink_"+orderItemId)!="undefined"){dojo.byId("editAddressLink_"+orderItemId).style.display="none";
}return;}var orgAddressList=document.getElementById("shippingOrganizationAddressList");if(orgAddressList){var orgAddressArray=[];orgAddressArray=orgAddressList.value.toString().split(",");for(var i=0;i<orgAddressArray.length;i++){if(dojo.byId("editAddressLink_"+orderItemId)!=null&&dojo.byId("editAddressLink_"+orderItemId)!="undefined"){if(addressSelectBox.value==orgAddressArray[i]){dojo.byId("editAddressLink_"+orderItemId).style.display="none";
break;}else{dojo.byId("editAddressLink_"+orderItemId).style.display="block";}}}}else{if(dojo.byId("editAddressLink_"+orderItemId)!=null&&dojo.byId("editAddressLink_"+orderItemId)!="undefined"){dojo.byId("editAddressLink_"+orderItemId).style.display="block";}}},showHideEditBillingAddressLink:function(addressSelectBox,orderItemId,paymentAreaNumber){if(addressSelectBox.value=="-2"){dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";
return;}var orgAddressList=document.getElementById("shippingOrganizationAddressList");if(orgAddressList){var orgAddressArray=[];orgAddressArray=orgAddressList.value.toString().split(",");for(var i=0;i<orgAddressArray.length;i++){if(dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!=null&&dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!="undefined"){if(addressSelectBox.value==orgAddressArray[i]){dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";
break;}else{dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="block";}}}}else{if(dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!=null&&dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!="undefined"){dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";
}}},setOrderId:function(orderId){this.orderId=orderId;},getOrderId:function(){return this.orderId;},showHideCreateBillingAddressLink:function(addressSelectBox,orderItemId,paymentAreaNumber){if(addressSelectBox.value=="-2"){dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";
return;}var orgAddressList=document.getElementById("shippingOrganizationAddressList");if(orgAddressList){var orgAddressArray=[];orgAddressArray=orgAddressList.value.toString().split(",");for(var i=0;i<orgAddressArray.length;i++){if(dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!=null&&dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!="undefined"){if(addressSelectBox.value==orgAddressArray[i]){dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";
break;}else{dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="block";}}}}else{if(dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!=null&&dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!="undefined"){dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";
}}},getShippingMode:function(selectBox){if(dojo.isString(selectBox)){selectBox=dojo.byId(selectBox);}var option=null;for(var i=0;i<selectBox.options.length;i++){if(selectBox[i].selected){option=selectBox[i];}}if(option){return{"id":option.value,"code":option.getAttribute("shipModeCode"),"description":option.text};
}},cartCatEntryId:null,cartQuantity:null,cartOrderItemId:null,splitItem:false,splitItemSequence:null,giftCardType:"",cartChildCatentries:null,setCartSplitCommonParameter:function(catEntryId,quantity,giftCardType){this.cartCatEntryId=catEntryId;this.cartQuantity=quantity;this.giftCardType=giftCardType;
},wcsStaticSetQtyUpdateSplit:function(orderItemId,catEntryId,quantityBox,giftCardType,event){var quantity=(quantityBox.value);console.info("quantity: "+quantity);if(!isNonNegativeInteger(quantity)){MessageHelper.mattelQtyFormErrorHandleClient(MessageHelper.messages["QUANTITY_INPUT_ERROR"],orderItemId);
}else{if(this.currentQty==quantity){console.debug("Same Quantity");return;}else{if(quantity=="0"||quantity==0){ServicesEventMapping.setCartChangeEvent("cart_qty_update");this.updateCartWait(quantityBox,orderItemId,event);}else{this.splitCartLineItem(orderItemId,catEntryId,quantity,giftCardType,"wcsSet");
}}}},wcsStaticSetQtyUpdateSplitMS:function(orderItemId,catEntryId,quantityBox,addressId,subOrderId,giftCardType,event){var quantity=(quantityBox.value);console.info("quantity: "+quantity);if(!isNonNegativeInteger(quantity)){MessageHelper.mattelQtyFormErrorHandleClient(MessageHelper.messages["QUANTITY_INPUT_ERROR"],orderItemId);
return;}else{if(this.currentQty==quantity){console.debug("Same Quantity");return;}else{if(quantity=="0"||quantity==0){ServicesEventMapping.setCartChangeEvent("cart_qty_update");this.updateCartWait(quantityBox,orderItemId,event);}else{this.splitCartLineItemMS(orderItemId,catEntryId,quantity,addressId,subOrderId,giftCardType,"wcsSet");
}}}},splitCartLineItem:function(orderItemId,catEntryId,quantity,giftCardType,prodType){this.setCartSplitCommonParameter(catEntryId,quantity,giftCardType);if(orderItemId!=null){var childCatentries=document.getElementById("compChildCats_"+orderItemId);if(childCatentries!=null&&childCatentries!=undefined&&childCatentries.value!=""){this.cartChildCatentries=childCatentries.value;
}var params=[];params.orderId=".";params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params["mattelOrderType"]="Standard Orders";params["splitAction"]="splitUpdate";params["inventoryValidation"]="true|Standard Orders";params.calculateOrder="1";if(this.shoppingCartPage){params.calculationUsage="-1,-2,-5,-6,-7,-21";
params.inventoryValidation="true|Standard Orders";}else{params.calculationUsage="-1,-2,-3,-4,-5,-6,-7,-21";}this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"quantity","1",false,-1);cursor_wait();this.cartOrderItemId=orderItemId;var giftOptions=document.getElementById("gift_oid_"+orderItemId);
var addOns=document.getElementById("addon_oid_"+orderItemId);if(giftOptions!=null&&giftOptions!=undefined){var arr1=giftOptions.value.split(",");for(i=0;i<arr1.length;i++){if(!this.isEmpty(arr1[i])){this.updateParamObject(params,"orderItemId",arr1[i],false,-1);this.updateParamObject(params,"quantity","1",false,-1);
}}}if(addOns!=null&&addOns!=undefined){var arr2=addOns.value.split(",");for(i=0;i<arr2.length;i++){if(!this.isEmpty(arr2[i])){this.updateParamObject(params,"orderItemId",arr2[i],false,-1);this.updateParamObject(params,"quantity","1",false,-1);}}}var setComponents=document.getElementById("setComponents_"+orderItemId);
if(setComponents!=null&&setComponents!=undefined){var arr3=setComponents.value.split(",");for(i=0;i<arr3.length;i++){if(!this.isEmpty(arr3[i])){this.updateParamObject(params,"orderItemId",arr3[i],false,-1);this.updateParamObject(params,"quantity","1",false,-1);}}}if(giftOptions!=null||addOns!=null){this.splitItem=true;
ServicesEventMapping.setCartChangeEvent("cart_addon_split");console.info("prodType: "+prodType);if((null!=prodType)&&(undefined!=prodType)&&(prodType=="wcsSet")){ServicesEventMapping.setCartChangeEvent("cart_addon_split_set");}}wc.service.invoke("AjaxUpdateOrderItemForSplit",params);}},splitCartLineItemAdd:function(splitItemSequence,orderId){var ajaxShopCartService="AddOrderItemdForSplit";
var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-5,-6,-7";params.calculateOrder="1";params.mattelOrderType="Standard Orders";params["splitAction"]="splitAdd";console.info("Gift Card type :"+this.giftCardType);
params["orderId"]=orderId;params["splitItemSequence"]=splitItemSequence;params.inventoryValidation="true|Standard Orders";var childCatArr=null;if(this.cartChildCatentries!=null&&this.cartChildCatentries!=""){params["parentCatentryId"]=this.cartCatEntryId;params["childCatentryIdsForSet"]=this.cartChildCatentries;
params["actioncode"]="create";params["addItem"]=true;if(this.giftCardType=="GiftCardType"){params["giftTo"]=document.getElementById("toName_"+this.cartOrderItemId).value;params["giftFrom"]=document.getElementById("from_"+this.cartOrderItemId).value;params["giftToMessage1"]=document.getElementById("message1_"+this.cartOrderItemId).value;
params["giftToMessage2"]=document.getElementById("message2_"+this.cartOrderItemId).value;params["giftToMessage3"]=document.getElementById("message3_"+this.cartOrderItemId).value;params["userPrice"]=document.getElementById("ammount_"+this.cartOrderItemId).value;params["productoperationType"]="giftCard";
}else{params["productoperationType"]="wcsset";}childCatArr=this.cartChildCatentries.split("_");this.cartChildCatentries=null;var itemCount=0;if(childCatArr!=null){for(var j=0;j<this.cartQuantity-1;j++){params["catEntryId_"+itemCount]=this.cartCatEntryId;params["quantity_"+itemCount++]="1";for(var i=0;
i<childCatArr.length;i++){params["catEntryId_"+itemCount]=childCatArr[i];params["quantity_"+itemCount++]="1";}}}params["cartQuantity"]=(this.cartQuantity-1);}else{for(idx=0;idx<this.cartQuantity-1;idx++){params["catEntryId_"+idx]=this.cartCatEntryId;params["quantity_"+idx]="1";}}params["firstChildCatentryId"]=params["catEntryId_0"];
cursor_wait();wc.service.invoke(ajaxShopCartService,params);},splitCartLineItemAddServices:function(orderItemIds){var params=[];params.parentOrderItemId=this.cartOrderItemId;params.createdOIDelimited=orderItemIds;params.copyItemsOnSplit=true;wc.service.invoke("mattelAddOnServiceGiftOptionsSave",params);
},splitCartLineItemMS:function(orderItemId,catEntryId,quantity,addressId,subOrderId,giftCardType,prodType){this.setCartSplitCommonParameter(catEntryId,quantity,giftCardType);this.mattelAddressIdForOrderItemAdd=addressId;var selectElementObj=document.getElementsByName("shipModeSelect_"+subOrderId);var strShipModeId=selectElementObj[0].options[selectElementObj[0].selectedIndex].value.replace("shippingModeOption_","");
this.mattelShipModeIdForOrderItemAdd=strShipModeId;if(orderItemId!=null){console.debug("AddressId for Console: "+addressId);var childCatentries=document.getElementById("compChildCats_"+orderItemId);if(childCatentries!=null&&childCatentries!=undefined&&childCatentries.value!=""){this.cartChildCatentries=childCatentries.value;
}var params=[];params.orderId=".";params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params["mattelOrderType"]="Standard Orders";params["inventoryValidation"]="true|Standard Orders";params["splitAction"]="splitUpdate";if(this.shoppingCartPage){params.calculationUsage="-1,-2,-5,-6,-7";
params.inventoryValidation="true|Standard Orders";}else{params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";}this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"quantity","1",false,-1);cursor_wait();this.cartOrderItemId=orderItemId;var giftOptions=document.getElementById("gift_oid_"+orderItemId);
var addOns=document.getElementById("addon_oid_"+orderItemId);if(giftOptions!=null&&giftOptions!=undefined){var arr1=giftOptions.value.split(",");for(i=0;i<arr1.length;i++){if(!this.isEmpty(arr1[i])){console.info("arr1: "+arr1[i]);this.updateParamObject(params,"orderItemId",arr1[i],false,-1);this.updateParamObject(params,"quantity","1",false,-1);
}}}if(addOns!=null&&addOns!=undefined){var arr2=addOns.value.split(",");for(i=0;i<arr2.length;i++){if(!this.isEmpty(arr2[i])){console.info("arr2: "+arr2[i]);this.updateParamObject(params,"orderItemId",arr2[i],false,-1);this.updateParamObject(params,"quantity","1",false,-1);}}}var setComponents=document.getElementById("setComponents_"+orderItemId);
if(setComponents!=null&&setComponents!=undefined){var arr3=setComponents.value.split(",");for(i=0;i<arr3.length;i++){if(!this.isEmpty(arr3[i])){this.updateParamObject(params,"orderItemId",arr3[i],false,-1);this.updateParamObject(params,"quantity","1",false,-1);}}}if(giftOptions!=null||addOns!=null){this.splitItem=true;
ServicesEventMapping.setCartChangeEvent("cart_addon_split");console.info("prodType: "+prodType);if((null!=prodType)&&(undefined!=prodType)&&(prodType=="wcsSet")){ServicesEventMapping.setCartChangeEvent("cart_addon_split_set");}}wc.service.invoke("AjaxUpdateOrderItemForSplitMS",params);}},splitCartLineItemAddMS:function(splitItemSequence,orderId){var ajaxShopCartService="AddOrderItemdForSplit";
var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;console.debug("AddressId for new Item: "+this.mattelAddressIdForOrderItemAdd+" , shipModeId: "+this.mattelShipModeIdForOrderItemAdd);params.calculationUsage="-1,-2,-5,-6,-7";params.calculateOrder="1";params.mattelOrderType="Standard Orders";
params["splitAction"]="splitAdd";params["orderId"]=orderId;params["splitItemSequence"]=splitItemSequence;params.inventoryValidation="true|Standard Orders";params["fromPage"]="MattelMSOrderItemDetails";var childCatArr=null;if(this.cartChildCatentries!=null&&this.cartChildCatentries!=""){params["parentCatentryId"]=this.cartCatEntryId;
params["childCatentryIdsForSet"]=this.cartChildCatentries;params["actioncode"]="create";params["addItem"]=true;if(this.giftCardType=="GiftCardType"){params["giftTo"]=document.getElementById("toName_"+this.cartOrderItemId).value;params["giftFrom"]=document.getElementById("from_"+this.cartOrderItemId).value;
params["giftToMessage1"]=document.getElementById("message1_"+this.cartOrderItemId).value;params["giftToMessage2"]=document.getElementById("message2_"+this.cartOrderItemId).value;params["giftToMessage3"]=document.getElementById("message3_"+this.cartOrderItemId).value;params["userPrice"]=document.getElementById("ammount_"+this.cartOrderItemId).value;
params["productoperationType"]="giftCard";}else{params["productoperationType"]="wcsset";}childCatArr=this.cartChildCatentries.split("_");this.cartChildCatentries=null;var itemCount=0;params["catEntryId_"+itemCount]=this.cartCatEntryId;params["addressId_"+itemCount]=this.mattelAddressIdForOrderItemAdd;
params["shipModeId_"+itemCount]=this.mattelShipModeIdForOrderItemAdd;params["quantity_"+itemCount++]="1";if(childCatArr!=null){for(var i=0;i<childCatArr.length;i++){params["catEntryId_"+itemCount]=childCatArr[i];params["addressId_"+itemCount]=this.mattelAddressIdForOrderItemAdd;params["shipModeId_"+itemCount]=this.mattelShipModeIdForOrderItemAdd;
params["quantity_"+itemCount++]="1";}}params["cartQuantity"]=(this.cartQuantity-1);}else{for(idx=0;idx<this.cartQuantity-1;idx++){params["catEntryId_"+idx]=this.cartCatEntryId;params["addressId_"+idx]=this.mattelAddressIdForOrderItemAdd;params["shipModeId_"+idx]=this.mattelShipModeIdForOrderItemAdd;params["quantity_"+idx]="1";
}}params["firstChildCatentryId"]=params["catEntryId_0"];for(i in params){console.info(i+" : "+params[i]);}wc.service.invoke(ajaxShopCartService,params);},splitCartLineItemAddServicesMS:function(orderItemIds){var params=[];params.parentOrderItemId=this.cartOrderItemId;params.createdOIDelimited=orderItemIds;
params.fromPage="MattelMSOrderItemDetails";params.copyItemsOnSplit=true;wc.service.invoke("mattelAddOnServiceGiftOptionsSave",params);},processShippingCheckout:function(piFormName,skipOrderPrepare,shipmentType){if(skipOrderPrepare==undefined||skipOrderPrepare==null){skipOrderPrepare=false;}if(!skipOrderPrepare){var params=[];
params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.orderId=".";cursor_wait();if(piFormName!=null&&piFormName!=undefined&&piFormName=="multiShippingForm"){this.pageLoadRequestFromMS=true;}if(this.shipmentTypeId=="2"){var orderId=document.getElementById("orderId");
if(null!=orderId&&undefined!=orderId){orderId=orderId.value;}this.shoppingCartOrdercalculateForMultipleShipping(null,orderId);}else{wc.service.invoke("AjaxPrepareOrderBeforePaymentCapture",params);}return;}},mattelUpdateAddressForOrderItem:function(response){var params=[];params.orderId=".";params["storeId"]=this.storeId;
params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7,-22";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";params["addressId"]=this.mattelAddressIdForOrderItemAdd;params["orderItemId"]=response.orderItemId;params.orderId=".";
cursor_wait();wc.service.invoke("AjaxUpdateOrderItemsAddressId",params);return;},mattelUpdateSubOrderShipping:function(response){var params=[];params.orderId=".";params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";
params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";params["addressId"]=this.getAddressId();params["orderItemId"]=response.orderItemId;params.orderId=response.orderId;cursor_wait();wc.service.invoke("MattelMSUpdateSubOrder",params);return;},mattelUserType:null,checkForCartErrors:function(orderId,userType){this.mattelUserType=userType;
var expressChekoutObj=document.getElementById("addItem01");var expressChekout=false;var ajaxCartErrorCheckService="AjaxCartErrorValidation";if(expressChekoutObj==null||expressChekoutObj==undefined){expressChekout=false;}else{expressChekout=expressChekoutObj.checked;}if(orderId!=null){var params=[];params.orderId=orderId;
params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params["expressChekout"]=expressChekout;}cursor_wait();wc.service.invoke(ajaxCartErrorCheckService,params);},checkOutOrdercalculate:function(orderId,userType){var orderQty="";var orderIdCookie=getCookie("WC_CartOrderId_"+this.storeId);
if(undefined!=orderIdCookie&&null!=orderIdCookie){var cartTotalCookie=getCookie("WC_CartTotal_"+orderIdCookie);if(undefined!=cartTotalCookie&&null!=cartTotalCookie){var orderInfo=cartTotalCookie.split(";");if((orderInfo!=null&&orderInfo.length>1)){orderQty=orderInfo[0];}}}console.info("orderQty: "+orderQty);
if(orderQty!=0){var ajaxOrderCalculate="AajaxCheckOutOrdercalculate";var calUsage=["-1","-2","-5","-6","-7","-8","-21"];var expressChekout=false;var expressChekoutObj=document.getElementById("addItem01");var fromPage=document.getElementById("fromPage");if(expressChekoutObj==null||expressChekoutObj==undefined){expressChekout=false;
}else{expressChekout=expressChekoutObj.checked;if(expressChekout){calUsage=["-1","-2","-3","-4","-5","-6","-7","-8","-21"];}}var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.URL="MattelOrderShippingView";params.updatePrices="1";params.userType=userType;
params.orderId=".";console.info("calUsage: "+calUsage);params.calculationUsageId=calUsage;params.expressChekout=expressChekout;params.SUPCPromoCheck=true;if(fromPage!=undefined&&fromPage!=null&fromPage.value=="Shopping cart"){params.toShoppingCartPage=true;}cursor_wait();wc.service.invoke(ajaxOrderCalculate,params);
}else{console.info("orderQty is: "+orderQty+"; hence redirecting to shoppingCart");this.shoppingCartOrdercalculate(orderId,userType);}},shoppingCartOrdercalculate:function(orderId,userType){var ajaxOrderCalculate="shoppingCartOrdercalculate";var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;
params.langId=this.langId;params.URL="AjaxOrderItemDisplayView";params.errorViewName="AjaxOrderItemDisplayView";params.updatePrices="1";params.orderId=".";params.userType=userType;params.SUPCPromoCheck=true;params.toShoppingCartPage=true;var calUsage=["-1","-2","-5","-6","-7","-8"];params.calculationUsageId=calUsage;
cursor_wait();wc.service.invoke(ajaxOrderCalculate,params);},shoppingCartOrdercalculateForSUPC:function(redeemedSUPCCodes,orderId){var ajaxOrderCalculate="shoppingCartOrdercalculate";var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.URL="AjaxOrderItemDisplayView";
params.errorViewName="AjaxOrderItemDisplayView";params.updatePrices="1";params.orderId=orderId;params.SUPCCodeRedeemed=true;params.RedeemedSUPCCodes=redeemedSUPCCodes;params.orderId=orderId;params.userType=document.getElementById("userType").value;var calUsage=["-1","-2","-5","-6","-7","-8"];params.calculationUsageId=calUsage;
cursor_wait();wc.service.invoke(ajaxOrderCalculate,params);},shoppingCartOrdercalculateForMultipleShipping:function(redeemedSUPCCodes,orderId){var ajaxOrderCalculate="shoppingCartOrdercalculate";var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=orderId;
params.SUPCPromoCheck=true;params.skipOrderCalculate=true;wc.service.invoke(ajaxOrderCalculate,params);},vmCloseCall:function(){if($.v_modal){$.v_modal.close();}var e=jQuery.Event("keyup");e.keyCode=27;$(document).trigger(e);},productId:null,checkForQtyThershold:function(quantityBox,catEntryId){var catEntryId=catEntryId;
if(catEntryId==""||catEntryId==null||catEntryId==undefined){catEntryId=this.productId;}console.info("catEntryId :"+catEntryId);var quantity=(quantityBox.value);console.info("quantity :"+quantity);if(!isNonNegativeInteger(quantity)){MessageHelper.mattelQtyFormErrorHandleClient(MessageHelper.messages["QUANTITY_INPUT_ERROR"],orderItemId);
}else{if(this.currentQty==quantity){console.debug("Same Quantity");return;}else{var ajaxCartErrorCheckService="AjaxThresholdQtyCheck";var params=[];params["storeId"]=this.storeId;params["catalogId"]=this.catalogId;params["langId"]=this.langId;params["catEntryId"]=catEntryId;params["quantity"]=quantity;
params["qtyValidate"]="qtyValidate";cursor_wait();wc.service.invoke(ajaxCartErrorCheckService,params);}}},mattelAddGiftCard2Cart:function(){var params=[];var giftCompList={};var catenrtyId=document.getElementById("productId").value;var giftComp=document.getElementById("childCatentryIds");if(giftComp!=null&&giftComp!=undefined){giftCompList=giftComp.value.split("_");
giftComp=giftComp.value;}var quantity=1;var productOperationType="giftCard";var giftTo=document.getElementById("toName").value;var giftFrom=document.getElementById("from").value;var giftMessage=document.getElementById("message1").value;var defaultShipModeId=document.getElementById("defaultShipModeId").value;
params.giftTo=giftTo;params.giftFrom=giftFrom;params.giftToMessage1=giftMessage;params.giftToMessage2=document.getElementById("message2").value;params.giftToMessage3=document.getElementById("message3").value;params.userPrice=document.getElementById("ammount").value;params.catentryId_1=catenrtyId;params.quantity_1=quantity;
var idx=2;for(var i=0;i<giftCompList.length;i++){params["catEntryId_"+(i+idx)]=giftCompList[i];params["quantity_"+(i+idx)]=quantity;}params.parentCatentryId=catenrtyId;params.childCatentryIdsForSet=giftComp;params.productoperationType=productOperationType;params.shipModeId=defaultShipModeId;console.info("defaultShipModeId :"+defaultShipModeId);
params.actioncode="create";params.addItem=true;params.mattelOrderType="Standard Orders";params.calculationUsage="-1,-2,-5,-6,-7,-8,-21";params.calculateOrder="1";var isCSR=false;if(("true"==$("#isCsr").val())||("true"==$("#isCSROrderEntry").val())){isCSR=true;}if(!isCSR){params.storeId=this.storeId;params.catalogId=this.catalogId;
params.langId=this.langId;}else{params["storeId"]=CSRCommonSetupJS.storeId;params["catalogId"]=CSRCommonSetupJS.catalogId;params["langId"]=CSRCommonSetupJS.langId;params["orderSource"]=$("#csrOrderSource").val();params["orderType"]=$("#csrOrderType").val();if($("#currentlyEditedOrderId")!=undefined&&$("#currentlyEditedOrderId").val()!=undefined&&$("#currentlyEditedOrderId").val().length>0){params["orderId"]=$("#currentlyEditedOrderId").val();
}}var service=wc.service.getServiceById("mattelAddOnServiceGiftOptionsSave");service.formId="GiftOptions";$("#addTocartLoadIcon").css("display","block");$("#addTocartLoadIconADD").css("display","block");$("#addTocartLoadIconQV").css("display","block");wc.service.invoke("mattelAddOnServiceGiftOptionsSave",params);
},validateAndAddGiftCard:function(form){var isValidationError=false;document.getElementById("toName_err").innerHTML="";document.getElementById("from_err").innerHTML="";document.getElementById("message_err").innerHTML="";document.getElementById("ammount_err").innerHTML="";reWhiteSpace=new RegExp(/^\s+$/);
var isCsr=$("#isCsr").val();if(!isCsr){if(form.toName!=null&&reWhiteSpace.test(form.toName.value)||form.toName.value==""){MessageHelper.mattelFormErrorHandleClient(form.toName.id,MessageHelper.messages["ERROR_ToEmpty"]);isValidationError=true;}else{if(typeof this.validateLoginId=="function"){if(!this.validateLoginId(form.toName)){isValidationError=true;
}}}if(form.from!=undefined&&form.from!=null&&reWhiteSpace.test(form.from.value)||form.from.value==0){MessageHelper.mattelFormErrorHandleClient(form.from.id,MessageHelper.messages["ERROR_FromEmpty"]);isValidationError=true;}}if(form.message.value=="0"||form.message.value==(form.message.length-1)){if(form.message1==null&&reWhiteSpace.test(form.message1.value)||form.message1.value==0){MessageHelper.mattelFormErrorHandleClient(form.message.id,MessageHelper.messages["ERROR_MessageEmpty"]);
isValidationError=true;}}if(form.ammount!=null&&reWhiteSpace.test(form.ammount.value)||form.ammount.value==""){MessageHelper.mattelFormErrorHandleClient(form.ammount.id,MessageHelper.messages["ERROR_AmmountEmpty"]);isValidationError=true;}var r=/^[0-9]+(\.[0-9][0-9])?$/;if(!r.test(form.ammount.value)){MessageHelper.mattelFormErrorHandleClient(form.ammount.id,MessageHelper.messages["ERROR_IsNotValidAmmount"]);
isValidationError=true;}if(form.ammount.value<5||form.ammount.value>1000){MessageHelper.mattelFormErrorHandleClient(form.ammount.id,MessageHelper.messages["ERROR_IsNotValidAmmount"]);isValidationError=true;}if(isNaN(form.ammount.value)){MessageHelper.mattelFormErrorHandleClient(form.ammount.id,MessageHelper.messages["ERROR_IsNotValidAmmount"]);
isValidationError=true;}if(!isValidationError){CheckoutHelperJS.mattelAddGiftCard2Cart();}},SubmitMSPage:function(orderId){var SubmitMSAddress=document.getElementById("shipFlag").value;if(SubmitMSAddress==true||SubmitMSAddress=="true"||SubmitMSAddress==""){console.info("SubmitMSAddress in Checkout Helper: "+SubmitMSAddress);
this.SubmitMSAddress=true;var params=[];params.orderId=orderId;wc.service.invoke("AjaxPrepareOrderBeforePaymentCapture",params);Mattel.Analytics.addEvent("loadMShippingContinueEvent");}},isEmpty:function(str){var reWhiteSpace=new RegExp(/^\s+$/);if(str==null||str==""||reWhiteSpace.test(str)){return true;
}return false;},escapeXml:function(str,fullConversion){if(fullConversion){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;");}str=str.replace(/"/gm,"&#034;").replace(/'/gm,"&#039;");return str;},setPromotionCookie:function(promotionCode,storeId){if(promotionCode!=null&&promotionCode!=""){var emailCookieName="WC_EmailPromoCode_"+storeId;
this.setValueToCookie(emailCookieName,promotionCode);}console.info("Promotion Cookie :"+getCookie("WC_EmailPromoCode_"+storeId));},setValueToCookie:function(cookieKey,cookieValue){var newValue=cookieValue;if(newValue!=null&&newValue!="undefined"&&newValue!=""){var currentValue=dojo.cookie(cookieKey);
if(newValue!=currentValue){dojo.cookie(cookieKey,null,{path:"/",expires:-1});dojo.cookie(cookieKey,newValue,{path:"/"});}}},dynamicEndecaProductSearch:function(value){if(value&&value.length>2){var params={};params.criteria=value;cursor_wait();wc.service.invoke("DynamicEndecaProductSearchForDoll",params);
}else{this.closeEndecaProductResultPopUp();}},closeEndecaProductResultPopUp:function(){var popup=dojo.byId("MattelEndecaProductSearchResultListPopUp");if(popup!=null){popup.innerHTML="";popup.style.display="none";}else{console.debug("MattelEndecaProductSearchResultListPopUp"+" does not exist");}},openEndecaProductResultPopUp:function(){var popup=dojo.byId("MattelEndecaProductSearchResultListPopUp");
if(popup!=null){popup.style.display="block";}else{console.debug("MattelEndecaProductSearchResultListPopUp"+" does not exist");}},addEndecaProduct:function(productID,productDescription){productDescription=productDescription.replace("|apos|","'");if(dojo.byId("searchForDoll")){dojo.byId("searchForDoll").value=productDescription;
}this.closeEndecaProductResultPopUp();},showCompleteCollection:function(){if(typeof document.getElementById("flag6")!="undefined"){var flag6=document.getElementById("flag6").value;if(flag6=="true"){$(".completeYourCollection").css("display","block");if(typeof document.getElementById("activeTab")!="undefined"){var activeTab=document.getElementById("activeTab").value;
if(activeTab=="tab6"){$("#CompleteYourCollectionDisplay").css("display","block");$("#CompleteYourCollectionDisplay").parents(".tabs-content").find(".tab").each(function(){if($(this).hasClass("open")){$(this).removeClass("open");}});$("#CompleteYourCollectionDisplay").find(".tab").addClass("open");$(".tab-3").removeClass("current");
$(".tab-4").removeClass("current");$(".tab-5").removeClass("current");}if(activeTab=="tab1"||activeTab=="tab2"){$(".tab-6").removeClass("current");}}}}}};