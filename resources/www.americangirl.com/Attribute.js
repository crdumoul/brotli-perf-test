dojo.require("dojox.xml.DomParser");if(typeof(QuickInfoJS)=="undefined"||QuickInfoJS==null||!QuickInfoJS){QuickInfoJS={productImgDimensions:"1000x1000",quickInfoImgDimensions:"330x330",catEntryParams:{},catEntryParamsQV:{},catEntryCoordParams:{},selectedAttributes:new Object(),selectedAttributesQV:new Object(),catEntryQuantity:1,itemDetailsArr:new Object(),params:null,replaceOrderItemId:"",itemId:"",selectedSkuIndex:null,selectedThumbnailIndex:null,selectedCatentryId:null,replaceQuantity:"",orderType:null,orderSource:null,glCode:null,catEntryIdAndMaxQuantity:{},swatchCheck:false,setOrderType:function(orderType){if(orderType!=undefined&&orderType.length>0){this.orderType=orderType;
}else{this.orderType=$("#csrOrderType").val();}},setOrderSource:function(orderSource){if(orderSource!=undefined&&orderSource.length>0){this.orderSource=orderSource;}else{this.orderSource=$("#csrOrderSource").val();}},setGlCode:function(glCode){if(glCode!=undefined&&glCode.length>0){this.glCode=glCode;
}else{this.glCode=$("#csrGlCode").val();}},setReplaceQuantity:function(replaceQuantity){this.replaceQuantity=replaceQuantity;},setReplaceOrderItemId:function(replaceOrderItemId){if(replaceOrderItemId!=undefined&&replaceOrderItemId.length>0){this.replaceOrderItemId=replaceOrderItemId;}else{this.replaceOrderItemId=$("#replaceOrderItemId").val();
}},setValues:function(bundleIndex){var bundleIndex;if(bundleIndex){this.catEntryParams=dojo.fromJson(dojo.byId("catEntryParamsForJS"+bundleIndex).value);}if(dojo.byId("catEntryParamsForJS")){this.catEntryParams=dojo.fromJson(dojo.byId("catEntryParamsForJS").value);}if(dojo.byId("QV_catEntryParamsForJS")){this.catEntryParamsQV=dojo.fromJson(dojo.byId("QV_catEntryParamsForJS").value);
this.catEntryParams=dojo.fromJson(dojo.byId("QV_catEntryParamsForJS").value);}if(dojo.byId("catEntryIdAndMaxQuantity")){this.catEntryIdAndMaxQuantity=dojo.fromJson(dojo.byId("catEntryIdAndMaxQuantity").value);}this.catEntryParams.attributes=this.selectedAttributes;this.catEntryParamsQV.attributes=this.selectedAttributesQV;
},setcoordValues:function(){if(dojo.byId("coordcatEntryParamsForJS")){this.catEntryCoordParams=dojo.fromJson(dojo.byId("coordcatEntryParamsForJS").value);}this.catEntryCoordParams.attributes=this.selectedAttributes;},setCatEntryQuantity:function(catEntryQuantity){if(catEntryQuantity!=undefined&&catEntryQuantity.length>0){this.catEntryQuantity=catEntryQuantity;
}else{this.catEntryQuantity=$("#csrQuantity").val();}},setCatEntryQty:function(quantityBox){this.catEntryQuantity=quantityBox.value;console.info("qty :"+this.catEntryQuantity);},showDetails:function(productId,params,itemId,quantity){if(params){this.params=params;}else{this.params=null;}this.selectedAttributes=new Object();
this.selectedSkuIndex=null;this.selectedThumbnailIndex=null;cursor_wait();var contextValues=this.setCommonParams();if(itemId){this.itemId=itemId;contextValues.updateAttributes="true";}else{this.itemId="";contextValues.updateAttributes="false";}if(quantity){this.catEntryQuantity=quantity;}contextValues.productId=productId;
wc.render.updateContext("QuickInfoContext",contextValues);},changeAttributes:function(orderItemId,productId,itemId,quantity){this.setReplaceOrderItemId(orderItemId);this.showDetails(productId,null,itemId,quantity);},changeImage:function(elementId,imgSrc){this.selectedThumbnailIndex=elementId-1;dojo.byId("quickInfoMainImage").src=this.getQuickInfoImage(this.catEntryParams.skus[this.selectedSkuIndex].fullImageAttachments[this.selectedThumbnailIndex].path);
dojo.query(".widget_quick_info_popup .other_views li").removeClass("selected");dojo.addClass("quickInfoThumbnail"+elementId,"selected");},setSelectedAttribute:function(selectedAttributeName,selectedAttributeValue){this.selectedAttributes[selectedAttributeName]=selectedAttributeValue;},notifyAttributeChange:function(){dojo.publish("QuickInfo_attributesChanged",[dojo.toJson(this.selectedAttributes)]);
},selectcoordItem:function(displayPriceRange,coordupdateItemImageOnly){this.displayPriceRange=displayPriceRange;this.setcoordValues();var catEntryId=this.resolvecoordSKU();if(catEntryId==-1&&coordupdateItemImageOnly){var skuId=-1;for(idx=0;idx<this.catEntryCoordParams.skus.length;idx++){for(attribute in this.catEntryCoordParams.skus[idx].attributes){if(this.catEntryCoordParams.attributes&&this.catEntryCoordParams.skus[idx].attributes[attribute]==this.catEntryCoordParams.attributes[attribute]){skuId=this.catEntryCoordParams.skus[idx].id;
break;}}}if(skuId!=-1){catEntryId=skuId;this.coordupdateItemImageOnly=coordupdateItemImageOnly;}}if(catEntryId!=-1){if(this.itemDetailsArr[catEntryId]!=null&&this.itemDetailsArr[catEntryId]!="undefined"){this.displayCoordItemDetails(this.itemDetailsArr[catEntryId]);}else{var params=this.setCommonParams();
params.catalogEntryId=catEntryId;dojo.xhrPost({url:getAbsoluteURL()+"MattelGetCatalogEntryDetailsByIDView",handleAs:"json-comment-filtered",content:params,service:this,load:QuickInfoJS.setcoordItemDetails,error:function(errObj,ioArgs){console.debug("QuickInfoJS.selectItem: Unexpected error occurred during an xhrPost request.");
}});}}},selectItem:function(selectedAttributeName,selectedAttributeValue,displayPriceRange,updateItemImageOnly,bundleindex,bundleprodId){var oneColorCheck=false;if(selectedAttributeName=="Color"&&$("#oneColor").val()=="true"){oneColorCheck=true;}if(bundleindex!=""&&bundleindex!=null&&typeof bundleindex!=undefined){if($("#quickinfo_swatch_selection_Color_"+bundleprodId).text()==""&&selectedAttributeName=="Size"){this.selectedAttributes=new Object();
this.setSelectedAttribute(selectedAttributeName,selectedAttributeValue);}}if(bundleindex!=""&&bundleindex!=null&&typeof bundleindex!=undefined){if(this.selectedAttributes.hasOwnProperty("Color")){this.selectedAttributes["Color"]=$("#quickinfo_swatch_selection_Color_"+bundleprodId).text();}}this.displayPriceRange=displayPriceRange;
this.setValues();var flagCheck=true;var selectedValue=selectedAttributeName+"_"+selectedAttributeValue;console.info("selectedValue: "+selectedValue);var ObjArr=this.selectedAttributes;var Arr1=new Array();var Arr2=new Array();var bundleComponentPart="";var applicableSwatches="";if(bundleindex!=""&&bundleindex!=null&&typeof bundleindex!=undefined){if(undefined!=document.getElementById("bundleCompPart"+bundleindex)){bundleComponentPart=document.getElementById("bundleCompPart"+bundleindex).value;
}}if(undefined!=document.getElementById("applicableProductAttributesQV")){applicableSwatches=document.getElementById("applicableProductAttributesQV").value;}if(undefined!=document.getElementById("applicableProductAttributes"+bundleComponentPart)&&applicableSwatches==""){applicableSwatches=document.getElementById("applicableProductAttributes"+bundleComponentPart).value;
}var applicableSwatchesArr=applicableSwatches.split("_");for(var i=0;i<applicableSwatchesArr.length;i++){Arr1.push(applicableSwatchesArr[i]);}var temp="";for(i in ObjArr){if($.inArray(i,Arr2)==-1){Arr2.push(i);}}Arr1.sort();Arr2.sort();if(typeof CsrCommonJS==="object"){this.selectedCatentryId=this.resolveSKU();
}console.debug("OOB Array String: "+Arr1.toString()+" : Created Array String: "+Arr2.toString());if(Arr1.toString()==Arr2.toString()){console.debug("SKU to be resolved now");flagCheck=true;}else{flagCheck=false;}if(flagCheck&&!oneColorCheck){var catEntryId=this.resolveSKU();if(typeof(CheckoutHelperJS)!=="undefined"){CheckoutHelperJS.productId=catEntryId;
}var bundlePageFlag=document.getElementById("bundlePageFlag");if(bundlePageFlag!=undefined&&bundlePageFlag!=null){var obj="resolvedCatentryId"+this.catEntryParams.id;dojo.html.set(dojo.byId(obj),catEntryId);}if(bundlePageFlag!=undefined&&bundlePageFlag!=null&&bundleindex=="1"){var obj="resolvedmainBundleCatentryId";
dojo.html.set(dojo.byId(obj),catEntryId);}if(bundlePageFlag!=undefined&&bundlePageFlag!=null&&bundleindex!="1"){var obj="resolvedaddonBundleCatentryId"+bundleindex;dojo.html.set(dojo.byId(obj),catEntryId);}if(catEntryId==-1&&updateItemImageOnly){var skuId=-1;for(idx=0;idx<this.catEntryParams.skus.length;
idx++){for(attribute in this.catEntryParams.skus[idx].attributes){if(this.catEntryParams.attributes&&this.catEntryParams.skus[idx].attributes[attribute]==this.catEntryParams.attributes[attribute]){skuId=this.catEntryParams.skus[idx].id;break;}}}if(skuId!=-1){catEntryId=skuId;this.updateItemImageOnly=updateItemImageOnly;
}}this.selectedCatentryId=catEntryId;if(catEntryId!=-1){if(this.itemDetailsArr[catEntryId]!=null&&this.itemDetailsArr[catEntryId]!="undefined"){this.displayItemDetails(this.itemDetailsArr[catEntryId]);}else{var params=this.setCommonParams();params.catalogEntryId=catEntryId;wc.service.invoke("MattelGetCatalogEntryDetailsByID",params);
}}if(bundleindex!=""&&bundleindex!=null&&typeof bundleindex!=undefined){console.info("quickinfo_swatch_selection_Color: "+$("#quickinfo_swatch_selection_Color_"+bundleprodId).text());if($("#quickinfo_swatch_selection_Color_"+bundleprodId).text()!=""){this.selectedAttributes=new Object();this.selectedAttributes["Color"]=$("#quickinfo_swatch_selection_Color_"+bundleprodId).text();
console.info("Color----------"+this.selectedAttributes["Color"]);}}}if(catEntryId!=-1){if(this.catEntryIdAndMaxQuantity!=null&&this.catEntryIdAndMaxQuantity.length>0){for(idx=0;idx<this.catEntryIdAndMaxQuantity.length;idx++){if(catEntryId==this.catEntryIdAndMaxQuantity[idx].id&&this.catEntryIdAndMaxQuantity[idx].maxOrderLineQty.length!=0&&this.catEntryIdAndMaxQuantity[idx].maxOrderLineQty!=null){document.getElementById("maxOrderLineQty").innerHTML="There is a limit of "+this.catEntryIdAndMaxQuantity[idx].maxOrderLineQty+" items per order";
}}}}},selectSwatch:function(selectedAttributeName,selectedAttributeValue,swatchId,swatchGrp,productId,bundleIndex){WCParamJS.bundleIndex=bundleIndex;$("#errorMsgSwatchColor").hide();$("#errorMsgSwatchSize").hide();if(selectedAttributeName=="Color"){document.getElementById("WC_QuickInfo_SwatchColor").value=selectedAttributeValue;
}if(selectedAttributeName=="Size"){document.getElementById("WC_QuickInfo_SwatchSize").value=selectedAttributeValue;}if(productId!=null||productId!=undefined){if(dojo.hasClass("quickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue+"_"+productId,"color_swatch_disabled")){return false;}}else{if(dojo.hasClass("quickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue,"color_swatch_disabled")){return false;
}}this.setValues(bundleIndex);if(bundleIndex!=null){var bundle_fieldset_id=document.getElementById("bundleCheckBox"+bundleIndex).id;$("#"+bundle_fieldset_id).find(".special").remove();if(!$("#"+bundle_fieldset_id).hasClass("disabled")){$("#"+bundle_fieldset_id).removeClass("colored");$("#"+bundle_fieldset_id).addClass("disabled");
$("#"+bundle_fieldset_id).find('input[type="checkbox"]').attr("disabled",true);$("#"+bundle_fieldset_id).find('input[type="checkbox"]').attr("checked",false);$("#"+bundle_fieldset_id).find('input[type="checkbox"] + label').addClass("importantPosition");}else{$("#"+bundle_fieldset_id).find('input[type="checkbox"]').attr("checked",false);
$("#"+bundle_fieldset_id).find('input[type="checkbox"]').attr("disabled",true);$("#"+bundle_fieldset_id).find('input[type="checkbox"] + label').removeClass("importantPosition");}if($("#"+bundle_fieldset_id).find('input[type="checkbox"] + label').hasClass("importantPosition")){$("#"+bundle_fieldset_id).find('input[type="checkbox"] + label').removeClass("importantPosition");
}}var swatchNames=dojo.byId("WC_QuickInfo_SwatchNames").value.split("_");var currentSwatchPos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==selectedAttributeName){currentSwatchPos=i;break;}}var currentSwatchkey="";if(productId!=null||productId!=undefined){currentSwatchkey="quickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue+"_"+productId;
}else{currentSwatchkey="quickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue;}var currentSwatchkeyLink="";if(productId!=null||productId!=undefined){currentSwatchkeyLink="WC_QuickInfo_Swatch_"+selectedAttributeName+"_"+selectedAttributeValue+"_"+productId;}else{currentSwatchkeyLink="WC_QuickInfo_Swatch_"+selectedAttributeName+"_"+selectedAttributeValue;
}var validSwatchArr=new Array();var bittybabySKUs=false;var bittybabySKUsObj=dojo.byId("bittybabySKUs");console.info("bittybabySKUsObj: "+bittybabySKUsObj);if(undefined!=bittybabySKUsObj&&null!=bittybabySKUsObj){bittybabySKUs=true;}for(idx in this.catEntryParams.skus){var validItem=false;var entitledItem=this.catEntryParams.skus[idx];
for(attribute in entitledItem.attributes){if(selectedAttributeName==attribute&&selectedAttributeValue==entitledItem.attributes[attribute]){validItem=true;break;}}if(validItem){for(attribute in entitledItem.attributes){var attributePos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==attribute){attributePos=i;
break;}}var swatchFlag=false;if(bittybabySKUs){if(attributePos!=currentSwatchPos){swatchFlag=true;}}else{if(attributePos>currentSwatchPos){swatchFlag=true;}}console.info("swatchFlag at line#543 is: "+swatchFlag);if(swatchFlag){validSwatchArr.push(attribute+"_"+entitledItem.attributes[attribute]);}}}}var swatchesDisabled=new Array();
var selectedSwatches=new Array();for(idx in this.catEntryParams.skus){var entitledItem=this.catEntryParams.skus[idx];for(attribute in entitledItem.attributes){var attributePos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==attribute){attributePos=i;break;}}var swatchFlag=false;if(bittybabySKUs){if(attributePos!=currentSwatchPos){swatchFlag=true;
}}else{if(attributePos>currentSwatchPos){swatchFlag=true;}}console.info("swatchFlag at line#574 is: "+swatchFlag);if(swatchFlag){var swatchSelection=attribute+"_"+entitledItem.attributes[attribute];var swatchId="";var swatchLinkId="";if(productId!=null||productId!=undefined){swatchId="quickInfoSwatch_"+swatchSelection+"_"+productId;
swatchLinkId="WC_QuickInfo_Swatch_"+swatchSelection+"_"+productId;}else{swatchId="quickInfoSwatch_"+swatchSelection;swatchLinkId="WC_QuickInfo_Swatch_"+swatchSelection;}var validSwatchArrPos=-1;for(var i=0;i<validSwatchArr.length;i++){if(validSwatchArr[i]==swatchSelection){validSwatchArrPos=i;break;}}var swatchesDisabledPos=-1;
for(var i=0;i<swatchesDisabled.length;i++){if(swatchesDisabled[i]==swatchSelection){swatchesDisabledPos=i;break;}}if(validSwatchArrPos>-1){if(!dojo.hasClass(swatchId,"color_swatch_selected")){dojo.byId(swatchId).className="color_swatch";dojo.byId(swatchLinkId).className="color_swatch_enabled_pointer";
document.getElementById(swatchLinkId).removeAttribute("disabled");document.getElementById(swatchLinkId).setAttribute("aria-disabled","false");}if(document.body.className.match("fpstore")){dojo.style(swatchLinkId,{"background":"#B5AEA8","opacity":"1"});}else{if(document.body.className.match("hwcstore")){dojo.style(swatchLinkId,{"background":"#333333","opacity":"1"});
}else{if(document.body.className.match("bcstore")){dojo.style(swatchLinkId,{"background":"#999999","opacity":"1"});}else{if(document.body.className.match("ttstore")){dojo.style(swatchLinkId,{"background":"#fff","opacity":"1","border":"1px solid #BBB"});}else{dojo.style(swatchLinkId,{"background":"#fff","opacity":"1","border":"1px solid #FFDDED"});
}}}}}else{if(swatchesDisabledPos==-1){swatchesDisabled.push(swatchSelection);if(dojo.hasClass(swatchId,"color_swatch_selected")){selectedSwatches.push(swatchId);}dojo.byId(swatchId).className="color_swatch_disabled";dojo.byId(swatchLinkId).className="color_swatch_disabled_pointer";document.getElementById(swatchLinkId).setAttribute("aria-disabled","true");
dojo.style(swatchLinkId,{"border":"1px solid #BBBBBB","background":"#DDDDDD","opacity":"0.5"});document.getElementById(swatchLinkId).setAttribute("disabled","disabled");}}}if(document.getElementById("WC_QuickInfo_Swatch_"+attribute+"_"+entitledItem.attributes[attribute])!=null){document.getElementById("WC_QuickInfo_Swatch_"+attribute+"_"+entitledItem.attributes[attribute]).setAttribute("aria-checked","false");
}}}$("#selectItem_"+productId).find(".inventoryStatus input").attr("checked",false);if(selectedSwatches.length>0){for(idx in selectedSwatches){var selectedSwatch=selectedSwatches[idx].toString();var idSelector="img[id^='"+selectedSwatch.substring(0,selectedSwatch.lastIndexOf("_"))+"']";var swatchSelected=false;
dojo.query(idSelector).forEach(function(node,index,arr){if(!swatchSelected&&dojo.hasClass(node,"color_swatch")){var values=node.id.split("_");QuickInfoJS.selectSwatch(values[1],values[2],"quickInfoSwatch_"+values[1]+"_"+values[2],"quickInfoSwatch_"+values[1]+"_");QuickInfoJS.selectItem(true);swatchSelected=true;
}});}}selector="span[id^='"+swatchGrp+"']";dojo.query(selector).forEach(function(node,index,arr){if(!dojo.hasClass(node,"color_swatch_disabled")){dojo.addClass(node,"color_swatch");if(dojo.hasClass(node,"color_swatch_selected")){dojo.removeClass(node,"color_swatch_selected");}}});selector="img[id^='"+swatchGrp+"']";
dojo.query(selector).forEach(function(node,index,arr){if(!dojo.hasClass(node,"color_swatch_disabled")){dojo.addClass(node,"color_swatch");if(dojo.hasClass(node,"color_swatch_selected")){dojo.removeClass(node,"color_swatch_selected");}}});dojo.byId(currentSwatchkey).className="color_swatch_selected";if(productId!=null||productId!=undefined){dojo.byId("quickinfo_swatch_selection_"+selectedAttributeName+"_"+productId).innerHTML=selectedAttributeValue;
}else{dojo.byId("quickinfo_swatch_selection_"+selectedAttributeName).innerHTML=selectedAttributeValue;}document.getElementById(currentSwatchkeyLink).setAttribute("aria-checked","true");this.setSelectedAttribute(selectedAttributeName,selectedAttributeValue);if($("#selectItem_"+productId).parents(".container").hasClass("bundleTemplate")||$("#selectItem_"+productId).parents(".container").hasClass("prodBundle")){this.swatchCheck=true;
}},onloadSwatchQV:function(selectedAttributeName,selectedAttributeValue){dojo.byId("QVquickinfo_swatch_selection_"+selectedAttributeName).innerHTML=selectedAttributeValue;},selectSwatchQV:function(selectedAttributeName,selectedAttributeValue,swatchId,swatchGrp,productId){$("#errorMsgSwatchColor").hide();
$("#errorMsgSwatchSize").hide();if(selectedAttributeName=="Color"){document.getElementById("WC_QuickInfo_SwatchColor").value=selectedAttributeValue;}if(selectedAttributeName=="Size"){document.getElementById("WC_QuickInfo_SwatchSize").value=selectedAttributeValue;}if(productId!=null||productId!=undefined){if(dojo.hasClass("QV_quickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue+"_"+productId,"QV_color_swatch_disabled")){return false;
}}else{if(dojo.hasClass("QV_quickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue,"QV_color_swatch_disabled")){return false;}}this.setValues();var swatchNames=dojo.byId("QV_WC_QuickInfo_SwatchNames").value.split("_");var currentSwatchPos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==selectedAttributeName){currentSwatchPos=i;
break;}}var currentSwatchkey="";if(productId!=null||productId!=undefined){currentSwatchkey="QV_quickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue+"_"+productId;}else{currentSwatchkey="QV_quickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue;}var currentSwatchkeyLink="";if(productId!=null||productId!=undefined){currentSwatchkeyLink="QV_WC_QuickInfo_Swatch_"+selectedAttributeName+"_"+selectedAttributeValue+"_"+productId;
}else{currentSwatchkeyLink="QV_WC_QuickInfo_Swatch_"+selectedAttributeName+"_"+selectedAttributeValue;}var validSwatchArr=new Array();for(idx in this.catEntryParamsQV.skus){var validItem=false;var entitledItem=this.catEntryParamsQV.skus[idx];for(attribute in entitledItem.attributes){if(selectedAttributeName==attribute&&selectedAttributeValue==entitledItem.attributes[attribute]){validItem=true;
break;}}if(validItem){for(attribute in entitledItem.attributes){var attributePos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==attribute){attributePos=i;break;}}if(attributePos>currentSwatchPos){validSwatchArr.push(attribute+"_"+entitledItem.attributes[attribute]);}}}}var swatchesDisabled=new Array();
var selectedSwatches=new Array();for(idx in this.catEntryParamsQV.skus){var entitledItem=this.catEntryParamsQV.skus[idx];for(attribute in entitledItem.attributes){var attributePos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==attribute){attributePos=i;break;}}if(attributePos>currentSwatchPos){var swatchSelection=attribute+"_"+entitledItem.attributes[attribute];
var swatchId="";var swatchLinkId="";if(productId!=null||productId!=undefined){swatchId="QV_quickInfoSwatch_"+swatchSelection+"_"+productId;swatchLinkId="QV_WC_QuickInfo_Swatch_"+swatchSelection+"_"+productId;}else{swatchId="QV_quickInfoSwatch_"+swatchSelection;swatchLinkId="QV_WC_QuickInfo_Swatch_"+swatchSelection;
}var validSwatchArrPos=-1;for(var i=0;i<validSwatchArr.length;i++){if(validSwatchArr[i]==swatchSelection){validSwatchArrPos=i;break;}}var swatchesDisabledPos=-1;for(var i=0;i<swatchesDisabled.length;i++){if(swatchesDisabled[i]==swatchSelection){swatchesDisabledPos=i;break;}}if(validSwatchArrPos>-1){if(!dojo.hasClass(swatchId,"QV_color_swatch_selected")){dojo.byId(swatchId).className="QV_color_swatch";
document.getElementById(swatchLinkId).setAttribute("aria-disabled","false");}if(document.body.className.match("fpstore")){dojo.style(swatchLinkId,{"background":"#B5AEA8","opacity":"1"});}else{if(document.body.className.match("hwcstore")){dojo.style(swatchLinkId,{"background":"#333333","opacity":"1"});
}else{if(document.body.className.match("bcstore")){dojo.style(swatchLinkId,{"background":"#999999","opacity":"1"});}else{if(document.body.className.match("ttstore")){dojo.style(swatchLinkId,{"background":"#fff","opacity":"1","border":"1px solid #BBB"});}else{dojo.style(swatchLinkId,{"background":"#fff","opacity":"1","border":"1px solid #FFDDED"});
}}}}}else{if(swatchesDisabledPos==-1){swatchesDisabled.push(swatchSelection);if(dojo.hasClass(swatchId,"QV_color_swatch_selected")){selectedSwatches.push(swatchId);}dojo.byId(swatchId).className="QV_color_swatch_disabled";document.getElementById(swatchLinkId).setAttribute("aria-disabled","true");dojo.style(swatchLinkId,{"border":"1px solid #BBBBBB","background":"#DDDDDD","opacity":"0.5"});
}}}if(document.getElementById("QV_WC_QuickInfo_Swatch_"+attribute+"_"+entitledItem.attributes[attribute])!=null){document.getElementById("QV_WC_QuickInfo_Swatch_"+attribute+"_"+entitledItem.attributes[attribute]).setAttribute("aria-checked","false");}}}if(selectedSwatches.length>0){for(idx in selectedSwatches){var selectedSwatch=selectedSwatches[idx].toString();
var idSelector="img[id^='"+selectedSwatch.substring(0,selectedSwatch.lastIndexOf("_"))+"']";var swatchSelected=false;dojo.query(idSelector).forEach(function(node,index,arr){if(!swatchSelected&&dojo.hasClass(node,"QV_color_swatch")){var values=node.id.split("_");QuickInfoJS.selectSwatch(values[1],values[2],"QV_quickInfoSwatch_"+values[1]+"_"+values[2],"QV_quickInfoSwatch_"+values[1]+"_");
QuickInfoJS.selectItem(true);swatchSelected=true;}});}}selector="span[id^='"+swatchGrp+"']";dojo.query(selector).forEach(function(node,index,arr){if(!dojo.hasClass(node,"QV_color_swatch_disabled")){dojo.addClass(node,"QV_color_swatch");if(dojo.hasClass(node,"QV_color_swatch_selected")){dojo.removeClass(node,"QV_color_swatch_selected");
}}});selector="img[id^='"+swatchGrp+"']";dojo.query(selector).forEach(function(node,index,arr){if(!dojo.hasClass(node,"QV_color_swatch_disabled")){dojo.addClass(node,"QV_color_swatch");if(dojo.hasClass(node,"QV_color_swatch_selected")){dojo.removeClass(node,"QV_color_swatch_selected");}}});dojo.byId(currentSwatchkey).className="QV_color_swatch_selected";
if(productId!=null||productId!=undefined){dojo.byId("QVquickinfo_swatch_selection_"+selectedAttributeName+"_"+productId).innerHTML=selectedAttributeValue;}else{dojo.byId("QVquickinfo_swatch_selection_"+selectedAttributeName).innerHTML=selectedAttributeValue;}document.getElementById(currentSwatchkeyLink).setAttribute("aria-checked","true");
this.setSelectedAttribute(selectedAttributeName,selectedAttributeValue);},selectcoordSwatch:function(selectedAttributeName,selectedAttributeValue,swatchId,swatchGrp){if(dojo.hasClass("coordquickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue,"color_swatch_disabled")){return false;}this.setcoordValues();
var swatchNames=dojo.byId("WC_coordQuickInfo_SwatchNames").value.split("_");var currentSwatchPos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==selectedAttributeName){currentSwatchPos=i;break;}}var coordcurrentSwatchkey="coordquickInfoSwatch_"+selectedAttributeName+"_"+selectedAttributeValue;
var coordcurrentSwatchkeyLink="WC_coordQuickInfo_Swatch_"+selectedAttributeName+"_"+selectedAttributeValue;var validSwatchArr=new Array();for(idx in this.catEntryCoordParams.skus){var validItem=false;var entitledItem=this.catEntryCoordParams.skus[idx];for(attribute in entitledItem.attributes){if(selectedAttributeName==attribute&&selectedAttributeValue==entitledItem.attributes[attribute]){validItem=true;
break;}}if(validItem){for(attribute in entitledItem.attributes){var attributePos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==attribute){attributePos=i;break;}}if(attributePos>currentSwatchPos){validSwatchArr.push(attribute+"_"+entitledItem.attributes[attribute]);}}}}var swatchesDisabled=new Array();
var selectedSwatches=new Array();for(idx in this.catEntryCoordParams.skus){var entitledItem=this.catEntryCoordParams.skus[idx];for(attribute in entitledItem.attributes){var attributePos=-1;for(var i=0;i<swatchNames.length;i++){if(swatchNames[i]==attribute){attributePos=i;break;}}if(attributePos>currentSwatchPos){var swatchSelection=attribute+"_"+entitledItem.attributes[attribute];
var swatchId="coordquickInfoSwatch_"+swatchSelection;var swatchLinkId="WC_coordQuickInfo_Swatch_"+swatchSelection;var validSwatchArrPos=-1;for(var i=0;i<validSwatchArr.length;i++){if(validSwatchArr[i]==swatchSelection){validSwatchArrPos=i;break;}}var swatchesDisabledPos=-1;for(var i=0;i<swatchesDisabled.length;
i++){if(swatchesDisabled[i]==swatchSelection){swatchesDisabledPos=i;break;}}if(validSwatchArrPos>-1){if(!dojo.hasClass(swatchId,"color_swatch_selected")){dojo.byId(swatchId).className="coordcolor_swatch";dojo.byId(swatchId).src=dojo.byId(swatchId).src.replace("_disabled.png","_enabled.png");document.getElementById(swatchLinkId).setAttribute("aria-disabled","false");
}}else{if(swatchesDisabledPos==-1){swatchesDisabled.push(swatchSelection);if(dojo.hasClass(swatchId,"color_swatch_selected")){selectedSwatches.push(swatchId);}dojo.byId(swatchId).className="color_swatch_disabled";dojo.byId(swatchId).src=dojo.byId(swatchId).src.replace("_enabled.png","_disabled.png");
document.getElementById(swatchLinkId).setAttribute("aria-disabled","true");}}}if(document.getElementById("WC_coordQuickInfo_Swatch_"+attribute+"_"+entitledItem.attributes[attribute])!=null){document.getElementById("WC_coordQuickInfo_Swatch_"+attribute+"_"+entitledItem.attributes[attribute]).setAttribute("aria-checked","false");
}}}for(idx in selectedSwatches){var selectedSwatch=selectedSwatches[idx];var idSelector="img[id^='"+selectedSwatch.substring(0,selectedSwatch.lastIndexOf("_"))+"']";var swatchSelected=false;dojo.query(idSelector).forEach(function(node,index,arr){if(!swatchSelected&&dojo.hasClass(node,"coordcolor_swatch")){var values=node.id.split("_");
QuickInfoJS.selectSwatch(values[1],values[2],"coordquickInfoSwatch_"+values[1]+"_"+values[2],"coordquickInfoSwatch_"+values[1]+"_");QuickInfoJS.selectItem(true);swatchSelected=true;}});}selector="img[id^='"+swatchGrp+"']";dojo.query(selector).forEach(function(node,index,arr){if(!dojo.hasClass(node,"color_swatch_disabled")){dojo.addClass(node,"coordcolor_swatch");
if(dojo.hasClass(node,"color_swatch_selected")){dojo.removeClass(node,"color_swatch_selected");}}});dojo.byId(coordcurrentSwatchkey).className="color_swatch_selected";dojo.byId("coordquickinfo_swatch_selection_"+selectedAttributeName).innerHTML=selectedAttributeValue;document.getElementById(coordcurrentSwatchkeyLink).setAttribute("aria-checked","true");
this.setSelectedAttribute(selectedAttributeName,selectedAttributeValue);},setCommonParams:function(){var params=new Object();params.storeId=WCParamJS.storeId;params.catalogId=WCParamJS.catalogId;params.langId=WCParamJS.langId;return params;},setItemDetails:function(serviceResponse,ioArgs){QuickInfoJS.itemDetailsArr[serviceResponse.catalogEntry.catalogEntryIdentifier.uniqueID]=serviceResponse.catalogEntry;
QuickInfoJS.displayItemDetails(serviceResponse.catalogEntry);},setcoordItemDetails:function(serviceResponse,ioArgs){QuickInfoJS.itemDetailsArr[serviceResponse.catalogEntry.catalogEntryIdentifier.uniqueID]=serviceResponse.catalogEntry;QuickInfoJS.displayCoordItemDetails(serviceResponse.catalogEntry);},displayCoordItemDetails:function(catalogEntry){if(null!=this.catEntryCoordParams){for(idx in this.catEntryCoordParams.skus){if(null!=this.catEntryCoordParams.skus[idx]&&(this.catEntryCoordParams.skus[idx].id==catalogEntry.catalogEntryIdentifier.uniqueID)){for(idx2=1;
idx2<=this.catEntryCoordParams.skus[idx].thumbnailAttachments.length;idx2++){var angleImgNode=dojo.query("#quickInfoThumbnail"+idx2+" img")[0];if(angleImgNode!=null){angleImgNode.src=this.catEntryParams.skus[idx].thumbnailAttachments[idx2-1].path;}}if(null==this.selectedThumbnailIndex){this.selectedThumbnailIndex=0;
}this.selectedSkuIndex=idx;}}}if(this.coordupdateItemImageOnly){this.coordupdateItemImageOnly=false;return;}if(catalogEntry.listPriced&&catalogEntry.listPrice>catalogEntry.offerPrice){dojo.byId("pricecoordSKU").style.visibility="hidden";dojo.byId("pricecoordDisplay").style.visibility="visible";dojo.html.set(dojo.query(".listcoordprice")[0],catalogEntry.listPrice);
dojo.html.set(dojo.query(".offercoordprice")[0],catalogEntry.offerPrice);dojo.html.set(dojo.query(".savecoordprice")[0],catalogEntry.savePrice);dojo.byId("wascoordOverline").className="overlined";}if(catalogEntry.listPrice==catalogEntry.offerPrice){dojo.byId("pricecoordDisplay").style.visibility="hidden";
dojo.byId("pricecoordSKU").style.visibility="visible";dojo.html.set(dojo.query(".listPricecoordSKU")[0],catalogEntry.offerPrice);}dojo.html.set(dojo.query(".coordsku")[0],catalogEntry.catalogEntryIdentifier.externalIdentifier.partNumber);var catEntryId=this.resolvecoordSKU();var params=this.setCommonParams();
params.catalogEntryId=catEntryId;params.productDetailsPage=true;dojo.xhrPost({url:"MattelGlobalGetInventoryStatusByIDView",handleAs:"json-comment-filtered",content:params,service:this,load:MattelInventoryStatusJS.populateCoordInventoryDetails,error:function(errObj,ioArgs){console.debug("QuickInfoJS.selectItem: Unexpected error occurred during an xhrPost request.");
}});},displayItemDetails:function(catalogEntry){var sceneImageUrls=dojo.query(".s7thumb").style("backgroundImage");var imageList=new Array();if(null!=sceneImageUrls){for(i=0;i<sceneImageUrls.length;i++){startIndex=sceneImageUrls[i].indexOf("Mattel/")+7;endIndex=sceneImageUrls[i].indexOf("?");imageList[i]=sceneImageUrls[i].substring(startIndex,endIndex);
}}if(null!=this.catEntryParams){for(idx in this.catEntryParams.skus){if(null!=this.catEntryParams.skus[idx]&&(this.catEntryParams.skus[idx].id==catalogEntry.catalogEntryIdentifier.uniqueID)){if(null==this.selectedThumbnailIndex){this.selectedThumbnailIndex=0;}this.selectedSkuIndex=idx;thumbNail=this.catEntryParams.skus[idx].thumbnail;
if(null!=this.catEntryParams.skus[idx].thumbnail){for(i=0;i<imageList.length;i++){if(imageList[i]==thumbNail){s7swatches.selectSwatch(i,true);}}}}}}if(dojo.byId("catQuickFlag")!="undefined"&&dojo.byId("catQuickFlag").value==="true"){this.updateItemImageOnly=false;}if(this.updateItemImageOnly){dojo.byId("catQuickFlag").value="true";
this.updateItemImageOnly=false;return;}var partNumberObj=document.getElementById("partnumber");if(undefined!=partNumberObj&&null!=partNumberObj){console.info("partNumber: "+catalogEntry.catalogEntryIdentifier.externalIdentifier.partNumber);document.getElementById("partnumber").value=catalogEntry.catalogEntryIdentifier.externalIdentifier.partNumber;
}console.info("catalogEntry.listPriced: "+catalogEntry.listPriced);console.info("catalogEntry.listPrice: "+catalogEntry.listPrice);console.info("catalogEntry.offerPrice: "+catalogEntry.offerPrice);if("undefined"!=typeof(RequisitionList)&&undefined!=RequisitionList&&null!=RequisitionList){RequisitionList.itemPriceforUpdateItem=catalogEntry.offerPrice;
}if(catalogEntry.listPriced&&catalogEntry.listPrice>catalogEntry.offerPrice){RequisitionList.itemPriceforUpdateItem=catalogEntry.offerPrice;var priceDisplay=dojo.byId("priceDisplay");if(priceDisplay){priceDisplay.style.visibility="hidden";}var priceSKU=dojo.byId("priceSKU");if(priceSKU){priceSKU.style.visibility="visible";
}if(dojo.query(".listprice")[0]!=undefined&&dojo.query(".listprice")[0]!=null){dojo.html.set(dojo.query(".listprice")[0],catalogEntry.listPrice);}if(dojo.query(".offerprice")[0]!=undefined&&dojo.query(".offerprice")[0]!=null){dojo.html.set(dojo.query(".offerprice")[0],catalogEntry.offerPrice);}if(dojo.query(".saveprice")[0]!=undefined&&dojo.query(".saveprice")[0]!=null){dojo.html.set(dojo.query(".saveprice")[0],catalogEntry.savePrice);
}var wasOverline=dojo.byId("wasOverline");if(wasOverline){wasOverline.className="overlined";}}if(catalogEntry.listPrice==catalogEntry.offerPrice){RequisitionList.itemPriceforUpdateItem=catalogEntry.offerPrice;var priceDisplay=dojo.byId("priceDisplay");if(priceDisplay){priceDisplay.style.visibility="hidden";
}var priceSKU=dojo.byId("priceSKU");if(priceSKU){priceSKU.style.visibility="visible";}var listPriceSKU=dojo.query(".listPriceSKU")[0];if(listPriceSKU&&typeof catalogEntry.offerPrice!="undefined"){dojo.html.set(listPriceSKU,catalogEntry.offerPrice);}}var catEntryId=this.resolveSKU();var params=this.setCommonParams();
params.catalogEntryId=catEntryId;params.productDetailsPage=true;dojo.xhrPost({url:"MattelGlobalGetInventoryStatusByIDView",handleAs:"json-comment-filtered",content:params,service:this,load:MattelInventoryStatusJS.populateInventoryDetails,error:function(errObj,ioArgs){console.debug("QuickInfoJS.selectItem: Unexpected error occurred during an xhrPost request.");
}});},validate:function(){if(this.catEntryParams.type=="ProductBean"&&(null==this.catEntryParams.attributes||"undefined"==this.catEntryParams.attributes)){MessageHelper.displayMattelErrorMessage(storeNLS["ERR_RESOLVING_SKU"]);return false;}else{if(!isPositiveInteger(this.catEntryQuantity)){MessageHelper.displayMattelErrorMessage(storeNLS["QUANTITY_INPUT_ERROR"]);
return false;}}return true;},validate:function(){if(this.catEntryParams.type=="ProductBean"&&(null==this.catEntryParams.attributes||"undefined"==this.catEntryParams.attributes)){MessageHelper.displayMattelErrorMessage(storeNLS["ERR_RESOLVING_SKU"]);return false;}else{if(!isPositiveInteger(this.catEntryQuantity)){MessageHelper.displayMattelErrorMessage(storeNLS["QUANTITY_INPUT_ERROR"]);
return false;}}return true;},setCatEntryQty:function(quantityBox){this.catEntryQuantity=quantityBox.value;console.info("qty :"+this.catEntryQuantity);},add2ShopCart:function(customParams){var childCats="";if(undefined!=document.getElementById("actionType")&&undefined!=document.getElementById("popupAddClose")){document.getElementById("actionType").value=customParams;
}var quickSellItems=null;if(undefined!=document.getElementById("quickSellSelectedItems")){quickSellItems=document.getElementById("quickSellSelectedItems").value;}var retFlag=false;if(document.getElementById("qty_"+1)!=null&&document.getElementById("qty_"+1)!=undefined){this.catEntryQuantity=document.getElementById("qty_"+1).value;
}console.info("qty :"+this.catEntryQuantity);if(this.catEntryQuantity=="0"){return;}var sku=this.resolveSKU();if(sku==-1){if(document.getElementById("WC_QuickInfo_SwatchColor")!=undefined&&document.getElementById("WC_QuickInfo_SwatchColor").value==""){$("#errorMsgSwatchColor").show();retFlag=true;}if(document.getElementById("WC_QuickInfo_SwatchSize")!=undefined&&document.getElementById("WC_QuickInfo_SwatchSize").value==""){$("#errorMsgSwatchSize").show();
retFlag=true;}}if(retFlag){return;}this.setValues();if(!this.validate()){return;}this.params=null;if(null==this.params){this.params=this.setCommonParams();this.params.orderId=".";this.params.calculationUsage="-1,-2,-5,-6,-7,-21";this.params.calculateOrder="1";this.params.mattelOrderType="Standard Orders";
this.params.inventoryValidation="true|Standard Orders";}if(this.catEntryParams.type.toLowerCase()=="itembean"||this.catEntryParams.type.toLowerCase()=="packagebean"||this.catEntryParams.type.toLowerCase()=="dynamickitbean"){updateParamObject(this.params,"catEntryId",this.catEntryParams.id,false,-1);updateParamObject(this.params,"quantity",this.catEntryQuantity,false,-1);
}else{var sku=this.resolveSKU();if(-1==sku){MessageHelper.displayMattelErrorMessage(storeNLS["ERR_RESOLVING_SKU"]);return;}else{var idx=1;var childCatentryId="childCatentryIds_"+sku;updateParamObject(this.params,"catEntryId",sku,false,-1);updateParamObject(this.params,"quantity",this.catEntryQuantity,false,-1);
if(document.getElementById(childCatentryId)!=null&&document.getElementById(childCatentryId).value!=null&&document.getElementById(childCatentryId).value!=""){var childCatentry=document.getElementById(childCatentryId).value;if(childCatentry!=null&&childCatentry!=""){if(childCatentry.indexOf("_")!=-1){var childCatentryIds=childCatentry.split("_");
if(childCatentryIds!=null){for(var i=0;i<childCatentryIds.length;i++){updateParamObject(this.params,"catEntryId",childCatentryIds[i],false,i+2);updateParamObject(this.params,"quantity",this.catEntryQuantity,false,i+2);childCats=childCats+childCatentryIds[i];if(i<childCatentryIds.length-1){childCats=childCats+"_";
}idx++;}updateParamObject(this.params,"parentCatentryId",sku,false,-1);updateParamObject(this.params,"childCatentryIdsForSet",childCats,false,-1);updateParamObject(this.params,"productoperationType","WCSSet",false,-1);updateParamObject(this.params,"actioncode","create",false,-1);}}}}if(quickSellItems!=null&&quickSellItems!=""){var quickSellItemsArr=[];
quickSellItemsArr=quickSellItems.split("|");for(i in quickSellItemsArr){this.params["catEntryId_"+(i+1)+idx]=quickSellItemsArr[i];this.params["quantity_"+(i+1)+idx]=this.catEntryQuantity;}}}}var shopCartService="AjaxAddOrderItem";if(customParams!=null&&customParams!="undefined"){for(i in customParams){this.params[i]=customParams[i];
}if(customParams["catalogEntryType"]=="dynamicKit"){shopCartService="AddPreConfigurationToCart";}}if(this.params["catalogEntryType"]=="dynamicKit"){shopCartService="AddPreConfigurationToCart";}if(submitRequest()){$("#addTocartLoadIconQV").css("display","block");$("#addTocartLoadIcon").css("display","block");
wc.service.invoke(shopCartService,this.params);}},add2CSRShopCart:function(customParams,childCatentryIds){var retFlag=false;var sku=this.resolveSKU();var childCats="";if(sku==-1){if(document.getElementById("WC_QuickInfo_SwatchColor")!=undefined&&document.getElementById("WC_QuickInfo_SwatchColor").value==""){$("#errorMsgSwatchColor").show();
retFlag=true;}if(document.getElementById("WC_QuickInfo_SwatchSize")!=undefined&&document.getElementById("WC_QuickInfo_SwatchSize").value==""){$("#errorMsgSwatchSize").show();retFlag=true;}}if(retFlag){return;}if(this.selectedCatentryId!=null&&this.selectedCatentryId!=-1){if(this.replaceOrderItemId!=null&&this.replaceOrderItemId!=""&&$("#isASet").val()!="true"){var params=[];
params["catEntryId"]=this.selectedCatentryId;params["replaceOrderItemId"]=this.replaceOrderItemId;wc.service.invoke("MattelAjaxReplaceOrderItem",params);}else{var csrParams=[];if($("#isASet").val()){csrParams["isASet"]=true;$("#addedServicesFlag").val("true");}else{$("#addedServicesFlag").val("false");
}csrParams["catEntryId_1"]=this.selectedCatentryId;csrParams["quantity_1"]=(this.catEntryQuantity==undefined||this.catEntryQuantity=="")?1:this.catEntryQuantity;var idx=2;var childCatentryId="childCatentryIds_"+sku;if(document.getElementById(childCatentryId)!=null&&document.getElementById(childCatentryId).value!=null&&document.getElementById(childCatentryId).value!=""){var childCatentry=document.getElementById(childCatentryId).value;
if(childCatentry!=null&&childCatentry!=""){if(childCatentry.indexOf("_")!=-1){var childCatentryIds=childCatentry.split("_");if(childCatentryIds!=null){for(var i=0;i<childCatentryIds.length;i++){csrParams["catEntryId_"+idx]=childCatentryIds[i];csrParams["quantity_"+idx]=csrParams["quantity_1"];childCats=childCats+childCatentryIds[i];
if(i<childCatentryIds.length-1){childCats=childCats+"_";}idx++;}csrParams["parentCatentryId"]=sku;csrParams["childCatentryIdsForSet"]=childCats;csrParams["productoperationType"]="WCSSet";csrParams["actioncode"]="create";}}}}var quickSellItems=null;if(undefined!=document.getElementById("quickSellSelectedItems")){quickSellItems=document.getElementById("quickSellSelectedItems").value;
}if(quickSellItems!=null&&quickSellItems!=""){var quickSellItemsArr=[];quickSellItemsArr=quickSellItems.split("|");for(var i=0;i<quickSellItemsArr.length;i++,idx++){csrParams["catEntryId_"+idx]=quickSellItemsArr[i];csrParams["quantity_"+idx]=csrParams["quantity_1"];}}csrParams["calculationUsage"]="-1,-5,-6,-7,-21";
csrParams["calculateOrder"]="1";if($("#currentlyEditedOrderId")!=undefined&&$("#currentlyEditedOrderId").val()!=undefined&&$("#currentlyEditedOrderId").val().length>0){csrParams["orderId"]=$("#currentlyEditedOrderId").val();}if(this.orderSource!=null){csrParams["orderSource"]=this.orderSource;}if(this.orderType!=null){csrParams["orderType"]=this.orderType;
}if(this.glCode!=null){csrParams["glCode"]=this.glCode;}var orderType=document.getElementById("orderTypeSelect");if(orderType!=undefined&&orderType!=null){if(orderType.item(orderType.selectedIndex).value!=0){csrParams["orderType"]=orderType.item(orderType.selectedIndex).value;}}var orderSource=document.getElementById("orderSourceSelect");
if(orderSource!=undefined&&orderSource!=null){if(orderSource.item(orderSource.selectedIndex).value!=0){csrParams["orderSource"]=orderSource.item(orderSource.selectedIndex).value;}}wc.service.invoke("AjaxCsrAddOrderItem",csrParams);}}},add2CSRReturnOrderShopCart:function(rmaId){if(rmaId==undefined||rmaId.length==0){rmaId=$("#rmaId").val();
}if(this.selectedCatentryId!=null){var parameters={};parameters.returnQuantity=(this.catEntryQuantity==undefined)?1:this.catEntryQuantity;parameters.returnWithoutOrderNumber=true;parameters.catEntryId=this.selectedCatentryId;parameters.rmaId=rmaId;if(this.replaceOrderItemId!=null&&this.replaceOrderItemId!=""){parameters.replaceItem=true;
parameters.replaceRMAItemId=this.replaceOrderItemId;QuickInfoJS.setReplaceOrderItemId("");}else{parameters.replaceItem=false;}$("#quickViewImage").trigger("close");wc.service.invoke("AjaxMattelReturnItemAddValidationCmd",parameters);}},resolveSKU:function(){if(undefined!=this.catEntryParams.skus){if(this.catEntryParams.skus.length==1){return this.catEntryParams.skus[0].id;
}for(idx=0;idx<this.catEntryParams.skus.length;idx++){var matches=0;var attributeCount=0;for(attribute in this.catEntryParams.skus[idx].attributes){attributeCount++;if(this.catEntryParams.attributes&&this.catEntryParams.skus[idx].attributes[attribute]==this.catEntryParams.attributes[attribute]){matches++;
}else{break;}}if(0!=matches&&matches==attributeCount){if(undefined!=document.getElementById("selectItem_"+this.catEntryParams.id)){document.getElementById("selectItem_"+this.catEntryParams.id).disabled=false;if(Mattel.storeName=="FPStore"||Mattel.storeName=="TTStore"){var inventoryStatusCheckId=document.getElementById("inventoryStatusCheck_"+this.catEntryParams.id).id;
if($("#"+inventoryStatusCheckId).val()!="S"){var inputId=document.getElementById("selectItem_"+this.catEntryParams.id).id;$("#"+inputId).parents("fieldset").removeClass("disabled").addClass("colored");}else{document.getElementById("selectItem_"+this.catEntryParams.id).disabled=true;}}if(shoppingActionsJS.bundleListArr.indexOf(this.catEntryParams.id)!=-1){shoppingActionsJS.bundleListArr.splice(shoppingActionsJS.bundleListArr.indexOf(this.catEntryParams.id),1);
}}if((Mattel.storeName=="HWCStore"||Mattel.storeName=="BCStore")&&this.catEntryParams.skus[idx].id!=-1){var catentId=this.catEntryParams.skus[idx].id;var partno=this.catEntryParams.skus[idx].partNumber;wc.render.updateContext("MattelHaveItWantItContext",{"onPageLoadRefresh":true,"catEntryIdentifier":catentId,"partNumber":partno,"isItem":"","styleHeader":"false"});
}return this.catEntryParams.skus[idx].id;}}}return -1;},resolvecoordSKU:function(){if(this.catEntryCoordParams.skus.length==1){return this.catEntryCoordParams.skus[0].id;}for(idx=0;idx<this.catEntryCoordParams.skus.length;idx++){var matches=0;var attributeCount=0;for(attribute in this.catEntryCoordParams.skus[idx].attributes){attributeCount++;
if(this.catEntryCoordParams.attributes&&this.catEntryCoordParams.skus[idx].attributes[attribute]==this.catEntryCoordParams.attributes[attribute]){matches++;}else{break;}}if(0!=matches&&matches==attributeCount){return this.catEntryCoordParams.skus[idx].id;}}return -1;},showQuickInfoButton:function(id){var quickInfoBtn=dojo.byId(id);
if(quickInfoBtn!=null&&quickInfoBtn!="undefined"){quickInfoBtn.style.visibility="visible";}},hideQuickInfoButton:function(id){var quickInfoBtn=dojo.byId(id);if(quickInfoBtn!=null&&quickInfoBtn!="undefined"){quickInfoBtn.style.visibility="";}},shiftTabHideQuickInfoButton:function(id,event){if((event.shiftKey)&&(event.keyCode==dojo.keys.TAB)){this.hideQuickInfoButton(id);
}},close:function(focusElement){$.v_modal.close();},setFocus:function(event){if(event.keyCode==dojo.keys.ESCAPE&&dojo.byId("catEntryParamsForJS")){var catEntryParams=dojo.byId("catEntryParamsForJS").value;var catEntryId=dojo.fromJson(catEntryParams).id;if(document.getElementById("catalogEntry_img"+catEntryId)){document.getElementById("catalogEntry_img"+catEntryId).focus();
}}},selectDefaultSwatch:function(){var swatchElement=dojo.query("a[id^='WC_QuickInfo_Swatch_']")[0];if(swatchElement){eval(dojo.attr(swatchElement,"href"));}},replaceCartItem:function(itemSequence){var prodId=document.getElementById("partNumber");this.setValues();if(!this.validate()){return;}try{if(prodId.value!=null||prodId.value!=undefined){analyticTagVar_addInfo=prodId.value;
Mattel.Analytics.addEvent("loadUpdateCartQVEvent");analyticTagVar_addInfo=undefined;}}catch(err){Mattel.Utils.log(err);}var catalogEntryId=this.resolveSKU();if(-1==catalogEntryId){MessageHelper.displayMattelErrorMessage(storeNLS["ERR_RESOLVING_SKU"]);return;}this.close();var addressId="";var shipModeId="";
var physicalStoreId="";var typeId=dojo.byId("shipmentTypeId");if(null!=dojo.byId("addressId_all")&&null!=dojo.byId("shipModeId_all")){if(null==typeId||typeId.value!="1"){addressId=dojo.byId("addressId_all").value;}else{if(null!=dojo.byId("physicalStoreId")){physicalStoreId=dojo.byId("physicalStoreId").value;
}}shipModeId=dojo.byId("shipModeId_all").value;}else{if(null!=dojo.byId("MS_ShipmentAddress_"+this.replaceOrderItemId)&&null!=dojo.byId("MS_ShippingMode_"+this.replaceOrderItemId)){addressId=dojo.byId("MS_ShipmentAddress_"+this.replaceOrderItemId).value;shipModeId=dojo.byId("MS_ShippingMode_"+this.replaceOrderItemId).value;
}}if(this.replaceOrderItemId!=""&&categoryDisplayJS){shoppingActionsJS.replaceItemAjaxHelper(catalogEntryId,this.catEntryQuantity,this.replaceOrderItemId,addressId,shipModeId,physicalStoreId,itemSequence);}else{console.error("categoryDisplayJS not defined");}},selectCurrentAttributes:function(){for(idx=0;
idx<this.catEntryParams.skus.length;idx++){var selectedSKU=this.catEntryParams.skus[idx];if(selectedSKU.id==this.itemId){for(attribute in selectedSKU.attributes){var selectNode=dojo.query("select[alt='"+attribute+"']")[0];if(selectNode){selectNode.value=selectedSKU.attributes[attribute];this.setSelectedAttribute(attribute,selectNode.value);
}else{var attrValue=selectedSKU.attributes[attribute];this.selectSwatch(attribute,attrValue,"quickInfoSwatch_"+attribute+"_"+attrValue,"quickInfoSwatch_"+attribute+"_");}}this.notifyAttributeChange();this.selectItem(true);dojo.byId("WC_QuickInfo_input_quantity").disabled=true;dojo.byId("WC_QuickInfo_input_quantity").value=this.catEntryQuantity;
return;}}},getQuickInfoImage:function(fullImage){if(fullImage==""){return fullImage;}return fullImage.replace(this.productImgDimensions,this.quickInfoImgDimensions);},openAddOnModal:function(url,isProduct){var retFlag=false;if(document.getElementById("qty_"+1)!=null&&document.getElementById("qty_"+1)!=undefined){this.catEntryQuantity=document.getElementById("qty_"+1).value;
}console.info("qty :"+this.catEntryQuantity);if(this.catEntryQuantity=="0"){return;}console.info("isProduct: "+isProduct);if(isProduct=="true"||isProduct==true){console.info("Inside");var sku=this.resolveSKU();if(sku==-1){if(document.getElementById("WC_QuickInfo_SwatchColor")!=undefined&&document.getElementById("WC_QuickInfo_SwatchColor").value==""){$("#errorMsgSwatchColor").show();
retFlag=true;}if(document.getElementById("WC_QuickInfo_SwatchSize")!=undefined&&document.getElementById("WC_QuickInfo_SwatchSize").value==""){$("#errorMsgSwatchSize").show();retFlag=true;}}}console.info("retFlag: "+retFlag);if(retFlag){return;}$.v_modal({transition:"fade",href:url,onComplete:function(){$(this).v_modal.resize();
}});},reloadVariablesOnLoad:function(){this.selectedAttributes=new Object();this.selectedAttributesQV=new Object();},checkInventorySwatch:function(){var retFlag=false;var sku=this.resolveSKU();if(sku==-1){if(document.getElementById("WC_QuickInfo_SwatchColor")!=undefined&&document.getElementById("WC_QuickInfo_SwatchColor").value==""){$("#errorMsgSwatchColor").show();
retFlag=true;}if(document.getElementById("WC_QuickInfo_SwatchSize")!=undefined&&document.getElementById("WC_QuickInfo_SwatchSize").value==""){$("#errorMsgSwatchSize").show();retFlag=true;}}if(retFlag){$("#storeLocDropDown").css("display","none");}else{$("#storeLocDropDown").css("display","block");$("#checkAvailabilityStatus").css("display","none");
}}};}