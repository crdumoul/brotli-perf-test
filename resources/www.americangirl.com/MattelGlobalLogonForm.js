dojo.require("wc.service.common");MattelGlobalLogonForm={langId:"-1",storeId:"",catalogId:"",setCommonParameters:function(langId,storeId,catalogId){this.langId=langId;this.storeId=storeId;this.catalogId=catalogId;},prepareLogonSubmit:function(form,orderMoveURL,afterOrderCalculateURL){document.getElementById("logPassword_err").innerHTML="";
var logonId=document.getElementById("logEmail").value.trim();reWhiteSpace=new RegExp(/^\s+$/);var exp=/^[a-zA-Z0-9]+$/;var regPassword=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}/;var fpage=document.getElementById("t_fromPage");var regUname=/^[A-Za-z0-9].*$/;var errorPresent=false;if(form.logEmail!=null&&reWhiteSpace.test(logonId)||logonId==""||logonId.length<5){errorPresent=true;
}if(!regUname.test(logonId)){errorPresent=true;}form.logPassword.value=form.logPassword.value;if(form.logPassword!=null&&reWhiteSpace.test(form.logPassword.value)||form.logPassword.value==""||form.logPassword.length<8){errorPresent=true;}if(!regPassword.test(form.logPassword.value)){errorPresent=true;
}if(errorPresent==true){mattelContinueRequest=false;this.mattelFormErrorHandleClient(form.logPassword.id,MessageHelper.messages["ERROR_LogonError"]);Mattel.Analytics.publishFormErrors();}else{document.getElementById("logEmail").value=document.getElementById("logEmail").value.trim();if(afterOrderCalculateURL!=""){var completeOrderMoveURL=orderMoveURL;
completeOrderMoveURL=completeOrderMoveURL+"&URL=OrderCalculate?URL="+afterOrderCalculateURL+"&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7";document.getElementById("URL").value=completeOrderMoveURL;}if(fpage!=null||fpage!=undefined){if(fpage.value=="AGbrandCheckout"){Mattel.Analytics.addEvent("loadCheckoutUserRegEvent");
}else{Mattel.Analytics.addEvent("loadMyAccSigninEvent");}}if(!continueRequest()){console.debug("inside condition");return;}console.debug("outside condition");form.submit();}},prepareRegSubmit:function(form){document.getElementById("firstName_err").innerHTML="";document.getElementById("lastName_err").innerHTML="";
document.getElementById("email1_err").innerHTML="";document.getElementById("logonId_err").innerHTML="";document.getElementById("regPassword_err").innerHTML="";document.getElementById("verifyPass_err").innerHTML="";document.getElementById("dob_year_err").innerHTML="";document.getElementById("dob_month_err").innerHTML="";
document.getElementById("dob_day_err").innerHTML="";reWhiteSpace=new RegExp(/^\s+$/);var exp=/^[A-Za-z].*$/;var regNameExp=/^[a-zA-Z 0-9_,.()'-]+[a-zA-Z0-9]+[.]*$/;var errorPresent=false;form.firstName.value=form.firstName.value.trim();if(form.firstName!=null&&reWhiteSpace.test(form.firstName.value)&&regNameExp.test(form.firstName.value)||form.firstName.value==""){this.mattelFormErrorHandleClient(form.firstName.id,MessageHelper.messages["ERROR_FirstNameWrong"]);
errorPresent=true;}if(form.firstName!=null&&!regNameExp.test(form.firstName.value)){this.mattelFormErrorHandleClient(form.firstName.id,MessageHelper.messages["ERROR_FirstNameWrong"]);errorPresent=true;}form.lastName.value=form.lastName.value.trim();if(form.lastName!=null&&reWhiteSpace.test(form.lastName.value)&&regNameExp.test(form.lastName.value)||form.lastName.value==""){this.mattelFormErrorHandleClient(form.lastName.id,MessageHelper.messages["ERROR_LastNameWrong"]);
errorPresent=true;}if(form.lastName!=null&&!regNameExp.test(form.lastName.value)){this.mattelFormErrorHandleClient(form.lastName.id,MessageHelper.messages["ERROR_LastNameWrong"]);errorPresent=true;}if(form.dob_year.value==0&&form.dob_month.value==0&&form.dob_day.value==0){this.mattelFormErrorHandleClient(form.dob_year.id,MessageHelper.messages["ERROR_DateEmpty"]);
errorPresent=true;}if(form.dob_year.value!=0||form.dob_month.value!=0||form.dob_day.value!=0){if(form.dob_year.value==0){this.mattelFormErrorHandleClient(form.dob_year.id,MessageHelper.messages["ERROR_DateEmpty"]);errorPresent=true;}if(form.dob_month.value==0){this.mattelFormErrorHandleClient(form.dob_year.id,MessageHelper.messages["ERROR_DateEmpty"]);
errorPresent=true;}if(form.dob_day.value==0){this.mattelFormErrorHandleClient(form.dob_year.id,MessageHelper.messages["ERROR_DateEmpty"]);errorPresent=true;}var febDays=29;if(form.dob_year.value!=0&&((form.dob_year.value%4)!=0)){febDays=28;}var months=["4","6","9","11"];var monthFound=false;for(var i=0;
i<months.length;i++){if(months[i]==form.dob_month.value){monthFound=true;break;}}if(monthFound&&(form.dob_day.value>30)){this.mattelFormErrorHandleClient(form.dob_day.id,MessageHelper.messages["ERROR_DateEmpty"]);errorPresent=true;}if((form.dob_month.value==2)&&(form.dob_day.value>febDays)){this.mattelFormErrorHandleClient(form.dob_day.id,MessageHelper.messages["ERROR_DateEmpty"]);
errorPresent=true;}if(form.curr_year!=null&&form.curr_month!=null&&form.curr_date!=null){var dob_year=parseInt(form.dob_year.value);var dob_month=parseInt(form.dob_month.value);var dob_day=parseInt(form.dob_day.value);var curr_year=parseInt(form.curr_year.value);var curr_month=parseInt(form.curr_month.value);
var curr_date=parseInt(form.curr_date.value);if(dob_year>curr_year){this.mattelFormErrorHandleClient(form.dob_year.id,MessageHelper.messages["ERROR_DateEmpty"]);errorPresent=true;}else{if((dob_year==curr_year)&&(dob_month>curr_month)){this.mattelFormErrorHandleClient(form.dob_month.id,MessageHelper.messages["ERROR_DateEmpty"]);
errorPresent=true;}else{if((dob_year==curr_year)&&(dob_month==curr_month)&&(dob_day>curr_date)){this.mattelFormErrorHandleClient(form.dob_day.id,MessageHelper.messages["ERROR_DateEmpty"]);errorPresent=true;}}}}}form.email1.value=form.email1.value.trim();if(form.email1!=null&&reWhiteSpace.test(form.email1.value)||form.email1.value==""||form.email1.value.length<=5){this.mattelFormErrorHandleClient(form.email1.id,MessageHelper.messages["ERROR_INVALIDEMAILFORMAT"]);
errorPresent=true;}if(!MessageHelper.isValidEmail(form.email1.value)){this.mattelFormErrorHandleClient(form.email1.id,MessageHelper.messages["ERROR_INVALIDEMAILFORMAT"]);errorPresent=true;}var regUname=/^[a-zA-Z0-9?@_!#$.,()&'-]+$/;form.logonId.value=form.logonId.value.trim();if((form.logonId!=null&&reWhiteSpace.test(form.logonId.value))||!(form.logonId.value.length>=5&&form.logonId.value.length<=50)){if(form.logonId.value.length>=5){this.mattelFormErrorHandleClient(form.logonId.id,MessageHelper.messages["ERROR_MoreLogonIdEmpty"]);
}else{this.mattelFormErrorHandleClient(form.logonId.id,MessageHelper.messages["ERROR_LogonIdEmpty"]);}errorPresent=true;}else{if(typeof this.validateLoginId=="function"){if(!this.validateLoginId(form.logonId)){errorPresent=true;}}}if(!regUname.test(form.logonId.value)){this.mattelFormErrorHandleClient(form.logonId.id,MessageHelper.messages["ERROR_MoreLogonIdEmpty"]);
errorPresent=true;}var re=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}/;var pwdError=false;form.logonPassword.value=form.logonPassword.value.trim();if(form.logonPassword!=null&&reWhiteSpace.test(form.logonPassword.value)||form.logonPassword.value==""||form.logonPassword.length<8){errorPresent=true;pwdError=true;
}if(!re.test(form.logonPassword.value)){errorPresent=true;pwdError=true;}form.logonPasswordVerify.value=form.logonPasswordVerify.value.trim();if(form.logonPasswordVerify!=null&&reWhiteSpace.test(form.logonPasswordVerify.value)||form.logonPasswordVerify.value==""||pwdError==true){this.mattelFormErrorHandleClient(form.logonPasswordVerify.id,MessageHelper.messages["ERROR_PasswordWrong"]);
errorPresent=true;}if((form.logonPassword.value!=form.logonPasswordVerify.value)&&pwdError!=true){this.mattelFormErrorHandleClient(form.logonPasswordVerify.id,MessageHelper.messages["PWDREENTER_DO_NOT_MATCH"]);errorPresent=true;}if(form.logonId!=null&&reWhiteSpace.test(form.logonId.value)||form.logonId.value==""){this.mattelFormErrorHandleClient(form.logonId.id,MessageHelper.messages["ERROR_LogonIdEmpty"]);
errorPresent=true;}else{if(typeof this.validateLoginId=="function"){if(!this.validateLoginId(form.logonId)){errorPresent=true;}}}if(form.dob_year.value!=0&&form.dob_month.value!=0&&form.dob_day.value!=0){var dob_year=parseInt(form.dob_year.value);var dob_month=parseInt(form.dob_month.value);var dob_day=parseInt(form.dob_day.value);
var curr_year=parseInt(form.curr_year.value);var curr_month=parseInt(form.curr_month.value);var curr_date=parseInt(form.curr_date.value);if((curr_year-dob_year)<18){MattelAddressHelper.getAgeValidationCookie("ageValidation",this.storeId,false);$("#ageScreeningPopup").click();errorPresent=false;return false;
}else{if((curr_year-dob_year)==18){if(curr_month<dob_month){MattelAddressHelper.getAgeValidationCookie("ageValidation",this.storeId,false);$("#ageScreeningPopup").click();errorPresent=false;return false;}else{if((curr_month==dob_month)&&(curr_date<dob_day)){MattelAddressHelper.getAgeValidationCookie("ageValidation",this.storeId,false);
$("#ageScreeningPopup").click();errorPresent=false;return false;}}}}MattelAddressHelper.getAgeValidationCookie("ageValidation",this.storeId,true);form.userField2.value=dob_year+"-"+dob_month+"-"+dob_day;}if(form.sendMeEmail&&form.sendMeEmail.checked){form.receiveEmail.value=true;}else{form.receiveEmail.value=false;
}if(true==errorPresent){mattelContinueRequest=false;Mattel.Analytics.publishFormErrors();return false;}else{var ageValidation=MattelAddressHelper.readCookie("ageValidation",this.storeId);if(ageValidation==false||ageValidation=="false"){$("#ageScreeningPopup").click();return false;}if(!continueRequest()){console.debug("inside condition");
return;}console.debug("outside condition");Mattel.Analytics.addEvent("loadMyAccRegisterEvent");form.submit();}},sendPasswordNotification:function(serviceId,form){var reWhiteSpace=new RegExp(/^\s+$/);var errorPresent=false;document.getElementById("userName_err").innerHTML="";var regUname=/^[A-Za-z].*$/;
form.userName.value=form.userName.value.trim();if(form.userName!=null&&reWhiteSpace.test(form.userName.value)||form.userName.value==""||form.userName.value.length<5){this.mattelFormErrorHandleClient(form.userName.id,MessageHelper.messages["ERROR_UserIdEmpty"]);errorPresent=true;}else{if(typeof this.validateLoginId=="function"){if(!this.validateLoginId(form.userName)){errorPresent=true;
}}}if(!regUname.test(form.userName.value)){this.mattelFormErrorHandleClient(form.userName.id,MessageHelper.messages["ERROR_UserIdEmpty"]);errorPresent=true;}if(true==errorPresent){Mattel.Analytics.publishFormErrors();return false;}else{wc.service.getServiceById(serviceId).formId=form.id;wc.service.invoke(serviceId);
return true;}return false;},mattelFormErrorHandleClient:function(id,errorMessage){var element=dojo.byId(id);if(errorMessage==null){console.debug("formErrorHandleClient: The error message is null.");return;}if(element){var errNode=dojo.byId(id+"_err");if(dojo.isIE<7){node.innerHTML=errorMessage+"<iframe id='errorMessageIFrame' scrolling='no' frameborder='0' src='"+imgDirPath+"images/empty.gif'></iframe>";
}else{errNode.innerHTML=errorMessage;}}},forgotPasswordEvent:function(){var fpage=document.getElementById("t_fromPage");if(fpage!=null||fpage!=undefined){if(fpage.value=="AGbrandCheckout"){Mattel.Analytics.addEvent("loadForgotPasswordChkoutEvent");}else{Mattel.Analytics.addEvent("loadMyAccForgotPasswordEvent");
}}}};