wc.service.declare({id:"DynamicEndecaSearch",actionId:"DynamicEndecaSearch",url:getAbsoluteURL()+"AjaxDynamicEndecaSearch",type:"get",formId:"",successHandler:function(serviceResponse){cursor_clear();try{var result=serviceResponse.result;var criteria=serviceResponse.criteria;if(result&&result.length>0){var options=result.split("@||@");
var inner="";var foot="</div>";for(i=0;i<options.length;i++){var attrs=options[i].split("@|@");var parameterID=attrs[0];var name=attrs[1];var criteriaUP=criteria.toUpperCase();var optionUP=options[i].toUpperCase();var textToReplace="";if(optionUP.indexOf(criteriaUP)!=-1&&i<7){var replaced=name.split(" ").join("+");
var head='<div class="endecaSearch" onclick="javascript:prepareEndecaSearch(\'endSearch'+i+"');\">";textToReplace=options[i].substring(optionUP.indexOf(criteriaUP),optionUP.indexOf(criteriaUP)+criteria.length);inner=inner+head;var URL=dojo.byId("searchDisplayURL").value;URL=URL+"&parameterID="+parameterID;
URL=URL+"&criteria="+replaced;inner=inner+'<a class="endecaSearch" href='+URL+">";inner=inner+name.replace(textToReplace,"<strong>"+textToReplace+"</strong>");inner=inner+"</a>";inner=inner+foot;}}dojo.byId("endecaSearchResultListPopup").innerHTML=inner;openEndecaResultPopUp();}}catch(e){}},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage);
}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey);}}cursor_clear();}});function constructDynamicEndecaSearch(params){$.ajax({url:getAbsoluteURL()+"AjaxDynamicEndecaSearch",type:"get",data:params,success:function(serviceResponse){serviceResponse=serviceResponse.replace("/*","");
serviceResponse=serviceResponse.replace("*/","");serviceResponse=JSON.parse(serviceResponse);cursor_clear();try{var result=serviceResponse.result;var criteria=serviceResponse.criteria;if(result&&result.length>0){var options=result.split("@||@");var inner="";var foot="</div>";for(i=0;i<options.length;
i++){var attrs=options[i].split("@|@");var parameterID=attrs[0];var nameAndCatentryId=attrs[1];var nameAndCatentryIdArr=nameAndCatentryId.split("@|||@");var name=nameAndCatentryIdArr[0];var catentryId=nameAndCatentryIdArr[1];var criteriaUP=criteria.toUpperCase();var optionUP=options[i].toUpperCase();
var textToReplace="";if(optionUP.indexOf(criteriaUP)!=-1&&i<7){var replaced=name.split(" ").join("+");var head='<div class="endecaSearch" onclick="javascript:prepareEndecaSearch(\'endSearch'+i+"');\">";textToReplace=options[i].substring(optionUP.indexOf(criteriaUP),optionUP.indexOf(criteriaUP)+criteria.length);
inner=inner+head;var URL=dojo.byId("searchDisplayURL").value;URL=URL+"&parameterID="+parameterID;URL=URL+"&catentryId="+catentryId;URL=URL+"&criteria="+replaced;inner=inner+'<a class="endecaSearch" href='+URL+">";inner=inner+name.replace(textToReplace,"<strong>"+textToReplace+"</strong>");inner=inner+"</a>";
inner=inner+foot;}}if(inner!=""){dojo.byId("endecaSearchResultListPopup").innerHTML=inner;openEndecaResultPopUp();}}}catch(e){}}});}function dynamicEndecaSearch(value,storeId,catalogId,langId){var minType=dojo.byId("minTypeAhead").value;if(value&&value.length>=minType){var params={};params.criteria=value;
params.storeId=storeId;params.catalogId=catalogId;params.langId=langId;cursor_wait();constructDynamicEndecaSearch(params);}else{closeEndecaResultPopUp();}}function launchEndecaSearch(){var url=dojo.byId("hidSearch").value;var criteria=dojo.byId("search").value;var isEmpty=false;if($("#search").val()==$("#search").attr("placeholder")){isEmpty=true;
}if(url&&url.length>0){if(criteria&&criteria.length>0){url=url+"&criteria="+criteria;}if(!isEmpty){parent.window.location.href=url;}}}function prepareEndecaSearch(obj){dojo.byId("search").value=dojo.byId(obj).value;closeEndecaResultPopUp();launchEndecaSearch();}function openEndecaResultPopUp(){var popup=dojo.byId("endecaSearchResultListPopup");
if(popup!=null){var s=$(".headerNav #search"),p=s.position(),h=s.height(),m=parseInt(s.css("margin-top").replace(/[^-\d\.]/g,"")),pt=parseInt(s.css("padding-top").replace(/[^-\d\.]/g,"")),pb=parseInt(s.css("padding-bottom").replace(/[^-\d\.]/g,""));popup.style.top=(p.top+h+pt+pb+m+3)+"px";popup.style.left=p.left+"px";
popup.style.display="block";}else{console.debug("endecaSearchResultListPopup"+" does not exist");}}function closeEndecaResultPopUp(){var popup=dojo.byId("endecaSearchResultListPopup");if(popup!=null){popup.innerHTML="";popup.style.display="none";}else{console.debug("endecaSearchResultListPopup"+" does not exist");
}}function changePageSize(items){var url=dojo.byId("urlChangePage").value;url=url+"&itemsPage="+items;window.location.href=url;}function changeGalleryItemsPageSize(items){var url=dojo.byId("urlGalleryGarageChangePage").value;url=url+"&galleryGarageItemsPage="+items;window.location.href=url;}function changeGalleryGarageCollPageSize(items){var url=dojo.byId("urlGalleryGarageCollChangePage").value;
url=url+"&galleryGarageCollItemsPage="+items;window.location.href=url;}function changeBlogPostPageSize(items){var url=dojo.byId("urlBlogPostPageSizeChange").value;url=url+"&blogPostItemsPage="+items;window.location.href=url;}function changeCollProfPageSize(items){var url=dojo.byId("urlCollProfPageSizeChange").value;
url=url+"&collProfItemsPage="+items;window.location.href=url;}function changeSorting(sortType){var url=dojo.byId("urlChangeSorting").value;url=url+"&sortBy="+sortType;window.location.href=url;}function changeGalleryGarageItemsSorting(sortType){var url=dojo.byId("urlGalleryGarageChangeSorting").value;
url=url+"&galleryGarageSortBy="+sortType;window.location.href=url;}function changeGalleryGarageCollSorting(sortType){var url=dojo.byId("urlGalleryGarageCollChangeSorting").value;url=url+"&galleryGarageCollSortBy="+sortType;window.location.href=url;}function changeBlogPostSorting(sortType){var url=dojo.byId("urlBlogPostChangeSorting").value;
url=url+"&blogPostSortBy="+sortType;window.location.href=url;}function changeCollProfSorting(sortType){var url=dojo.byId("urlCollProfChangeSorting").value;url=url+"&collProfSortBy="+sortType;window.location.href=url;}window.onload=function(){var search=dojo.byId("search");if(search!=null&&search!="undefined"){search.value="";
}window.onclick=function(){$("#endecaSearchResultListPopup").hide();};Mattel.PlaceHolderforSearchHWC.init();};