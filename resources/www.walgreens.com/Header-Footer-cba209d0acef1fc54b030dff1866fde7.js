var tabletMax992=1024;var windowWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var isCurrentPageIsTier3=false;var shopProductsHitMobile=false;if(windowWidth<768){shopProductsHitMobile=true;}var globalNavABtest="A";if(typeof newGlobalNav!=="undefined"&&newGlobalNav==true&&typeof LSGPageNav!=="undefined"&&LSGPageNav==true){var globalNavABtest="B";}var globalNavQueryString="";var urlPathName=window.location.pathname;if(urlPathName.search("/pharmacy/psc/")==-1){$(".wag-mobile-menu").removeClass("hide");}if((urlPathName.search("-tier3")>=0||urlPathName.search("productlist")>=0)&&(urlPathName.search("brandproductlist")==-1||urlPathName.search("beautyStore")==-1)){if($("#tier3Breadcrumb li a")[2]&&$("#tier3Breadcrumb li a")[2].innerHTML.search("Contact Lenses")==-1){isCurrentPageIsTier3=true;globalNavQueryString="?tier3="+isCurrentPageIsTier3;if(globalNavABtest=="B"){globalNavQueryString=globalNavQueryString+"&ABTest=B";}}else{if(globalNavABtest=="B"){globalNavQueryString=globalNavQueryString+"?ABTest=B";}}}else{if(globalNavABtest=="B"){globalNavQueryString=globalNavQueryString+"?ABTest=B";}}if(window.attachEvent){window.attachEvent("onload",browserSpecific);}else{window.addEventListener("load",browserSpecific,false);}if(windowWidth>tabletMax992){document.delayTime=300;}if(windowWidth<=tabletMax992){$(window).resize(function(){if(navigator.userAgent.search("Android")>-1){if($(".modal-backdrop").length&&$(".modal-backdrop").innerHeight()>window.innerHeight+50){$(".modal").scrollTop(50);}else{$(".modal").scrollTop(0);}}});}try{sessionStorage.setItem("ct","");}catch(e){}function browserSpecific(){if(typeof globalNavQueryString==="undefined"||globalNavQueryString===null){globalNavQueryString="";}$("#new-nav-main-menu").load("/assets/nav/template/GlobalHeaderNavigationElements_ab.jsp"+globalNavQueryString,function(){if(window.header&&window.header.profileInfo&&window.header.profileInfo.loggedIn==="true"){$(".loggedInUser").attr("href","/steps/brhc-loggedin.jsp");}if(urlPathName.search("/pharmacy/psc/")>-1){$(".wag-mobile-menu").hide();}if($(window).width()>=320&&$(window).width()<768){$("body").append('<section class="wag-slide-humbergunmenu"></section>');$(".wag-slide-humbergunmenu").html("<nav>"+$("nav").html()+"</nav>");$("#wag-header-mobile-slider").html("");$(".wag-slide-humbergunmenu").addClass("wag-top-nav clickerror desk");$(".container").attr("style","left:0%");$(".wag-top-header").css("z-index","0");$(".container").addClass("hamburger-menu-open");}$("#header-search").on("click",function(e){var url=window.location.href;var searchText=$("#ntt-placeholder").val();if(searchText&&url&&url.indexOf("results.jsp")>-1){if(typeof window.headerSearchEvent=="undefined"){return true;}$("#frmHeaderSearch").attr("onsubmit","return false;");window.headerSearchEvent(searchText,"");e.preventDefault();return false;}angular.element("#wag-typeaheadcontainer").hide();});$("#wag-userinfohamburger").replaceWith($("#wag-userinfo-widget-mobile"));$("#msgnotifications").replaceWith($(".wag-header-visible-xs-alert"));$("#wag-userinfo-widget-mobile").attr("style","display:block");headerHoverDisplay();var focuspointer=false;if(windowWidth>767){$(".wag-top-nav ul > li").focusin(function(){if(!focuspointer){focuspointer=$(this).attr("class").replace(" showMenuItems","").split(" ")[2];}if(focuspointer&&$(this).attr("class")&&$(this).attr("class").indexOf(focuspointer)<0){$("."+focuspointer).attr("aria-expanded","false");$("."+focuspointer).removeClass("showMenuItems");focuspointer=$(this).attr("class").replace(" showMenuItems","").split(" ")[2];}var sec=$(this).children().hasClass("wag-third-level-menu");if(sec==false){$(this).addClass("showMenuItems");$(this).attr("aria-expanded","true");}});}$("span#wag-youraccount-infomob").focusin(function(){if(windowWidth>767){$("#yourAccMList").show();}});$("#cartFocus").focusin(function(){$("#yourAccMList").hide();});if(windowWidth>tabletMax992){var timeOut,outTimeout,hoverTime,houtTime,timeToClose,c,d,previous,NeedToclose=[];$("nav ul.main_menu li.accordin-main").hover(function(){$(this).attr("aria-expanded","true");var a=d=$(this).find(".wag-second-level-menu");if(c!=undefined&&a.attr("class")==c.attr("class")&&a.parent().find("a:first").hasClass("activeTopMainMenu")){a.attr("style","display:block !important");a.parent().addClass("showMenuItems");clearTimeout(outTimeout);}hoverTime=new Date().getTime();timeOut=setTimeout(function(){a.attr("style","display:block !important");a.parent().addClass("showMenuItems");if(!a.parent().hasClass("wag-link-orange")){a.parent().find("a:first").addClass("activeTopMainMenu");}},document.delayTime);},function(){$(this).attr("aria-expanded","false");var a=$(this).find(".wag-second-level-menu");c=$(this).find(".wag-second-level-menu");houtTime=new Date().getTime();timeToClose=houtTime-hoverTime;previous=a;if(timeToClose<document.delayTime){clearTimeout(timeOut);}outTimeout=setTimeout(function(){if(previous&&previous.attr("class")&&previous.attr("class")==a.attr("class")){a.attr("style","display:none");a.parent().removeClass("showMenuItems");a.parent().find("a:first").removeClass("activeTopMainMenu");$("nav ul.main_menu li.accordin-main .wag-second-level-menu >li").removeClass("activeMenu showMenuItems3");$(".wag-second-level-menusymbol").show().parent().find(".css_arrow").remove();c=undefined;for(var close in NeedToclose){if(close!="messageArrayIndex"&&NeedToclose[close].attr&&d.attr("class")!=NeedToclose[close].attr("class")){NeedToclose[close].attr("style","display:none");NeedToclose[close].parent().removeClass("showMenuItems");NeedToclose[close].parent().find("a:first").removeClass("activeTopMainMenu");$("nav ul.main_menu li.accordin-main .wag-second-level-menu >li").removeClass("activeMenu showMenuItems3");$(".wag-second-level-menusymbol").show().parent().find(".css_arrow").remove();}}NeedToclose=[];}else{if(a.attr("class")){index=a.attr("class").replace(/ /g,".");if(!NeedToclose[index]){NeedToclose[index]=a;}}}},document.delayTime);});(function($){$.fn.hoverIntent=function(handlerIn,handlerOut,selector){var cfg={interval:500,sensitivity:6,timeout:0};if(typeof handlerIn==="object"){cfg=$.extend(cfg,handlerIn);}else{if($.isFunction(handlerOut)){cfg=$.extend(cfg,{over:handlerIn,out:handlerOut,selector:selector});}else{cfg=$.extend(cfg,{over:handlerIn,out:handlerIn,selector:handlerOut});}}var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY;};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if(Math.sqrt((pX-cX)*(pX-cX)+(pY-cY)*(pY-cY))<cfg.sensitivity){$(ob).off("mousemove.hoverIntent",track);ob.hoverIntent_s=true;return cfg.over.apply(ob,[ev]);}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=false;return cfg.out.apply(ob,[ev]);};var handleHover=function(e){var ev=$.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);}if(e.type==="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).on("mousemove.hoverIntent",track);if(!ob.hoverIntent_s){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}}else{$(ob).off("mousemove.hoverIntent",track);if(ob.hoverIntent_s){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob);},cfg.timeout);}}};return this.on({"mouseenter.hoverIntent":handleHover,"mouseleave.hoverIntent":handleHover},cfg.selector);};})(jQuery);function wagnavOver(){$("nav ul.main_menu li.accordin-main .wag-second-level-menu >li").removeClass("activeMenu showMenuItems3");$(this).addClass("activeMenu showMenuItems3");$(".wag-second-level-menusymbol").show().parent().find(".css_arrow").remove();$(this).find(".wag-second-level-menusymbol").hide().parent().prepend('<span class="css_arrow" style="border-width:'+(($(this).height()/2)+2.5)+"px 0px "+$(this).height()/2+'px 15px"></span>');}function wagnavOut(){}var config={sensitivity:2,interval:document.delayTime/2,over:wagnavOver,timeout:0,out:wagnavOut};$("nav ul.main_menu li.accordin-main .wag-second-level-menu >li").hoverIntent(config);$("nav ul.main_menu li.accordin-main .wag-second-level-menu >li").hover(function(){if($(this).find(".wag-tier1-width").length==2){$(this).find("#fourthLevelMenu").addClass("wag-third-level-menu");}else{if(globalNavABtest=="B"){$(this).find("#fourthLevelMenu").attr("style","width:252px !important;height:407px");}else{$(this).find("#fourthLevelMenu").attr("style","width:410px !important;height:"+Math.round($(this).parent().parent().find(".wag-second-level-menu").height()+29.5)+"px");$(this).find("#fourthLevelMenu").find(".accordin-main").attr("style","width:50%");}$(this).find(".wag-third-level-menu1").attr("style","width:100% !important");$(this).find(".wag-third-level-menu1").css({display:"inline-block"});}},function(){});}});function headerHoverDisplay(){if(typeof(window.innerWidth)=="number"){currentScreenWidth=window.innerWidth;}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){currentScreenWidth=document.documentElement.clientWidth;}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){currentScreenWidth=document.body.clientWidth;}}}$.fn.mobileHide=function(){$(this).addClass("wag-nav-hide");};$.fn.mobileShow=function(){$(this).removeClass("wag-nav-hide");};var showHideBlackBg=function(){if($(window).width()>=320&&$(window).width()<768){if($(".wag-opacity-cont-section").length<1){$("body").prepend('<section class="wag-opacity-cont-section"></section>');}}};var $wagtopnav=$(".wag-top-nav");var $window=$(window);var anchors=$(".accordin-main  a,.accordin-main section a");var accordionMain=$(".accordin-main");var navStore=[];var additionalMenu=$(".wag-header-links");accordionMain.find(">ul").mobileHide();accordionMain.find(">section .menu").mobileHide();$wagtopnav.find("li").each(function(index){$(this).attr("menu_index",index.toString());});additionalMenu.find("li").each(function(index){$(this).attr("menu_index","m"+index.toString());});additionalMenu.on("click","a",function(){sessionStoreClear("navStore");});var onloadwidth=windowWidth;$window.bind("resize",function(){if((window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)>767){$(".wag-header-reward-container-mobile, .wag-header-youraccount-mobile, .wag-top-nav nav, .wag-body-container-wrapper").show();$(".wag-opacity-cont").remove();$(".wag-mobile-menu").removeClass("hamburger-menu-open");}else{if(onloadwidth>767){$(".wag-header-reward-container-mobile, .wag-header-youraccount-mobile, .wag-top-nav nav").hide();}}onloadwidth=windowWidth;anchors.unbind("click",menuOpener);if(windowWidth>315&&windowWidth<767){$wagtopnav.removeClass("desk");anchors.bind("click",menuOpener);$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu li.accordin-main").unbind("mouseover");$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu li.accordin-main").find("ul.wag-third-level-menu").removeAttr("style");}else{$wagtopnav.addClass("desk");anchors.unbind("click",menuOpener);$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu li.accordin-main").unbind("mouseover");$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu li.accordin-main").mouseover(function(){$("ul.wag-third-level-menu").css("height",Math.round($(this).parent().height()+29.5)+"px");});$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu > li.accordin-main").mouseover(function(){if($(window).width()<tabletMax992){$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu li.accordin-main").removeClass("activeMenu");$(this).addClass("activeMenu");$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu > li").mouseover(function(){if(!$(this).hasClass("accordin-main")){$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu li.accordin-main").removeClass("activeMenu");$(".wag-second-level-menusymbol").show().parent().find(".css_arrow").remove();}});$(".main_menu > li .link").mouseenter(function(){$("nav ul.main_menu li.accordin-main ul.wag-second-level-menu li.accordin-main").removeClass("activeMenu");$(".wag-second-level-menusymbol").show().parent().find(".css_arrow").remove();});}if(($(window).width()>767)&&($(window).width()<tabletMax992)){$(this).find(".wag-second-level-menusymbol").hide().parent().prepend('<span class="css_arrow" style="border-width:'+(($(this).height()/2)+2.5)+"px 0px "+$(this).height()/2+'px 15px"></span>');}if($(window).width()>tabletMax992){}});if((windowWidth>767)&&(windowWidth<=tabletMax992)){$("nav ul.main_menu li ul.wag-second-level-menu li.accordin-main .wag-third-level-menu li").mouseover(function(){window.location.href=$(this).find("a").attr("href");});}}$("nav ul.main_menu li.products .wag-second-level-menu >li #fourthLevelMenu >li").each(function(){var _thisLi=$(this);_thisLi.find(".wag-fourthlevelmenus").children().addClass("wag-second-ul-li");});if(window.innerWidth<1025){$("nav ul.main_menu li.products .wag-second-level-menu >li #fourthLevelMenu >li").each(function(){var _thisLi=$(this);_thisLi.find(".wag-third-level-menu1").append(_thisLi.find(".wag-fourthlevelmenus").children());_thisLi.find(".wag-fourthlevelmenus").css("display","none");});}else{if(window.innerWidth>=1025){$("nav ul.main_menu li.products .wag-second-level-menu >li #fourthLevelMenu >li").each(function(){var _thisLi=$(this);var _secondUlLi=_thisLi.find(".wag-third-level-menu1").find(".wag-second-ul-li");_thisLi.find(".wag-fourthlevelmenus").append(_secondUlLi);_thisLi.find(".wag-fourthlevelmenus").css("display","inline-block");});}}if(window.innerWidth<768){$("#wag-moreShopProducts").parent().append($("#wag-moreShopProducts >ul").children().addClass("wag-shop-more-chaild"));$("#wag-moreShopProducts").css("display","none");$(".wag-shopby-shopby").parent().append($(".wag-shopby-shopby"));$(".wag-shop-allproducts").parent().append($(".wag-shop-allproducts"));$(".wag-shop-weeklyonlinedeals").parent().append($(".wag-shop-weeklyonlinedeals"));}else{$("#wag-moreShopProducts").css("display","block");$("#wag-moreShopProducts >ul").append($("#wag-moreShopProducts").parent().find(".wag-shop-more-chaild"));}}).resize();function menuOpener(event,manulTrigger){if($(this).attr("id")=="ShopProductsMenu"){event.preventDefault();}var _this=$(this);if($(this).attr("id")=="ShopProductsMenu"&&shopProductsHitMobile&&!isCurrentPageIsTier3){shopProductsHitMobile=false;if(typeof(IsNativeApp)=="undefined"){IsNativeApp=false;}var $wagUtil=Clazz.CommonFactory.$wagUtil("");$.ajax({url:"/assets/nav/template/frags/Tier3JSON.jsp",success:function(result){result=JSON.parse(result);var thirdlevelMenu="";$.each(result,function(index,value){thirdlevelMenu="";if(value.length>0){$.each(value,function(index1,value1){thirdlevelMenu+='<li><a href="'+value1.url+'" title="'+value1.name+'">'+value1.name+"</a></li>";});var currentTier2=$("."+index+"replace").parent().find("span").html();var urlStringCatName=currentTier2.replace(/ /g,"-");urlStringCatName=urlStringCatName.replace(/&amp;/g,"and");thirdlevelMenu+='<li><a href="/store/c/'+urlStringCatName+"/ID="+index+'-tier2general" title="'+currentTier2+'">All '+currentTier2+" Products</a></li>";}if(thirdlevelMenu){$("."+index+"replace").replaceWith(thirdlevelMenu);}});$wagtopnav.find("li").each(function(index){$(this).attr("menu_index",index.toString());});additionalMenu.find("li").each(function(index){$(this).attr("menu_index","m"+index.toString());});menuOpenerFrag(event,manulTrigger,_this);var anchors=$(".accordin-main  a,.accordin-main section a");anchors.unbind("click",menuOpener);anchors.bind("click",menuOpener);}});}else{menuOpenerFrag(event,manulTrigger,_this);}}function menuOpenerFrag(event,manulTrigger,_this){var elemText=trim(_this.text());if(!_this.hasClass("link")&&!_this.hasClass("menu")){addNavStore(_this.closest("li").attr("menu_index"));return;}if(_this.closest("li").hasClass("nav5")&&$(".youraccount").children().length==1){$(".youraccount").append($("#yourAccMList").html());}event.preventDefault();_this.css("z-index",1);_this.css("position","relative");var main_tab=_this.closest(".accordin-main");var ul=main_tab.find(">ul");ul.find("ul").mobileHide();ul.toggleClass("wag-nav-hide");if(!ul.hasClass("wag-nav-hide")){main_tab.find(">section .menu").mobileShow();main_tab.find(">section .link").mobileHide();main_tab.siblings().mobileHide();$("#homelink").removeClass("wag-nav-hide");if(!manulTrigger&&elemText!="Your Account"){addNavStore(_this.closest("li").attr("menu_index"));}if(navStore.length<=1){$(".wag-header-reward-container-mobile").css("top",($(".main_menu").height()+50)+"px");$(".wag-header-youraccount-mobile").css("top",($(".main_menu").height()+$(".wag-header-reward-container-mobile").height()+50)+"px");}else{$(".wag-header-reward-container-mobile").css("top",($(".main_menu").height())+"px");$(".wag-header-youraccount-mobile").css("top",($(".main_menu").height()+$(".wag-header-reward-container-mobile").height())+"px");}}else{if(!manulTrigger){removeNavStore(_this.closest("li").attr("menu_index"));}main_tab.find(">section .link").mobileShow();main_tab.find(">section .menu").mobileHide();main_tab.siblings().mobileShow();main_tab.find("li,span").mobileShow();main_tab.find("li ul").mobileHide();main_tab.find("li section .link").mobileShow();main_tab.find("li section .menu").mobileHide();if(_this.closest("li").hasClass("nav5")&&$(".yourAcContent").children().length>0){}$(".main_menu li").removeClass("wag-list-hide");$(".main_menu li.nav5").addClass("wag-list-hide");$("#yourAccMList").removeClass("wag-list-hide");$(".wag-header-youraccount-wrapper").removeClass("wag-nav-hide");setTimeout(function(){$(".wag-header-reward-container-mobile").css("top",($(".main_menu").height())+"px");$(".wag-header-youraccount-mobile").css("top",($(".main_menu").height()+$(".wag-header-reward-container-mobile").height())+"px");},100);}$("body").animate({scrollTop:0});$(".main_menu a.wag-header-mob-home").mobileShow();}function findURL(){var locationURL=location.pathname,arr=[],breakId=[],childId,childElement;if(location.pathname=="/"){sessionStoreClear("navStore");return false;}$("nav ul.main_menu > li").each(function(k,v){breakId.push($(this).attr("menu_index"));});if($("nav ul.main_menu").find("a[href$='"+locationURL+"']").parent("section").parent("li").attr("menu_index")){childId=$("nav ul.main_menu").find("a[href$='"+locationURL+"']").parent("section").parent("li").attr("menu_index");childElement=$("nav ul.main_menu").find("a[href$='"+locationURL+"']").parent("section").parent("li");}else{childId=$("nav ul.main_menu").find("a[href$='"+locationURL+"']").parent("li").attr("menu_index");childElement=$("nav ul.main_menu").find("a[href$='"+locationURL+"']").parent("li");}if(childId){var tempElement=childElement,tempId,tempRes;do{if(tempElement.parent("ul").parent("li").attr("menu_index")){tempId=tempElement.parent("ul").parent("li").attr("menu_index");}else{tempId=tempElement.parent("ul").parent("section").parent("li").attr("menu_index");}if(tempId){if(tempElement.parent("ul").parent("li")){tempElement=tempElement.parent("ul").parent("li");}else{tempElement=tempElement.parent("ul").parent("section").parent("li");}tempRes=true;arr.push(tempId);if(breakId.indexOf(tempId)!=-1){break;}}else{tempRes=false;}}while(tempRes);arr.reverse();navStore=navStore.concat(arr);addNavStore(childId);}}if(windowWidth<=760){findURL();}function addNavStore(val){navStore.push(val);try{sessionStorage.setItem("navStore",JSON.stringify(navStore));}catch(e){}}function removeNavStore(val){var index=navStore.indexOf(val);navStore.splice(index);try{sessionStorage.setItem("navStore",JSON.stringify(navStore));}catch(e){}}if(windowWidth>315&&windowWidth<767){$("body").css("overflow","auto");$(".wag-top-nav .accordin-main").on("click","a",function(e){if(!$(this).hasClass("menu2")){$(this).parent().siblings().children(".bold").removeClass("bold");$(this).html("<span class='bold'>"+$(this).html()+"</span>");}});}else{$(".wag-top-nav .accordin-main").on("click","a",function(e){if($(this).hasClass("menu2")){try{sessionStorage.removeItem("searchOffset");}catch(e){}}});}if(windowWidth>315&&windowWidth<767){$(document).ready(function(){if($(".wag-search-area").is(":visible")){$(".wag-mobile-search").addClass("wag-mobile-search-inactive");$(".wag-mobile-search a span.wag-icon-search-btn-home").addClass("wag-icon-search-btn-home-open");}});}$(".wag-mobile-search").click(function(){if($(".wag-search-area").is(":visible")){return false;}$(".wag-search-area").toggle();if($(".wag-search-area").is(":visible")){$(".wag-mobile-search").addClass("wag-mobile-search-inactive");$(".wag-mobile-search a span.wag-icon-search-btn-home").addClass("wag-icon-search-btn-home-open");}else{$(".wag-mobile-search").addClass("wag-mobile-search-inactive");$(".wag-mobile-search a span.wag-icon-search-btn-home").removeClass("wag-icon-search-btn-home-open");}setTimeout(function(){$("#ntt-placeholder").focus();},0);});$("body").on("click",".wag-mobile-menu, .wag-opacity-cont-section",function(){$("nav").show();var slideTimer,stripTimer;if($("#hamburgerMenu").hasClass("icon-Hamburger")){$("#hamburgerMenu").removeClass("icon-Hamburger").removeClass("wag-iconhamburgermenu").addClass("icon-XPlain").addClass("wag-hamburgaricon-close");$(".wag-mobile-menu").css("width","16%");$(this).parent().find("a").attr("style","height:44px");$(".container").addClass("hamburger-menu-in");$(".container").attr("style","left:84%");$(".wag-top-header").css("z-index","-1");stripTimer=setTimeout(function(){$('<section id="strip" class="wag-slide-wrapper"></section>').insertAfter(".wag-bg-tint-blue:eq(0)");},500);clearTimeout(slideTimer);}else{$(".wag-mobile-menu").attr("style","");$("#strip").remove();$("#hamburgerMenu").removeClass("icon-XPlain").removeClass("wag-hamburgaricon-close").addClass("icon-Hamburger").addClass("wag-iconhamburgermenu");$(this).parent().find("a").attr("style","height:47px");slideTimer=setTimeout(function(){$(".container").removeClass("hamburger-menu-in");$(".wag-top-header").css("z-index","0");},500);$(".container").attr("style","left:0%");}$(".wag-mobmenu-arrow2").parent().filter(".menu2.menu").attr("style","border-top:2px solid #d2d6d7 !important;font-size:114.5%;padding: 8px 0 10px 0 !important;color: #1d5e8d!important;");showHideBlackBg();try{if(sessionStorage.getItem("navStore")&&sessionStorage.getItem("navStore")!="[]"){navStore=JSON.parse(sessionStorage.getItem("navStore"));var navLength=navStore.length;var previousNavStore=0;for(i=0;i<navLength;i++){if(previousNavStore!=navStore[i]){var tab=$wagtopnav.find("[menu_index='"+navStore[i]+"']");tab.find(">section .link").trigger("click",true);previousNavStore=navStore[i];}}if(navLength>1){var lastData=navStore[navLength-1];$("li[menu_index="+lastData+"]").children().addClass("bold");}}}catch(e){}setTimeout(function(){if($(".youraccount").hasClass("wag-nav-hide")){$(".wag-header-reward-container-mobile").css("top",$(".main_menu").height()+"px");$(".wag-header-userinfotab").css("top",$(".main_menu").height()+$(".wag-header-reward-container-mobile").height()+"px");}else{$(".wag-header-reward-container-mobile").css("top",$(".main_menu").height()+$("#yourAccMList").height()+"px");$(".wag-header-userinfotab").css("top",$(".main_menu").height()+$(".wag-header-reward-container-mobile").height()+$("#yourAccMList").height()+"px");}},500);});$("#appsearch").keyup(function(){var length=$("#appsearch").val().length;if(length>0){$("#app-search-close").removeClass("hide");}else{$("#app-search-close").addClass("hide");}});$("input[id=appsearch]").unbind("focus");$("input[id=appsearch]").on("focus",function(){$("input[id=appsearch]").attr("placeholder","");});$("input[id=appsearch]").unbind("focusout");$("input[id=appsearch]").on("focusout",function(){$("input[id=appsearch]").attr("placeholder","Search by keyword or item..");});$("#app-search-close").click(function(){$("#appsearch").val("");$("#app-search-close").removeClass("show");$("#app-search-close").addClass("hide");});$("#app-search-close").bind("touchstart",function(){$("#appsearch").val("");$("#app-search-close").removeClass("show");$("#app-search-close").addClass("hide");});var navLinks=$("nav li a");var pharmacyPageContextOnHeader=$("#pharmacyPageContextOnHeader").val();navLinks.each(function(){if($(this).attr("href").indexOf("<%=pharmacyPageContext%>")>-1){$(this).attr("href",$(this).attr("href").replace("<%=pharmacyPageContext%>",pharmacyPageContextOnHeader));}});if($(window).width()>=768&&$(window).width()<=tabletMax992){$(window).scroll(function(){restrictClick();});$(".clickerror").on("click",function(e){try{if(sessionStorage.getItem("ct")==e.target.title){$(".clickerror nav").css("z-index",1);}else{if(e.target.nextElementSibling&&e.target.nextElementSibling.className!="wag-mobmenu-arrow3"){e.preventDefault();}}sessionStorage.setItem("ct",e.target.title);}catch(e){}});}if(window.header&&window.header.profileInfo&&window.header.profileInfo.loggedIn==="true"){$(".wag-second-level-menu.photo a.photo-your-photos, .wag-second-level-menu.photo a.photo-upload-photos, .wag-second-level-menu.photo a.photo-prints").attr("href","/photo/default.jsp");}if(window.header&&window.header.profileInfo&&window.header.profileInfo.loggedIn==="true"){var UserInfo='<span class="wag-user-details">Hi&nbsp;&nbsp;'+window.header.profileInfo.firstName+'</span><span>|</span><span><a href="" title="Sign Out">Sign Out</a></span>';$("#wag-userinfohamburger").html(UserInfo);}else{var UserInfo='<span><a class="" href="/" title="home">Sign In</a></span><span>|</span><span><a href="" title="Register">Register</a></span>';$("#wag-userinfohamburger").html(UserInfo);}if(typeof isKeyNoteUserAgent!==undefined){return false;}}}function restrictClick(){try{var offset=$(".wag-top-nav").offset();var w=$(window);var offsetTop=offset.top-w.scrollTop();if(offsetTop>-50){}else{if(offsetTop==185){$(".wag-top-nav nav").css("z-index",1);}}}catch(e){}}$(".wag-header-mob-home").bind("click",function(){sessionStoreClear("navStore");sessionStoreClear("extMenu");});function sessionStoreClear(sKey){try{sessionStorage.removeItem(sKey);}catch(e){}}var IsLoadGoogleMapApi=false;function loadGoogleMapApi(){if(!IsLoadGoogleMapApi){var script=document.createElement("script");script.type="text/javascript";script.src="https://maps.googleapis.com/maps/api/js?client=gme-walgreens&callback=initialize&libraries=places";document.body.appendChild(script);IsLoadGoogleMapApi=true;}}"use strict";Clazz.createPackage("com.wag.userinfo");Clazz.com.wag.userinfo.UserInfo=Clazz.extend(Clazz.Widget,{initialize:function(){this.myContainer="wagUserinfo";this.controller=Clazz.com.wag.userinfo.UserInfoController;this.service=Clazz.com.wag.userinfo.UserInfoService;this.factory=Clazz.com.wag.userinfo.UserInfoFactory;},injectDependencies:function(){this.controller.userInfoController.$inject=["$scope","$rootScope","userInfoFactory"];this.factory.userInfoFactory.$inject=["userInfoService","logOutService"];this.service.userInfoService.$inject=["$wagAPI","$wagUtil"];}});Clazz.com.wag.userinfo.UserInfoController={userInfoController:function($scope,$rootScope,userInfoFactory){var userInfoListener,userInfoEvent,idleTime=0,idleInterval,url=window.location.href;var windowWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;$scope.init=function(){userInfoListener=Clazz.com.wag.userinfo.UserInfoListener;userInfoEvent=Clazz.com.wag.userinfo.UserInfoEvent;userInfoListener.initialize($scope);userInfoEvent.initialize($rootScope);$scope.load();};$scope.yourAccountFunction=function(){angular.element("#youaccountdropdown").attr("aria-expanded","true");angular.element("#youaccountdropdown").addClass("activeAccDropMenu");angular.element("#yourAccMList").show();$scope.showHideMenu();if(angular.element(".wag-mobile-menu").is(":visible")){$(".main_menu li").addClass("wag-list-hide");$(".main_menu li").removeClass("wag-nav-hide");$(".main_menu li.nav5").removeClass("wag-list-hide");$(".main_menu li.nav5 a.menu2.link").click();if($(".yourAcContent").children().length<=0){$("#yourAccMList").appendTo(".yourAcContent");$("#yourAccMList").removeClass("wag-nav-hide");}$("#yourAccMList").removeClass("wag-nav-hide");$("#yourAccMList li").removeClass("wag-list-hide");$(".yourAcContent").removeClass("wag-list-hide");$(".wag-header-youraccount-wrapper").addClass("wag-nav-hide");$(".wag-header-reward-container-mobile").css("top",$(".main_menu").height()+$("#yourAccMList").height()+"px");$(".wag-header-userinfotab").css("top",$(".main_menu").height()+$("#yourAccMList").height()+$(".wag-header-reward-container-mobile").height()+"px");}$.each($("#new-nav-main-menu ul.wag-second-level-menu"),function(index,value){if(value.className.search("youraccount")<0&&value.className.search("wag-nav-hide")<0){var parentActiveMenu=(value.parentNode.classList[2])?"."+value.parentNode.classList[2]:"";$(parentActiveMenu+" ul.wag-second-level-menu").addClass("wag-nav-hide");$(parentActiveMenu+" ul.wag-second-level-menu span").removeClass("wag-nav-hide");$(parentActiveMenu+" .menu2.link").removeClass("wag-nav-hide");$(parentActiveMenu+" .menu2.menu").addClass("wag-nav-hide");$(parentActiveMenu+" ul.wag-third-level-menu").addClass("wag-nav-hide");}});};$scope.yourAccount=function(){if(windowWidth>767||navigator.appVersion.indexOf("MSIE 8.")!==-1){$scope.yourAccountFunction();}};$scope.yourAccountMouseOut=function(){if(windowWidth>767){angular.element("#youaccountdropdown").attr("aria-expanded","false");angular.element("#youaccountdropdown").removeClass("activeAccDropMenu");angular.element("#yourAccMList").hide();}};$scope.yourAccountClick=function(){if(windowWidth>=320&&windowWidth<768){$scope.yourAccountFunction();}};if(windowWidth>1024){var timeOut,outTimeout,hoverTime,houtTime,timeToClose,previous;$("#youaccountdropdown").hover(function(){hoverTime=new Date().getTime();if($(this).hasClass("activeAccDropMenu")){previous=true;clearTimeout(outTimeout);}previous=false;timeOut=setTimeout(function(){$scope.yourAccount();},document.delayTime);},function(){houtTime=new Date().getTime();timeToClose=houtTime-hoverTime;if(timeToClose<document.delayTime){clearTimeout(timeOut);}outTimeout=setTimeout(function(){if(!previous){$scope.yourAccountMouseOut();}},document.delayTime);});}$scope.showHideMenu=function(){if(angular.element(".wag-mobile-menu").is(":visible")){$("aside article.wag-header-youraccount-wrapper").removeClass("dropdown");}else{$("aside article.wag-header-youraccount-wrapper").addClass("dropdown");}};$(window).bind("resize",function(){if($(".yourAcContent").children().length>0){}$scope.showHideMenu();}).resize();if(angular.element(window).width()>767){$(document).click(function(e){if($(e.target).is($(".wag-header-youraccount-wrapper").find("span:first"))===false&&$(e.target).is($(".wag-your-account-arrow").find("img"))===false&&$(e.target).is($("#yourAccMList"))===false){$("#yourAccMList").hide();}});}$scope.load=function(){$scope.userinfo={};$scope.userinfo.cartUrl="/store/checkout/cart.jsp";$scope.userinfo.notificationmsgcount=0;$scope.userinfo.commonContextPath=Clazz.com.wag.config.commonUiConfig.commonContextPath;$scope.userinfo.pharmacyContextPath=Clazz.com.wag.config.commonUiConfig.pharmacyContextPath;$scope.userinfo.selfServeContextPath=Clazz.com.wag.config.commonUiConfig.selfServeContextPath;$scope.userinfo.pharmacyUrlContext=angular.element("#pharmacyUrlContext").attr("value");$scope.userinfo.onSelectionChange=function(val){userInfoEvent.changeSelection(val);};$scope.userinfo.onToggleClass=function(){userInfoEvent.toggleMenu();};$scope.updateRXDLCartURL=function(RxCount,itemCount){if(RxCount>=1&&itemCount<=0){$scope.userinfo.cartUrl="/pharmacy/leancheckout.jsp";}else{$scope.userinfo.cartUrl="/store/checkout/cart.jsp";}if(RxCount){itemCount=parseInt(itemCount)+parseInt(RxCount);}return itemCount;};$scope.updateUserinfoWidget=function(){userInfoFactory.getUserInfo(function(userInfoData){if(userInfoData.notificationInfo){$scope.userinfo.notificationmsgcount=userInfoData.notificationInfo.msgCount;}if(userInfoData.profileInfo){userInfoEvent.userProfile(userInfoData.profileInfo);}userInfoEvent.userProfileData(userInfoData);$scope.cartInfoData=userInfoData.cartInfo;userInfoEvent.cartInfo(userInfoData.cartInfo);if(userInfoData.profileInfo){$scope.userinfo.name=userInfoData.profileInfo.firstName;if(userInfoData.profileInfo.firstName){$scope.userinfo.captilaizeName=userInfoData.profileInfo.firstName.replace(userInfoData.profileInfo.firstName.charAt(0),userInfoData.profileInfo.firstName.charAt(0).toUpperCase());}if(userInfoData.profileInfo.firstName&&userInfoData.profileInfo.firstName.length>8){$scope.userinfo.nameTruncated=userInfoData.profileInfo.firstName.substr(0,8);$scope.userinfo.nameTruncated=$scope.userinfo.nameTruncated.replace($scope.userinfo.nameTruncated.charAt(0),$scope.userinfo.nameTruncated.charAt(0).toUpperCase());}else{if(userInfoData.profileInfo.firstName){$scope.userinfo.nameTruncated=userInfoData.profileInfo.firstName;$scope.userinfo.nameTruncated=$scope.userinfo.nameTruncated.replace($scope.userinfo.nameTruncated.charAt(0),$scope.userinfo.nameTruncated.charAt(0).toUpperCase());}}}userInfoEvent.userobject(userInfoData.profileInd);if(userInfoData.profileInfo&&userInfoData.profileInfo.loggedIn){userInfoEvent.loggedstatus(userInfoData.profileInfo.loggedIn);$scope.userinfo.loggedin=userInfoData.profileInfo.loggedIn;}if(userInfoData.profileInfo&&typeof userInfoData.profileInfo.recognizedState!="undefined"){$scope.userinfo.recognizedState=userInfoData.profileInfo.recognizedState;}else{$scope.userinfo.recognizedState=false;}if(userInfoData.cartInfo&&(userInfoData.cartInfo.itemCount||userInfoData.cartInfo.rxCount)){$scope.userinfo.ordercount="("+$scope.updateRXDLCartURL(userInfoData.cartInfo.rxCount,userInfoData.cartInfo.itemCount)+")";}else{$scope.userinfo.ordercount="";}if(userInfoData.notificationInfo){$scope.userinfo.msgcount="("+userInfoData.notificationInfo.msgCount+")";}else{$scope.userinfo.msgcount="(0)";}});};$scope.updateUserinfoWidget();$scope.userinfo.notYouLogOut=function(ev,fromWhere){$scope.userinfo.logOut(ev,fromWhere);};$scope.userinfo.logOut=function(ev,fromWhere){angular.element(".wag-hide-loading").show().css({"z-index":"1040"});userInfoFactory.logOutFactory(function(data){angular.element(".wag-hide-loading").hide();document.cookie="selectstore=false";try{localStorage.clear();sessionStorage.clear();if(typeof(localStorage)!=="undefined"&&localStorage.length>0){for(var i in localStorage){localStorage.removeItem(localStorage.key(i));}}if(typeof(sessionStorage)!=="undefined"&&sessionStorage.length>0){for(var j in typeof(sessionStorage)){sessionStorage.removeItem(sessionStorage.key(j));}}}catch(e){}if(data.messages[0].code==="WAG_I_LOGOUT_1000"){if(data.links[0].href!==undefined){window.location.href=data.links[0].href;}else{window.location.href="/logout.jsp?key=i_1000";}}else{if(data.messages[0].code==="WAG_I_LOGOUT_1002"){window.location.href="/logout.jsp?key=i_1002";}}if(fromWhere&&fromWhere=="notYou"){window.location.href="/login.jsp?sessionTimeoutMsg=true";}});ev.preventDefault();};$scope.userinfo.resetIdleTime=function(){if($("#wag-ssn-tout-overlay").is(":visible")){idleTime=13*60;}else{idleTime=0;}};$scope.userinfo.logoutAndRedirectToLogin=function(){angular.element(".wag-hide-loading").show();userInfoFactory.logOutFactory(function(data){angular.element(".wag-hide-loading").hide();document.cookie="selectstore=false";try{sessionStorage.removeItem("profile");localStorage.clear();sessionStorage.clear();if(typeof(localStorage)!=="undefined"&&localStorage.length>0){for(var i in localStorage){localStorage.removeItem(localStorage.key(i));}}if(typeof(sessionStorage)!=="undefined"&&sessionStorage.length>0){for(var j in typeof(sessionStorage)){sessionStorage.removeItem(sessionStorage.key(j));}}}catch(e){}window.location.href="/login.jsp?sessionTimeoutMsg=true";});};$scope.signinRedirection=function(){if(url.indexOf("/offers/offers.jsp")>0){try{sessionStorage.setItem("registrationsuccess",true);}catch(e){}window.location.href="/balance_rewards_redirection.jsp?endurl=signinoffers";}else{if(typeof clearIntentForLogin!=="undefined"){if(typeof isRedirectAjaxRequired!=="undefined"){var redirectUrl=window.location.pathname+window.location.search;$.ajax({url:"/login_redirect_plp.jsp",type:"post",data:{redirectUrl:encodeURIComponent(redirectUrl)},success:function(){},error:function(){}});}window.location.href="/login.jsp";}else{if(url.indexOf("cart.jsp")!=-1){window.location.href="/youraccount/cs_redirect.jsp?intent=redirect&landingURL=/store/checkout/cart.jsp";}else{window.location.href="/login.jsp?clearIntent=true";}}}};$scope.registerRedirection=function(){if(url.indexOf("/offers/offers.jsp")>0){try{sessionStorage.setItem("registrationsuccess",true);}catch(e){}window.location.href="/balance_rewards_redirection.jsp?endurl=registeroffers";}else{if(window.currentPageType&&window.currentPageType==="ProductDetails"){window.location.href="/register/regOptions.jsp";}else{window.location.href="/youraccount/cs_redirect.jsp?intent=regOptions&fromPage=regOptions";}}};};}};Clazz.com.wag.userinfo.UserInfoFactory={userInfoFactory:function(userInfoService,logOutService){var factory={},serviceUrl="";factory.getUserInfo=function(callback){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){serviceUrl="/svc/header?timeStamp="+new Date().getTime();}else{serviceUrl=Clazz.com.wag.config.commonUiConfig.getUserInfo;}userInfoService(serviceUrl,callback);};factory.logOutFactory=function(callback){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){serviceUrl="/svc/profiles/logout?timeStamp="+new Date().getTime();}else{serviceUrl=Clazz.com.wag.config.commonUiConfig.signOut;}logOutService(serviceUrl,callback);};return factory;}};Clazz.com.wag.userinfo.UserInfoService={userInfoService:function($wagAPI,$wagUtil){return function(path,callback){$wagUtil.getUserInfo(function(data){if(callback){if(window.dtmObject===undefined){window.dtmObject={};}if(window.dtmObject.CAC===undefined){window.dtmObject.CAC={};}window.dtmObject.CAC.HeaderProfile=data;if(window.dtmObject.CAC.HeaderProfile.profileInfo!==undefined){if(window.dtmObject.CAC.HeaderProfile.profileInfo.loggedIn==="true"){$(document).trigger("triggerDTM","BAS_Global_EVar9");}}callback(data);}});};},logOutService:function($wagAPI){return function(path,callback){$wagAPI.post(path).success(function(data){if(callback){callback(data);}});};}};Clazz.com.wag.userinfo.UserInfoEvent={rootScope:null,initialize:function($rootScope){this.rootScope=$rootScope;},userProfile:function(data){this.rootScope.$broadcast("wag.userinfo.UserInfoEvent.userProfile",data);},userProfileData:function(data){this.rootScope.$broadcast("wag.userinfo.UserInfoEvent.userProfileData",data);},cartInfo:function(data){this.rootScope.$broadcast("wag.userinfo.UserInfoEvent.cartInfo",data);},changeSelection:function(data){this.rootScope.$broadcast("wag.userinfo.UserInfoEvent.ChangeSelection",data);},toggleMenu:function(){this.rootScope.$broadcast("wag.userinfo.UserInfoEvent.toggleMenu");},userobject:function(data){this.rootScope.$broadcast("wag.userinfo.UserInfoEvent.USERDATA",data);},loggedstatus:function(data){this.rootScope.$broadcast("wag.userinfo.UserInfoEvent.loginstatus",data);}};Clazz.com.wag.userinfo.UserInfoListener={$myscope:null,initialize:function($scope){this.$myscope=$scope;this.listen();},listen:function(){var self=this;self.$myscope.$on("wag.userinfo.UserInfoEvent.ChangeSelection",function(event,data){});self.$myscope.$on("wag.userinfo.UserInfoEvent.toggleMenu",function(event,data){});self.$myscope.$on("wag.userinfo.UserInfoEvent.CartUpdate",function(event,data){});self.$myscope.$on("com.wag.cartinfo.js.UpdateCartCount",function(event,data){self.$myscope.userinfo.ordercount="("+self.$myscope.updateRXDLCartURL(window.header.cartInfo.rxCount,data)+")";});self.$myscope.$on("com.wag.addtocart.js.AddToCartCount",function(event,data){self.$myscope.userinfo.ordercount="("+self.$myscope.updateRXDLCartURL(window.header.cartInfo.rxCount,data)+")";});self.$myscope.$on("com.wag.login.signin.js.SignInEvent.showusernamepopup",function(event,data){self.$myscope.updateUserinfoWidget();});self.$myscope.$on("com.wag.dobrdspagechg.js.DoBrdsPagechgEvent.userInfoUpdate",function(event){self.$myscope.updateUserinfoWidget();});}};var wagUtil={};wagUtil=Clazz.CommonFactory.$wagUtil();wagUtil.isLoggedIn(function(res){if(sessionOverlay!==undefined){if(res==="true"&&sessionOverlay){Clazz.App.windowSessionTimeout();}}});$("#wag-ssn-tout-overlay-logout").bind("click",function(event){Clazz.App.logoutCall();});