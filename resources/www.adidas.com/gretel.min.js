"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var r,o,n,i,c,a=gap,u=t[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,c=[],"[object Array]"===Object.prototype.toString.apply(u)){for(i=u.length,r=0;i>r;r+=1)c[r]=str(r,u)||"null";return n=0===c.length?"[]":gap?"[\n"+gap+c.join(",\n"+gap)+"\n"+a+"]":"["+c.join(",")+"]",gap=a,n}if(rep&&"object"==typeof rep)for(i=rep.length,r=0;i>r;r+=1)"string"==typeof rep[r]&&(o=rep[r],n=str(o,u),n&&c.push(quote(o)+(gap?": ":":")+n));else for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(n=str(o,u),n&&c.push(quote(o)+(gap?": ":":")+n));return n=0===c.length?"{}":gap?"{\n"+gap+c.join(",\n"+gap)+"\n"+a+"}":"{"+c.join(",")+"}",gap=a,n}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,r){var o;if(gap="",indent="","number"==typeof r)for(o=0;r>o;o+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var r,o,n=e[t];if(n&&"object"==typeof n)for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o=walk(n,r),void 0!==o?n[r]=o:delete n[r]);return reviver.call(e,t,n)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){"use strict";function t(){return f.useTest?"staging.cquotient.com":"cquotient.com"}function r(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+"::"+e[r]);return t.join("||")}function o(e){for(var t=[],o=0;o<e.length;o++){var n=e[o];"[object Object]"===Object.prototype.toString.call(n)?t.push(r(n)):t.push(n)}return t.join(";;")}function n(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],c=encodeURIComponent(n)+"=";c+="[object Object]"===Object.prototype.toString.call(i)?encodeURIComponent(r(i)):"[object Array]"===Object.prototype.toString.call(i)?encodeURIComponent(o(i)):encodeURIComponent(i),t.push(c)}return t.join("&").length<1e3&&t.push("json="+encodeURIComponent(JSON.stringify(e))),t.join("&")}function i(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null}function c(e){var t,r;try{t=i("__cq_bc"),t||(t=i("bc")),t&&(t=t.replace(/^j:/,""),t=JSON.parse(t),r={},r[e]=t[e],r=JSON.stringify(r))}catch(o){}return r}function a(){try{var e=window.sessionStorage.getItem("cq.viewReco");if(!e)return[];try{return JSON.parse(e)}catch(t){return[]}}catch(r){var o=i("__cqviews");if(!o)return[];try{return JSON.parse(o)}catch(n){return[]}}}function u(e,t){var r=h[t.recommenderName]=h[t.recommenderName]||[];r.push(t.products),clearTimeout(y[t.recommenderName]),y[t.recommenderName]=setTimeout(function(){for(var o=[],n=0;n<r.length;n++)o=o.concat(r[n]);t.products=o,f.sendActivity(e,"viewReco",t);var i=a();i.push({recommenderName:t.recommenderName,cookieId:t.cookieId,userId:t.userId,products:t.products});try{window.sessionStorage.setItem("cq.viewReco",JSON.stringify(i))}catch(c){var u=encodeURIComponent(JSON.stringify(i));u.length>1e3?f.sendActivity(e,"error",{time:(new Date).getTime(),error:"__cqviews too large"}):document.cookie="__cqviews="+encodeURIComponent(JSON.stringify(i))+";path=/;"}},0)}function s(e,t){for(var r=0;r<w.length;r++)for(var o=w[r].products,n=0;n<o.length;n++)if(o[n].id===t.id){var i={recommenderName:w[r].recommenderName,product:t,cookieId:w[r].cookieId,userId:w[r].userId};return void f.sendActivity(e,"_clickReco",i)}}function d(){try{return window.localStorage.setItem("cq","cq"),window.localStorage.removeItem("cq"),!0}catch(e){return!1}}function l(){if(f.clientId){var e;try{e=i("__cqact")}catch(t){f.sendActivity(f.clientId,"error",{time:(new Date).getTime(),caughtError:t})}if(document.cookie="__cqact=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC",e){try{for(var r=JSON.parse(e),o=0,n=r.length;n>o;o++)f.sendActivity(f.clientId,r[o].activityType,r[o].parameters)}catch(t){f.sendActivity(f.clientId,"error",{time:(new Date).getTime(),caughtError:t})}i("__cqact")&&(f.sendActivity(f.clientId,"error",{time:(new Date).getTime(),error:"error deleting activity cookie, disabling"}),clearInterval(O))}}}function p(e){e=e.toLowerCase();for(var t=0;t<S.length;t++){var r=S[t];if(e.indexOf(r)>=0)return r}return"other"}var f=e.CQuotient=window.CQuotient||(e.CQuotient={});f.VERSION="v2.6.0";var v=0;f._getTopDomain=function(e){var t,r,o="weird_get_top_level_domain=cookie",n=e.split(".");for(t=n.length-1;t>=0;t--)if(r=n.slice(t).join("."),document.cookie=o+";domain=."+r+";",document.cookie.indexOf(o)>-1)return document.cookie=o.split("=")[0]+"=;domain=."+r+";expires=Thu, 01 Jan 1970 00:00:01 GMT;","."+r;return!1};var m=f._getTopDomain(document.location.hostname),g={customerSignup:["cookieId","userId","emailId"],viewPage:["cookieId","pageId"],viewProduct:["cookieId","product"],search:["cookieId","searchText"],viewCategory:["cookieId","categoryId"],viewCart:["cookieId","products"],addToCart:["cookieId","product"],removeFromCart:["cookieId","product"],beginCheckout:["cookieId","products","amount"],finishCheckout:["cookieId","products","amount"],reviewProduct:["cookieId","product","rating"],clickReco:["cookieId","product"],viewWishList:["cookieId"],addToWishList:["cookieId"],removeFromWishList:["cookieId"],viewReco:["cookieId"],servedReco:[],error:[]},h={},y={},w=a();try{window.sessionStorage.removeItem("cq.viewReco")}catch(_){document.cookie="__cqviews=;path=/;"}if(f.sendActivity=function(e,r,o){function a(){delete f[y],I.parentNode.removeChild(I)}if(!e)throw new Error("Must provide a clientId");if(o=o||{},"viewReco"===r&&o.accumulate)return delete o.accumulate,void u(e,o);if("viewProduct"===r&&s(e,o.product),!("clickReco"===r&&w.length>0)){if("_clickReco"===r&&(r="clickReco"),!g.hasOwnProperty(r))throw new Error("Unsupported activity type!");o.referrer=window.document.referrer;var l=i("__cq_uuid");l&&(o.__cq_uuid=l);var p="//p."+t()+"/pebble?tla="+e+"&activityType="+r,h=c(e);h&&(o.bc=h),o.ls=d(),p+="&_="+(new Date).getTime();var y="_act_callback"+v++;p+="&callback=CQuotient."+y,o.v=f.VERSION;var _=n(o);_.length>0&&(p+="&"+_);var I=document.createElement("script");return I.src=p,I.type="text/javascript",f[y]=function(e){if("[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),"[object Array]"===Object.prototype.toString.call(e))for(var t=0,r=e.length;r>t;t++)document.cookie=e[t].k+"="+e[t].v+";path=/;domain="+(m||e[t].d)+";max-age="+e[t].m;a()},document.getElementsByTagName("body")[0].appendChild(I),new Image}},f.clientId&&f.activities&&f.activities.length>0){for(var I=0;I<f.activities.length;I++){var b=f.activities[I];f.sendActivity(f.clientId,b.activityType,b.parameters)}f.activities=[]}var O;O=setInterval(l,100);var S=["ipad","iphone","android","windows","macintosh"],k={pdp:!0,topsellers:!0,v2v:!0};if(f.getRecs=function(e,r,o,a,u){function s(){delete f[w],S.parentNode.removeChild(S),window.clearTimeout(j)}var d=new Date;if(!e)return void(u&&u({errorMessage:'Invalid value for "clientId":'+e}));if(!r)return void(u&&u({errorMessage:'Invalid value for "recommenderName":'+r}));o=o||{};var l=i("__cq_uuid");l&&(o.__cq_uuid=l);var m=!1;for(var g in k)k.hasOwnProperty(g)&&r.indexOf(g)>=0&&(m=k[g]);var h,y=o.timeoutMs||5e3,w="_callback"+v++,_="recs/"+e+"/"+r+"?callback=CQuotient."+w;if(m?h="r":(_+="&_="+(new Date).getTime(),h="e"),o.filters){var I=o.filters;delete o.filters,I.fieldsToMatchToValue&&(o.filter_fieldsToMatchToValue=I.fieldsToMatchToValue)}o.v=f.VERSION,_+="&_device="+p(navigator.userAgent);var b=c(e);b&&(o.bc=b);var O=n(o);O.length>0&&(_+="&"+O);var S=document.createElement("script");S.src="//"+h+"."+t()+"/"+_,S.type="text/javascript";var j=window.setTimeout(function(){try{u&&u({errorMessage:"Reco request timed out for recommender: "+r})}finally{s()}},y);f[w]=function(t){try{if("[object Object]"===Object.prototype.toString.call(t))try{a(t)}catch(r){f.sendActivity(e,"error",{time:new Date-d,recoRequestParams:o,recoResponse:t,caughtError:r})}finally{f.sendActivity(e,"servedReco",{time:new Date-d,recoRequestParams:o,recoResponse:t})}else if(u)try{u(t)}finally{f.sendActivity(e,"error",{time:new Date-d,recoRequestParams:o,recoResponse:t})}}catch(r){f.sendActivity(e,"error",{time:new Date-d,recoRequestParams:o,recoResponse:t,caughtError:r})}finally{s()}},document.getElementsByTagName("body")[0].appendChild(S)},f.clientId&&f.widgets&&f.widgets.length>0){for(var j=0;j<f.widgets.length;j++){var N=f.widgets[j];f.getRecs(f.clientId,N.recommenderName,N.parameters,N.callback,N.errorCallback)}f.widgets=[]}}("undefined"!=typeof module&&module.exports?exports:window);
