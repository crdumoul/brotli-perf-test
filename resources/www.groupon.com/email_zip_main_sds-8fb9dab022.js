function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}$.extend($.fn,{emailSuggestions:function(){var commonDomains,emailField,getEmailSuggestion,getTruncatedEmail,onEmailSuggestionClicked;return onEmailSuggestionClicked=function(e){var link,newVal;return e.preventDefault(),link=$(this),newVal=link.data("fullEmail"),emailField.val(newVal),emailField.change(),link.parent().remove(),"undefined"!=typeof _fixedFormDivNoSuggestMargin&&null!=_fixedFormDivNoSuggestMargin?$("#fixed-form-div").css({"padding-bottom":_fixedFormDivNoSuggestMargin}):void 0},getTruncatedEmail=function(fullAddress,domain){var truncatedAddress;return null==fullAddress&&(fullAddress=""),null==domain&&(domain=""),truncatedAddress=fullAddress.slice(-6),truncatedAddress!==fullAddress?$("body").hasClass("rtl")?truncatedAddress+"@"+domain+"...":"..."+truncatedAddress+"@"+domain:fullAddress+"@"+domain},getEmailSuggestion=function(){var suggDisplay;return suggDisplay=emailField.siblings(".suggestion"),emailField.mailcheck({domains:commonDomains,suggested:function(element,suggestion){var i18nObj,output,truncatedEmail,val;return val=emailField.val(),i18nObj=I18n,"undefined"!=typeof subsI18n&&null!=subsI18n&&(i18nObj=subsI18n),/@.+\./.test(val)&&suggestion.full.slice(0,val.length)!==val?(truncatedEmail=getTruncatedEmail(decodeURIComponent(suggestion.address),decodeURIComponent(suggestion.domain)),output=i18nObj.translate("js.modules.subscription.subscribe.email_step.suggest_email",{link_open:"<a href='#' class='accept-suggestion'>",suggested_email:truncatedEmail,link_close:"</a>"}),"undefined"!=typeof _fixedFormDivSuggestMargin&&null!=_fixedFormDivSuggestMargin&&$("#fixed-form-div").css({"padding-bottom":_fixedFormDivSuggestMargin}),suggDisplay[0]||(suggDisplay=$("<div>",{"class":"suggestion","data-bhw":"EmailSuggestion"}),emailField.after(suggDisplay)),suggDisplay.html(output),$(".accept-suggestion").data("fullEmail",decodeURIComponent(suggestion.full))):(suggDisplay.remove(),"undefined"!=typeof _fixedFormDivNoSuggestMargin&&null!=_fixedFormDivNoSuggestMargin?$("#fixed-form-div").css({"padding-bottom":_fixedFormDivNoSuggestMargin}):void 0)},empty:function(element){return suggDisplay.remove(),"undefined"!=typeof _fixedFormDivNoSuggestMargin&&null!=_fixedFormDivNoSuggestMargin?$("#fixed-form-div").css({"padding-bottom":_fixedFormDivNoSuggestMargin}):void 0}})},emailField=$(this),commonDomains=["yahoo.com","gmail.com","hotmail.com","aol.com","comcast.net","msn.com","sbcglobal.net","verizon.net","att.net","cox.net","live.com","bellsouth.net","ymail.com","charter.net","yahoo.ca","optonline.net","earthlink.net","mac.com","juno.com","me.com","rogers.com","rocketmail.com","aim.com","shaw.ca","roadrunner.com","telus.net","windstream.net","sympatico.ca","embarqmail.com","q.com","live.ca","insightbb.com","frontier.com","netzero.net","netzero.com","mail.com","mchsi.com","netscape.net","hotmail.ca","cogeco.ca","wowway.com","hotmail.co.uk","fuse.net","suddenlink.net","mindspring.com","centurytel.net","sasktel.net","excite.com","tds.net","pacbell.net","163.com","yahoo.co.uk","ameritech.net","yahoo.co.in","prodigy.net","zoominternet.net","cableone.net","swbell.net","rcn.com","mail.ru","eastlink.ca","qq.com","ptd.net","msu.edu","centurylink.net","email.com","yahoo.fr","peoplepc.com","mailinator.com","mts.net","umich.edu","hughes.net","cs.com","gmx.com","rediffmail.com","126.com","us.army.mil","umn.edu"],emailField.keyup(function(e){return getEmailSuggestion()}),$(emailField.parent()).delegate(".accept-suggestion","click",onEmailSuggestionClicked)}}),$.extend($.fn,{setCursorPosition:function(pos){var elem,range;if(this.length>0&&(elem=this.get(0),null!=elem)){if(null!=elem.setSelectionRange)return elem.setSelectionRange(pos,pos);if(null!=elem.createTextRange)return range=elem.createTextRange(),range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}},placeholderInput:function(){var inputField,nativePlaceholder;return inputField=$(this),nativePlaceholder=void 0!==document.createElement("input").placeholder&&-1===navigator.appVersion.indexOf("MSIE"),nativePlaceholder||null==inputField.attr("placeholder")||(inputField.keypress(function(){return $(this).val()===$(this).attr("placeholder")?($(this).css({color:"#333333"}),$(this).val("")):void 0}),inputField.keyup(function(){return""===$(this).val()?($(this).css({color:"#888888"}),$(this).val(inputField.attr("placeholder")),$(this).setCursorPosition(0)):$(this).val()!==$(this).attr("placeholder")?$(this).css({color:"#333333"}):void 0}),""!==inputField.val())?void 0:(inputField.css({color:"#888888"}),inputField.val(inputField.attr("placeholder")),inputField.setCursorPosition(0))}}),window.create_subscription_result_banner=function(bannerType,bannerMessage,displayStyle){var innerDiv,outerDiv;return 0===$("#email_subscription_subanner").length&&0!==$("#global-container").length?(outerDiv=$('<div id="email_subscription_subanner" style="display:'+displayStyle+'" />'),innerDiv=$('<div id="subscription_success_banner" class="notification '+bannerType+' five subscribe_success" />'),innerDiv.html(bannerMessage),outerDiv.append(innerDiv),$("#global-container").prepend(outerDiv)):void 0},window.set_subscription_result_banner_text=function(bannerMessage){var innerDiv;return 0!==$("#subscription_success_banner").length?(innerDiv=$("#subscription_success_banner"),innerDiv.html(bannerMessage)):void 0},window.retrySubscriptionAfterFailure=function(){var TEN_YEARS_IN_SECONDS,visited;return"undefined"!=typeof Cookie&&null!=Cookie&&(TEN_YEARS_IN_SECONDS=31536e4,visited=parseInt(Cookie.get("subscription_visited")),isNaN(visited)?visited=1:--visited,Cookie.set("subscription_visited",visited,TEN_YEARS_IN_SECONDS)),window.location.reload(),!1};var Kicksend={mailcheck:{threshold:3,defaultDomains:["yahoo.com","google.com","hotmail.com","gmail.com","me.com","aol.com","mac.com","live.com","comcast.net","googlemail.com","msn.com","hotmail.co.uk","yahoo.co.uk","facebook.com","verizon.net","sbcglobal.net","att.net","gmx.com","mail.com"],defaultTopLevelDomains:["co.uk","com","net","org","info","edu","gov","mil"],run:function(opts){opts.domains=opts.domains||Kicksend.mailcheck.defaultDomains,opts.topLevelDomains=opts.topLevelDomains||Kicksend.mailcheck.defaultTopLevelDomains,opts.distanceFunction=opts.distanceFunction||Kicksend.sift3Distance;var result=Kicksend.mailcheck.suggest(encodeURI(opts.email),opts.domains,opts.topLevelDomains,opts.distanceFunction);result?opts.suggested&&opts.suggested(result):opts.empty&&opts.empty()},suggest:function(email,domains,topLevelDomains,distanceFunction){email=email.toLowerCase();var emailParts=this.splitEmail(email),closestDomain=this.findClosestDomain(emailParts.domain,domains,distanceFunction);if(closestDomain){if(closestDomain!=emailParts.domain)return{address:emailParts.address,domain:closestDomain,full:emailParts.address+"@"+closestDomain}}else{var closestTopLevelDomain=this.findClosestDomain(emailParts.topLevelDomain,topLevelDomains);if(emailParts.domain&&closestTopLevelDomain&&closestTopLevelDomain!=emailParts.topLevelDomain){var domain=emailParts.domain;return closestDomain=domain.substring(0,domain.lastIndexOf(emailParts.topLevelDomain))+closestTopLevelDomain,{address:emailParts.address,domain:closestDomain,full:emailParts.address+"@"+closestDomain}}}return!1},findClosestDomain:function(domain,domains,distanceFunction){var dist,minDist=99,closestDomain=null;if(!domain||!domains)return!1;distanceFunction||(distanceFunction=this.sift3Distance);for(var i=0;i<domains.length;i++){if(domain===domains[i])return domain;dist=distanceFunction(domain,domains[i]),minDist>dist&&(minDist=dist,closestDomain=domains[i])}return minDist<=this.threshold&&null!==closestDomain?closestDomain:!1},sift3Distance:function(s1,s2){if(null==s1||0===s1.length)return null==s2||0===s2.length?0:s2.length;if(null==s2||0===s2.length)return s1.length;for(var c=0,offset1=0,offset2=0,lcs=0,maxOffset=5;c+offset1<s1.length&&c+offset2<s2.length;){if(s1.charAt(c+offset1)==s2.charAt(c+offset2))lcs++;else{offset1=0,offset2=0;for(var i=0;maxOffset>i;i++){if(c+i<s1.length&&s1.charAt(c+i)==s2.charAt(c)){offset1=i;break}if(c+i<s2.length&&s1.charAt(c)==s2.charAt(c+i)){offset2=i;break}}}c++}return(s1.length+s2.length)/2-lcs},splitEmail:function(email){var parts=email.split("@");if(parts.length<2)return!1;for(var i=0;i<parts.length;i++)if(""===parts[i])return!1;var domain=parts.pop(),domainParts=domain.split("."),tld="";if(0==domainParts.length)return!1;if(1==domainParts.length)tld=domainParts[0];else{for(var i=1;i<domainParts.length;i++)tld+=domainParts[i]+".";domainParts.length>=2&&(tld=tld.substring(0,tld.length-1))}return{topLevelDomain:tld,domain:domain,address:parts.join("@")}}}};window.jQuery&&!function($){$.fn.mailcheck=function(opts){var self=this;if(opts.suggested){var oldSuggested=opts.suggested;opts.suggested=function(result){oldSuggested(self,result)}}if(opts.empty){var oldEmpty=opts.empty;opts.empty=function(){oldEmpty.call(null,self)}}opts.email=this.val(),Kicksend.mailcheck.run(opts)}}(jQuery),void function(){var Application;Application=function(){function Application(instance){var registerNamespace,registerTopLevelNamespace;this.ExperimentVersions={},registerTopLevelNamespace=function(this$){return function(){return _(NAMESPACES).each(function(this$1){return function(ns){return this$1[ns]={}}}(this$))}}(this),registerNamespace=function(this$){return function(name){return _(NAMESPACES).each(function(this$1){return function(ns){return this$1[ns][name]={}}}(this$))}}(this),registerTopLevelNamespace(),registerNamespace("Subscription"),registerNamespace("Validate")}var NAMESPACES;return NAMESPACES=["Collections","Models","Views"],Application.prototype.vent=_(Backbone.Events).clone(),Application}(),null!=window.Groupon?window.Groupon:window.Groupon={},Groupon.BackboneApp=new Application}.call(this),Groupon.Validate={email:function(value){var re;return value=$.trim(value),value.length>100?!1:(re=/^(^[a-zA-Z0-9\!\#\$\%\&'\*\+\-\/\=\?\^\_\`\{\|\}\~]+[.]?[a-zA-Z0-9\!\#\$\%\&'\*\+\-\/\=\?\^\_\`\{\|\}\~]+|[a-zA-Z0-9\!\#\$\%\&'\*\+\-\/\=\?\^\_\`\{\|\}\~]{1})@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i,re.test(value))},zip:function(value){var regexp,zip;return""===value||"undefined"===value?!1:(zip=$.trim(value),regexp=/(^([0-9]{5}(-[0-9]{4})?)$)|(^[ABCEGHJKLMNPRSTVXYabceghjklmnprstvxy]{1}\d{1}[A-Za-z]{1} *\d{1}[A-Za-z]{1}\d{1}$)/,regexp.test(zip))}},Groupon.EmailZip=function(){function EmailZip(){email.emailSuggestions(),email.placeholderInput(),postal_code.placeholderInput(),setTimeout(function(){return email.setCursorPosition(0)},100)}var email,error,postal_code,submit_button,success,updated_email_bg_position,updated_zip_bg_position;return success="js-success",error="js-error",postal_code=$("#postal_code_id"),email=$("#email_id"),submit_button=$("#submit_button"),updated_email_bg_position=!1,updated_zip_bg_position=!1,email.keydown(function(e){return 13!==e.keyCode||Groupon.EmailZip.validateAttributes(email,postal_code)?void 0:e.preventDefault()}),email.keyup(function(e){return Groupon.EmailZip.emailChanged(e)}),email.on("change input",function(e){return Groupon.EmailZip.emailChanged(e)}),postal_code.keyup(function(e){return Groupon.EmailZip.postalCodeChanged(e)}),postal_code.keydown(function(e){return 13!==e.keyCode||Groupon.EmailZip.validateAttributes(email,postal_code)?void 0:e.preventDefault()}),postal_code.change(function(e){return Groupon.EmailZip.postalCodeChanged(e)}),submit_button.click(function(e){return Groupon.EmailZip.stepSubmit(e)}),$("#hide_banner").click(function(e){return Groupon.EmailZip.hideBanner(e)}),$("#nothx").click(function(e){return Groupon.EmailZip.triggerClose(),e.preventDefault(),!0}),$("#closeid").click(function(e){return Groupon.EmailZip.triggerClose()}),$("#continue").click(function(e){return Groupon.EmailZip.triggerClose()}),$(document).ready(function(){var $bg,resizeSubsBg,theWindow;return resizeSubsBg=function(){var newHeight,newWidth;return theWindow.width()/theWindow.height()<subs_bg_aspectRatio?(newWidth=theWindow.height()*subs_bg_aspectRatio,$bg.css({top:"0px",height:theWindow.height()+"px",width:newWidth+"px",left:(theWindow.width()-newWidth)/2+"px"})):(newHeight=theWindow.width()/subs_bg_aspectRatio,$bg.css({left:"0px",width:theWindow.width()+"px",height:newHeight+"px",top:(theWindow.height()-newHeight)/2+"px"}))},theWindow=$(window),$bg=$("#subscription-bg"),$bg.length>0?theWindow.resize(resizeSubsBg).trigger("resize"):void 0}),EmailZip.inputSuccessHandler=function(input){return input.removeClass(error),input.addClass(success),submit_button.attr("disabled",!1)},EmailZip.errorHandler=function(){return this.emailHandler(),this.postalCodeHandler(),submit_button.attr("disabled",!0)},EmailZip.inputErrorHandler=function(input){return input.removeClass(success),input.addClass(error),submit_button.attr("disabled",!0)},EmailZip.emailHandler=function(ev){return this.validateEmail(email.val())?(this.inputSuccessHandler(email),13===(null!=ev?ev.keyCode:void 0)?submit_button.trigger("click"):void 0):null!=email.attr("placeholder")&&email.val()===email.attr("placeholder")?(email.removeClass("js-success"),email.removeClass("js-error")):this.inputErrorHandler(email)},EmailZip.postalCodeHandler=function(ev){return this.validateZipCode(postal_code.val())?(this.inputSuccessHandler(postal_code),13===(null!=ev?ev.keyCode:void 0)?submit_button.trigger("click"):void 0):null!=postal_code.attr("placeholder")&&postal_code.val()===postal_code.attr("placeholder")?(postal_code.removeClass("js-success"),postal_code.removeClass("js-error")):this.inputErrorHandler(postal_code)},EmailZip.emailChanged=function(ev){return this.completed?void 0:(updated_email_bg_position||($("body").hasClass("rtl")||$("#sub_dlg").hasClass("centered")||email.css({backgroundPosition:email.width()+12+"px"}),updated_email_bg_position=!0),this.emailHandler(ev),""===$(ev.currentTarget).val()?email.removeClass(error):void 0)},EmailZip.postalCodeChanged=function(ev){return updated_zip_bg_position||($("body").hasClass("rtl")||postal_code.css({backgroundPosition:postal_code.width()+12+"px"}),updated_zip_bg_position=!0),this.completed?void 0:(this.postalCodeHandler(ev),""===$(ev.currentTarget).val()?postal_code.removeClass(error):void 0)},EmailZip.stepSubmit=function(ev){return ev.preventDefault(),this.validateAttributes(email,postal_code)?(this.completed=!0,$("#sub_dlg").trigger("dismiss"),$("#sub_non_modal").trigger("dismiss"),$("#js-zip-modal-step").trigger("dismiss"),$.ajax({type:"POST",dataType:"json",url:ev.currentTarget.form.action,data:$(ev.currentTarget.form).serialize(),success:function(data){var bannerText,i18nObj,successStringKey;return i18nObj=I18n,successStringKey="js.modules.subscription.subscription_success","undefined"!=typeof subsI18n&&null!=subsI18n&&(i18nObj=subsI18n),null!=data.incentiveStatus&&"success"===data.incentiveStatus&&(successStringKey="js.modules.subscription.subscription_success_subsave"),bannerText=i18nObj.translate(successStringKey,{division:data.divisionName,email:email.val()}),window.create_subscription_result_banner("success",bannerText,"block"),null!=window._subscriptionSuccessCallback&&window._subscriptionSuccessCallback(data.divisionId,postal_code.val()),OptimizeSuite.TrackingHub.add("goalEmailZip",{goalType:"subscription",goalId:data.subscriptionId}),OptimizeSuite.InteractionGoals.subscription({scid:Cookie.get("scid"),division:"undefined"!=typeof Optimize&&null!=Optimize&&null!=Optimize.suiteData?Optimize.suiteData.division:void 0,country:"undefined"!=typeof Optimize&&null!=Optimize&&null!=Optimize.suiteData?Optimize.suiteData.country:void 0,channel:"undefined"!=typeof Optimize&&null!=Optimize&&null!=Optimize.suiteData?Optimize.suiteData.channel:void 0,clickId:OptimizeSuite.getLastEventId(),consumerId:data.consumerId}),$("#sub_dlg").trigger("success"),$("#sub_non_modal").trigger("success"),$("#js-zip-modal-step").trigger("success")},error:function(xhr){var bannerText,i18nObj;return i18nObj=I18n,"undefined"!=typeof subsI18n&&null!=subsI18n&&(i18nObj=subsI18n),bannerText=i18nObj.translate("js.modules.subscription.subscription_failure",{link_open:"<a href='#' onclick='retrySubscriptionAfterFailure()'>",link_close:"</a>"}),window.create_subscription_result_banner("error",bannerText,"block"),OptimizeSuite.TrackingHub.add("goalEmailZip",{goalType:"subscription",fail:xhr.responseText}),$("#sub_dlg").trigger("fail"),$("#sub_non_modal").trigger("fail")}})):this.errorHandler()},EmailZip.hideBanner=function(ev){return Cookie.set("close_subscribe_drawer",!0),$("#sub_non_modal").trigger("dismiss")},EmailZip.triggerClose=function(){return $("#sub_dlg").trigger("close"),$("#js-zip-modal-step").trigger("close")},EmailZip.validateAttributes=function(email,zip){return(0===zip.size()||this.validateZipCode(zip.val()))&&this.validateEmail(email.val())},EmailZip.validateEmail=function(email){return null==email||""===email?!1:Groupon.Validate.email(email)},EmailZip.validateZipCode=function(zip){return null==zip||""===zip?!1:Groupon.Validate.zip(zip)},EmailZip}(),new Groupon.EmailZip,void function(){function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}var GrouponSDSCommon;GrouponSDSCommon=function(){function GrouponSDSCommon(){}var COMMON_MOBILE_DISPLAY_EXPERIMENT,NAQ_APP_NAMES,SEO_MOBILE_DISPLAY_EXPERIMENT,TWENTYFOUR_HOURS_LIFE_IN_SECONDS;return TWENTYFOUR_HOURS_LIFE_IN_SECONDS=86400,NAQ_APP_NAMES=["merchant-page","coupon_itier"],COMMON_MOBILE_DISPLAY_EXPERIMENT="subscription-flow-mobile-show-experiment",SEO_MOBILE_DISPLAY_EXPERIMENT="subscription-flow-mobile-seo-show-experiment",GrouponSDSCommon.log=function(title,info){if(null==info&&(info={}),null!=("undefined"!=typeof OptimizeSuite&&null!=OptimizeSuite?OptimizeSuite.TrackingHub:void 0)){null==info.goalType&&(info.goalType="subscription"),null==info.uiSource&&(info.uiSource="sds");try{return OptimizeSuite.TrackingHub.add(title,info)}catch(e$){return null}}},GrouponSDSCommon.dismissModal=function(container){return null!=container&&("function"==typeof container.hide&&container.hide(),"function"==typeof container.hideSpotlight)?container.hideSpotlight():void 0},GrouponSDSCommon.getAppName=function(){return null!=$("head").attr("data-app")&&$("head").attr("data-app").length>0?encodeURIComponent($("head").attr("data-app")):null!=("undefined"!=typeof Optimize&&null!=Optimize&&null!=Optimize.suiteData?Optimize.suiteData.app:void 0)&&("undefined"!=typeof Optimize&&null!=Optimize&&null!=Optimize.suiteData?Optimize.suiteData.app.length:void 0)>0?encodeURIComponent(Optimize.suiteData.app):void 0},GrouponSDSCommon.showSuccessNotification=function(){return $("#email_subscription_subanner").length>0&&$("#email_subscription_subanner").show(),$("#notice_banner").length>0?$("#notice_banner").show():void 0},GrouponSDSCommon.gtmSubscribeEvent=function(){return"undefined"!=typeof dataLayer&&null!=dataLayer?dataLayer.push({event:"subscription"}):void 0},GrouponSDSCommon.gtmSubscribeLandingEvent=function(subsave){if(null==subsave&&(subsave=!1),subsave){if("undefined"!=typeof dataLayer&&null!=dataLayer)return dataLayer.push({event:"subscription/save"})}else if("undefined"!=typeof dataLayer&&null!=dataLayer)return dataLayer.push({event:"subscription/landing"})},GrouponSDSCommon.isSubForced=function(){return("undefined"!=typeof window&&null!=window&&null!=window.location&&null!=window.location.href?window.location.href.indexOf("subs_force="):void 0)>-1},GrouponSDSCommon.fpBasedShow=function(fpShowFn,fpHideFn){var fpCookie,fpHide;return fpCookie=Cookie.get("subs_fp_hide"),null==fpCookie?fpShowFn():(Cookie.unset("subs_fp_hide",$("head").data("domain")),fpHide="1"===fpCookie,fpHide?(Cookie.set("hide_sub_modal",1),fpHideFn()):fpShowFn(),GrouponSDSCommon.log("subscriptionFpHide",{fpHide:fpHide}))},GrouponSDSCommon.isEmailClickTraffic=function(){var utm_medium;return null!=("undefined"!=typeof window&&null!=window&&null!=window.location?window.location.href:void 0)&&(utm_medium=new RegExp("[\\?&]utm_medium=([^&#]*)").exec(window.location.href)),null!=utm_medium&&null!=utm_medium[1]&&"email"===utm_medium[1].toLowerCase()||"undefined"!=typeof Cookie&&null!=Cookie&&"email"===Cookie.get("_tpmed")?!0:!1},GrouponSDSCommon.isMobileSkippingTraffic=function(){var appName,cache$,mobileHideModal;return"mobile"!==("undefined"!=typeof TrackingHub&&null!=TrackingHub&&null!=TrackingHub.user&&null!=TrackingHub.user.deviceType?TrackingHub.user.deviceType.toLowerCase():void 0)?!1:(mobileHideModal=!1,appName=null!=(cache$=GrouponSDSCommon.getAppName())?cache$.toLowerCase():void 0,"seo-platform-itier"===appName||"gsm-ita"===appName?"undefined"!=typeof Finch&&null!=Finch&&"function"==typeof Finch.experiment&&Finch.experiment(SEO_MOBILE_DISPLAY_EXPERIMENT,{hideForMobile:function(){return mobileHideModal=!0},showForMobile:function(){return mobileHideModal=!1}}):"undefined"!=typeof Finch&&null!=Finch&&"function"==typeof Finch.experiment&&Finch.experiment(COMMON_MOBILE_DISPLAY_EXPERIMENT,{hideForMobile:function(){return mobileHideModal=!0},showForMobile:function(){return mobileHideModal=!1}}),mobileHideModal)},GrouponSDSCommon.isNAQTraffic=function(url){var appName,cache$,entries,utm_campaign;return null==url&&(url=window.location.href),appName=null!=(cache$=GrouponSDSCommon.getAppName())?cache$.toLowerCase():void 0,utm_campaign=new RegExp("[\\?&]utm_campaign=([^&#]*)").exec(url),in$(appName,NAQ_APP_NAMES)&&null!=(null!=utm_campaign?utm_campaign[1]:void 0)&&(entries=utm_campaign[1].split("_"),"naq"===(null!=entries[5]?entries[5].toLowerCase():void 0))?!0:!1},GrouponSDSCommon.isSkippingTraffic=function(url){var countryDomain,result,urlSkippingTraffic;return null==url&&(url=window.location.href),countryDomain=$("head").data("domain")||"",null!=url&&(urlSkippingTraffic=new RegExp("("+countryDomain+")(/occasion/ideel)").test(url)),result=urlSkippingTraffic||GrouponSDSCommon.isMobileSkippingTraffic(),result&&"undefined"!=typeof Cookie&&null!=Cookie&&Cookie.set("hide_sub_modal",1,TWENTYFOUR_HOURS_LIFE_IN_SECONDS,countryDomain),result},GrouponSDSCommon.setupSuccessCallback=function(){var appName,cache$,previousDivision;switch(previousDivision="undefined"!=typeof Cookie&&null!=Cookie?Cookie.get("division"):void 0,appName=null!=(cache$=GrouponSDSCommon.getAppName())?cache$.toLowerCase():void 0){case"pull":return window._subscriptionSuccessCallback=function(divisionId,postalCode){return(null!=window.SubscriptionsUI?window.SubscriptionsUI._should_show_doi():void 0)||previousDivision===divisionId?(GrouponSDSCommon.gtmSubscribeEvent(),GrouponSDSCommon.showSuccessNotification()):window.location="/browse/"+divisionId+"?post_subscribe=true"};case"homepage":return window._subscriptionSuccessCallback=function(divisionId,postalCode){return(null!=window.SubscriptionsUI?window.SubscriptionsUI._should_show_doi():void 0)?(GrouponSDSCommon.gtmSubscribeEvent(),GrouponSDSCommon.showSuccessNotification()):window.location="?post_subscribe=true"}}},GrouponSDSCommon}(),window.GrouponSDSCommon=GrouponSDSCommon,window._useSDS=!0}.call(this),void function(){var GrouponSDS;GrouponSDS=function(){function GrouponSDS(){var showContainer,showSubsUI;return(null!=window.SubscriptionsUI&&"function"==typeof window.SubscriptionsUI._should_show_doi?window.SubscriptionsUI._should_show_doi():void 0)?void $("#global-container").show():void(this.shouldHideUI()?$("#global-container").show():(showSubsUI=function(this$){return function(){return GrouponSDSCommon.setupSuccessCallback(),this$.showModal()}}(this),showContainer=function(){return $("#global-container").show()},GrouponSDSCommon.fpBasedShow(showSubsUI,showContainer)))}var alt_focus_input_id,dlg_id,focus_input_id;return dlg_id="#sub_dlg",focus_input_id="#email_id",alt_focus_input_id="#email",GrouponSDS.prototype.shouldHideUI=function(){var hideUI,subForced;return subForced=GrouponSDSCommon.isSubForced(),hideUI=!subForced&&!GrouponSDSCommon.isNAQTraffic()&&GrouponSDSCommon.isEmailClickTraffic(),hideUI?GrouponSDSCommon.log("subscriptionUINotShown",{uiType:"modal-dialog"}):subForced&&GrouponSDSCommon.log("subscriptionUIForced"),hideUI},GrouponSDS.prototype.showModal=function(){var $container,$dlg,dlg_height,dlg_width,now,overlayColor;return $("#global-container").show(),$container=$("#subscribe_modal_container"),$dlg=$(dlg_id),$dlg.hasClass("centered")||(dlg_width=$container.width(),dlg_height=$container.height(),$container.css({top:"50%",left:"50%",height:dlg_height,width:dlg_width,"margin-top":-dlg_height/2,"margin-left":-dlg_width/2})),$container.show(),overlayColor=null!=window._subscriptionOverlayColor?window._subscriptionOverlayColor:"#333","function"==typeof $container.spotlight&&$container.spotlight({opacity:.7,color:overlayColor,exitEvent:"none"}),$(focus_input_id).length>0?$(focus_input_id).focus():$(alt_focus_input_id).length>0&&$(alt_focus_input_id).focus(),GrouponSDSCommon.gtmSubscribeLandingEvent(),now=new Date,window._subsUIshown={uiType:"modal-dialog",time:now.getTime()},$dlg.on("dismiss",function(){return GrouponSDSCommon.dismissModal($container),GrouponSDSCommon.log("subscriptionUIHidden",{uiType:"modal-dialog"})}),$dlg.on("fail",function(){return GrouponSDSCommon.dismissModal($container)}),$dlg.on("success",function(){return GrouponSDSCommon.dismissModal($container),null==window._subscriptionSuccessCallback&&(GrouponSDSCommon.showSuccessNotification(),GrouponSDSCommon.gtmSubscribeEvent()),(null!=window.SubscriptionsUI?window.SubscriptionsUI._should_show_doi():void 0)&&null!=window.SubscriptionsUI?window.SubscriptionsUI._get_doi_modal_and_show("#333"):void 0}),$dlg.on("close",function(){return GrouponSDSCommon.dismissModal($container),"undefined"!=typeof Cookie&&null!=Cookie&&Cookie.set("hide_sub_modal",1,null,$("head").data("domain")),GrouponSDSCommon.log("subscriptionUIHidden",{uiType:"modal-dialog"})})},GrouponSDS}(),window.GrouponSDS=GrouponSDS,window.SDSinit=new GrouponSDS}.call(this),$(document).ready(function(){return $("#subscribe_banner_container, #subscribe_modal_container, #two_step_div").find('[href="/login"]').on("click",function(e){var path,queryString;return window.location.search?(path=encodeURIComponent(""+window.location.pathname+"?"),queryString="?ref="+path+window.location.search.substr(1)):queryString="?ref="+encodeURIComponent(window.location.pathname),$(this).attr("href",""+$(this).attr("href")+queryString)})});