!function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return r(n?n:e)},c,c.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){_.mixin(t.exports={deepClone:function(e){var t;return t=_.clone(e),_.each(t,function(e,n){return _.isObject(e)?t[n]=_.deepClone(e):void 0}),t},isBlank:function(e){return _.isString(e)?!/\S/.test(e):_.isEmpty(e)},escapeRegExp:function(e){return null!=e?String(e).replace(/([-.*+?^=!:${}()|[\]\/\\])/g,"\\$1"):""}})},{}],2:[function(e,t,n){e("../../../core/frontend/groupon_modules/groupon"),Groupon.Keymap={TAB:9,ENTER:13,ESCAPE:27,SPACE:32,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},window.Groupon.AriaMenuNavigation=function(){function e(){}return e.prototype.initMenuNavigation=function(e,t,n,o){return this.$menuTrigger=e,this.$menu=t,this.$menuLinks=n,this.initAriaAttributes(e,t,n,o),this.bindMenu()},e.prototype.initAriaAttributes=function(e,t,n,o){var r,i,a;return t.length&&(i=!0,t[0].id||(t[0].id=_.uniqueId("sls-aria-")),a=t[0].id),e[0].id||(e[0].id=_.uniqueId("sls-aria-")),e.attr({role:"menuitem","aria-haspopup":i,"aria-owns":a,tabindex:"0"}),r=this.ariaFindClosestParent(e,o),r.attr({role:"menubar"}),i?(t.attr({role:"menu","aria-hidden":"true","aria-labelledby":e[0].id}),n.attr({tabindex:"-1",role:"menuitem"})):void 0},e.prototype.ariaFindClosestParent=function(e,t){var n;return null==t&&(t=""),t||(t="LI"===e.parent()[0].nodeName?"ul":"nav"),n=e.closest(t),n=n.length?n:e.closest("div")},e.prototype.bindMenu=function(){return this.ariaBindMenuTrigger(this.$menuTrigger),this.ariaBindMenuLinks()},e.prototype.ariaBindMenuTrigger=function(e){return null==e&&(e=this.$menuTrigger),e.off("keydown"),e.on("keydown",function(e){return function(t){var n,o,r,i;return r=Groupon.Keymap,o=r.SPACE,n=r.DOWN,(i=t.keyCode)===o||i===n?(e.$menu.attr("aria-hidden","false").show(),e.$menuLinks.eq(0).focus().attr("tabindex",0)):void 0}}(this))},e.prototype.ariaBindMenuLinks=function(){return this.$menuLinks.off("keydown"),this.$menuLinks.on("keydown",function(e){return function(t){var n,o,r,i,a,s,u;return a=t.keyCode,u=Groupon.Keymap,i=u.UP,n=u.DOWN,o=u.ESCAPE,r=u.TAB,a===o||a===r?(t.keyCode=o,e.ariaCloseMenu(e.$menuTrigger)):(s=$.inArray(t.currentTarget,e.$menuLinks),a===i&&(0===s?(e.ariaResetIndex(s),e.ariaBrowseLinks(e.$menuLinks.length-1,0)):e.ariaBrowseLinks(s,-1)),a===n?s===e.$menuLinks.length-1?(e.ariaResetIndex(s),e.ariaBrowseLinks(0,0)):e.ariaBrowseLinks(s,1):void 0)}}(this))},e.prototype.ariaBrowseLinks=function(e,t){return this.ariaResetIndex(e),this.$menuLinks.eq(e+t).focus().attr("tabindex","0")},e.prototype.ariaResetIndex=function(e){return this.$menuLinks.eq(e).attr("tabindex","-1")},e.prototype.ariaCloseMenu=function(e){return null==e&&(e=this.$menuTrigger),this.$menu.attr("aria-hidden","true").hide(),this.$menuLinks.attr("tabindex","-1"),e.focus()},e}()},{"../../../core/frontend/groupon_modules/groupon":8}],3:[function(e,t,n){var o;o=e("./setSiteCookies"),Groupon.setWindowLocation=e("./setWindowLocation"),t.exports=Groupon.Utils.changeUserLanguage=function(e){var t,n,r;return o({user_locale:null}),o({user_locale:e}),r="[hreflang='"+e.replace("_","-")+"']",n=(t=$("head link"+r).attr("href"))?t:"/",Groupon.setWindowLocation(n)}},{"./setSiteCookies":17,"./setWindowLocation":18}],4:[function(e,t,n){var o;t.exports=o=function(e,t){var n,o,r,i,a;return navigator.geolocation?(o=(null!=(r=Groupon.Modules)&&null!=(i=r.SearchBar)?i.geolocationOptions:void 0)||{},a=function(t){var n,o,r;return r=null!=t?t.coords:void 0,n=r.latitude,o=r.longitude,Groupon.Utils.trackEvent("client-geolocate-successful",{lat:n,lng:o}),e({lat:n,lng:o})},n=function(e){return Groupon.Utils.trackEvent("client-geolocate-failed",e),t(e)},o.maximumAge||o.timeout?navigator.geolocation.getCurrentPosition(a,n,o):navigator.geolocation.getCurrentPosition(a,n)):t()}},{}],5:[function(e,t,n){var o;document.head||(document.head=document.getElementsByTagName("head")[0]),(o=window.location).origin||(o.origin=window.location.protocol+"//"+window.location.host),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")})},{}],6:[function(e,t,n){t.exports={externalObjectLoader:function(e,t,n){var o,r,i,a,s;null==n&&(n="js-iframe-async"),a=document.createElement("iframe"),a.src="javascript:false",a.title="",a.role="presentation",(a.frameElement||a).style.css="width: 0;height: 0;border: 0",a.frameBorder=0,s=document.getElementsByTagName("script"),s=s[s.length-1],s.parentNode.insertBefore(a,s);try{o=a.contentWindow.document}catch(i){r=i,a.src="javascript:var d=document.open();d.domain='"+document.domain+"';void 0",o=a.contentWindow.document}return o.open()._load3po=function(){var o,r;return"undefined"!=typeof dom&&null!==dom&&(this.domain=dom),r=this.createElement("script"),r.type="text/javascript",r.innerHTML="Groupon=window.parent.Groupon;$=window.parent.$",this.body.appendChild(r),o=this.createElement("script"),o.type="text/javascript",o.id=n,o.src=e,null!=t&&(o.onload=t),this.body.appendChild(o)},o.write('<body onload="document._load3po();">'),o.close()},externalObjectLoaderOnready:function(e){return"function"==typeof e?$(document).ready(e):void 0}}},{}],7:[function(e,t,n){var o;t.exports=o=function(e){var t,n,o,r;null==e&&(e="domConfig"),t=document.getElementById(e),r=t.textContent||t.innerText;try{return JSON.parse(r)}catch(o){throw n=o,n.message+="\n     Attempted to parse: "+r,n}}},{}],8:[function(e,t,n){var o,r,i,a,s,u,l,c,d,h,p,f,g;g=e("./unparam"),l=e("./getConfigFromDom"),f=e("./trackEvent"),d=e("./makeTag"),c=e("./loadAsyncJS"),a=e("./detectCurrentLocation"),p=e("./setSiteCookies"),h=e("./externalObjectLoader"),s=h.externalObjectLoader,u=h.externalObjectLoaderOnready,null==window.Groupon&&(window.Groupon={}),_.extend(window.Groupon,{Widgets:{}}),null==(o=window.Groupon).LS&&(o.LS={}),_.extend(window.Groupon.LS,{hasTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,Header:{}}),null==(r=window.Groupon).Modules&&(r.Modules={}),null==(i=window.Groupon).Utils&&(i.Utils={}),_.extend(Groupon.Utils,{unparam:g,makeTag:d,getConfigFromDom:l,setSiteCookies:p,externalObjectLoader:s,externalObjectLoaderOnready:u,trackEvent:f,loadAsyncJS:c,detectCurrentLocation:a})},{"./detectCurrentLocation":4,"./externalObjectLoader":6,"./getConfigFromDom":7,"./loadAsyncJS":11,"./makeTag":13,"./setSiteCookies":17,"./trackEvent":19,"./unparam":20}],9:[function(e,t,n){!function(e,t,n){"use strict";var o,r,i;return o=$(t),i=null,r="function"==typeof t.requestAnimationFrame,$.fn.lazyload=function(e){var a,s,u,l,c,d,h,p,f,g,v,m,y;return g={event:"scroll.lazyload",threshold:200,skip_invisible:!0,container:t,performantScroll:!1,dealList:n.querySelectorAll(".t-deals"),isRetina:t.devicePixelRatio&&t.devicePixelRatio>1,placeholder:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",getTouchDealCardHeight:function(){var e,t;return t=0,e=g.dealList,e.length&&("undefined"!=typeof Touch&&null!==Touch?Touch.Utils.getViewportInformation:void 0)&&(t=Touch.Utils.getViewportInformation({offset:2*e[0].offsetLeft}).dcH),t},setTouchImageDimensions:function(e){var n,o;return n=function(){var t,n,r,i;for(i=[],t=0,r=e.length;r>t;t++)n=e[t],n.parentNode.parentNode.parentNode.className.match(/t-deals/)?i.push(n.height=o):i.push(void 0);return i},(o=g.getTouchDealCardHeight())?r?t.requestAnimationFrame(n):n():void 0}},s=this.get(),e&&$.extend(g,e),g.resetImageDimensions?void g.setTouchImageDimensions(s):(a=(f=g.container)===t||void 0===f?o:$(g.container),v=!1,y=function(e,t){var n,o,r,i;return r=g.threshold,n=t.left,i=t.top,o=t.right,-r>=i?!1:i>=e.height+r?!1:-r>=n?!1:o>=e.width+r?!1:!0},l=function(e){var t,n,o,r,i,a;for(o=[],e=e.slice();t=e.shift();)r=t.getBoundingClientRect(),a=r.top,n=r.left,i=r.right,o.push({left:n,top:a,right:i});return o},u=function(){var e,t;return e=this.getAttribute("data-original"),g.isRetina&&(t=this.getAttribute("data-original-2x"))&&(e=t),"IMG"===this.nodeName?this.src=e:this.style.backgroundImage="url('"+e+"')",this.loaded=!0},c=function(){return{height:t.innerHeight||o.height(),width:t.innerWidth||o.width()}},d=function(e){var t,n;for(n=[],e=e.slice();t=e.shift();)!t.loaded&&t.offsetHeight&&n.push(t);return n},m=function(){return g.performantScroll?a.off(g.event):void 0},p=function(){var e,t,n,o,r,i;if(v=!1,!g.skip_invisible)return $(s).trigger("appear"),void m();if(t=d(s),!t.length)return void m();for(e=c(),s=[],r=l(t),i=[];n=t.shift();)o=r.shift(),y(e,o)?i.push($(n).triggerHandler("appear")):i.push(s.push(n));return i},(h=function(e){var t,n,l;for(null===i&&o.on("resize",function(){return i&&clearTimeout(i),i=setTimeout(e,100)}),t=s.slice();n=t.shift();)"IMG"===n.nodeName&&""===n.src&&(n.loaded=!1,n.src=g.placeholder);return g.dealList.length&&g.setTouchImageDimensions(s),$(s).one("appear",u),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&o.one("pageshow",function(e){return e.originalEvent&&e.originalEvent.persisted?$(s).trigger("appear"):void 0}),l=function(){return v?void 0:(requestAnimationFrame(e),v=!0)},a.on(g.event,r?l:e),$(function(){return r?l():e()})})(p))}}(jQuery,window,document)},{}],10:[function(e,t,n){e("../../../core/frontend/groupon_modules/grp-lazyload"),t.exports=Groupon.Utils.lazyLoadImages=function(e){return $(".lazy-load").lazyload(e)}},{"../../../core/frontend/groupon_modules/grp-lazyload":9}],11:[function(e,t,n){var o;t.exports=o=function(e){var t,n;return n=document.createElement("script"),n.async=!0,n.src=e,t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(n,t)}},{}],12:[function(e,t,n){Groupon.loadSiteBlindado=function(){var e;return e=document.createElement("script"),e.setAttribute("async",""),document.body.appendChild(e).src="//cdn.siteblindado.com/aw.js"}},{}],13:[function(e,t,n){var o,r,i,a,s;for(i=function(e,t,n){var o,r,i,a,s;null==t&&(t={}),null==n&&(n=""),"string"==typeof t&&(i=[{},t],t=i[0],n=i[1]),o="<"+e,a="</"+e+">";for(r in t)s=t[r],r=_.escape(r),s=_.escape(String(s)),o+=" "+r+'="'+s+'"';return o+">"+n+a},s=["a"],o=0,r=s.length;r>o;o++)a=s[o],i[a]=_.partial(i,a);t.exports=i},{}],14:[function(e,t,n){var o,r,i,a,s;o=e("../common/underscore_mixins").escapeRegExp,a=s=null,r=function(){var e,t,n,r,i,u,l,c,d;for(t=window.Groupon.charMapping||{},s={},a="",d=_.values(t),i=_.keys(t),a=new RegExp("["+o(d.join(""))+"]","g"),u=d.length;u--;)for(c=d.pop(),n=i.pop(),r=0,l=c.length;l>r;r++)e=c[r],s[e]=n;return a},t.exports=i=function(e){return null==e&&(e=""),e=e.replace(a||r(),function(e){return s[e]}),e.toLowerCase()}},{"../common/underscore_mixins":1}],15:[function(e,t,n){null==window.Groupon&&(window.Groupon={}),null==Groupon.Performance&&(Groupon.Performance={}),Groupon.Performance.pageReady=function(){return"function"==typeof BOOMR.page_ready?BOOMR.page_ready():BOOMR.t_done=(new Date).getTime()}},{}],16:[function(e,t,n){var o;t.exports=o=function(e){var t;return e=e.replace(/, USA$/,""),t=e.split(", "),_.uniq(t,!0).join(", ")}},{}],17:[function(e,t,n){var o,r;o=31536e4,t.exports=r=function(e,t){var n,i,a,s;null==t&&(t=o),n=r.cookieDomain||(r.cookieDomain=$("head").data("domain")),a=[];for(i in e)s=e[i],null!=s?a.push(Cookie.set(i,s,t,n)):a.push(Cookie.unset(i,n));return a}},{}],18:[function(e,t,n){t.exports=Groupon.setWindowLocation=function(e){return window.location.href=e}},{}],19:[function(e,t,n){var o;t.exports=o=function(e,t){var n,o;null==t&&(t={}),n={b:Cookie.get("b"),pageId:location.pathname},t=_.extend({},t,n),"undefined"!=typeof OptimizeSuite&&null!==OptimizeSuite&&null!=(o=OptimizeSuite.TrackingHub)&&o.add(""+e,t)}},{}],20:[function(e,t,n){var o;t.exports=o=function(e){var t,n,o,r,i,a;if(null==e&&(e=location.search),"string"!=typeof e)throw new TypeError("unparam needs a string, but got "+JSON.stringify(e));for(t={},o=e.replace(/\+/g,"%20").split("&"),n=0,i=o.length;i>n;n++)if(r=o[n],a=/^\??([^=]*)=(.*)/.exec(r))try{t[decodeURIComponent(a[1])]=decodeURIComponent(a[2])}catch(s){}return t}},{}],21:[function(e,t,n){Groupon.verifyUserCookies=function(){return setTimeout(function(){var e,t,n;if((n=Groupon.endpoints.verifyCookies)&&(null!=(t=window.sessionStorage)?!t.verifiedCookies:!0))return e=document.createElement("script"),e.id="verify_cookies",e.async=!0,document.body.appendChild(e).src=n,window.sessionStorage?sessionStorage.verifiedCookies=!0:void 0},0)}},{}],22:[function(e,t,n){$(document.head).find("#sls").length||$(document.head).find("script").remove(),e("./groupon_modules/dom_js_shim"),e("./common/underscore_mixins"),e("./groupon_modules/groupon"),e("../../modules/division_selector/frontend/main"),e("../../modules/division_selector/frontend/deprecated"),e("../../modules/gig_cookie_banner/frontend/main"),e("../../modules/gig_search_bar/frontend/index"),e("./groupon_modules/lazyLoadImages"),e("./groupon_modules/performance"),e("../../modules/gig_header_language_menu/frontend/language_selector"),e("../../modules/gig_header/frontend/views/pn_header_v2"),e("../../modules/in_app_messages/frontend/main"),e("../../modules/gig_back2top/frontend/back_to_top"),e("../../modules/points_widget/frontend/main"),e("../../modules/google_maps/frontend/main"),e("../../modules/google_now/frontend/google_now"),e("../../modules/doubleclick/frontend/doubleclick"),e("./groupon_modules/verifyUserCookies"),e("./groupon_modules/loadSiteBlindado"),e("../../modules/qualtrics/frontend/qualtrics"),$(document).ready(function(){var e,t,n,o,r;if($("html").hasClass("lt-ie10")&&$(document.body).removeClass("ls-resp responsive-funnel"),Groupon.Utils.lazyLoadImages(),$(".header-v2").length&&(new Groupon.LS.Header.PNHeaderV2(".header-v2"),new CartWidget(".cart-widget"),new Groupon.Widgets.Points(".ls-points"),(e=$(".lang-menu")).length&&new LanguageSelector(e)),document.getElementById("ls-cookie-banner")&&new CookieBanner("#ls-cookie-banner"),$("body").removeClass("no-js"),Optimize.delayBloodhound||OptimizeSuite.initBloodhound(),new DivisionSelector(".sub-header:not(.deprecated)"),new DeprecatedDivisionSelector(".sub-header.deprecated"),new InAppMessage("#ls-in-app-messages"),$('.getaways-tab-flyout [data-bhc$="ga-search"]').click(function(){return Cookie.unset("flyOut_shown",".groupon.com"),Cookie.unset("flyOut_shown")}),("1"===(r=Cookie.get("has_cpp"))||"true"===r)&&$("#user-my-page").removeClass("hidden"),$(".big-searchbar").length&&$(".loyalty-points-flyout").length&&(o=$(".user-menu").width()+$(".ls-points-link").width()/2,$("head").append("<style>.big-searchbar .loyalty-points-flyout:after{right:0; margin-right: "+o+"px;}</style>")),$("#ZN_6YfZFn20DN7x5hH").length)try{return new Groupon.qualtrics(100,"r","QSI_S_ZN_6YfZFn20DN7x5hH","//zn6yfzfn20dn7x5hh-groupon.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_6YfZFn20DN7x5hH&Q_LOC="+encodeURIComponent(window.location.href)).start()}catch(t){n=t}}),$(window).on("load",function(){return Optimize.delayBloodhound&&setTimeout(function(){return OptimizeSuite.initBloodhound()},100),new Groupon.Widgets.BackToTopButton,Groupon.verifyUserCookies(),$(".footer-siteblindado-br").length?Groupon.loadSiteBlindado():void 0})},{"../../modules/division_selector/frontend/deprecated":23,"../../modules/division_selector/frontend/main":24,"../../modules/doubleclick/frontend/doubleclick":25,"../../modules/gig_back2top/frontend/back_to_top":26,"../../modules/gig_cookie_banner/frontend/main":27,"../../modules/gig_header/frontend/views/pn_header_v2":28,"../../modules/gig_header_language_menu/frontend/language_selector":30,"../../modules/gig_search_bar/frontend/index":38,"../../modules/google_maps/frontend/main":45,"../../modules/google_now/frontend/google_now":46,"../../modules/in_app_messages/frontend/main":47,"../../modules/points_widget/frontend/main":48,"../../modules/qualtrics/frontend/qualtrics":49,"./common/underscore_mixins":1,"./groupon_modules/dom_js_shim":5,"./groupon_modules/groupon":8,"./groupon_modules/lazyLoadImages":10,"./groupon_modules/loadSiteBlindado":12,"./groupon_modules/performance":15,"./groupon_modules/verifyUserCookies":21}],23:[function(e,t,n){var o,r=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;e("../../../modules/division_selector/frontend/main"),o=function(e){function t(e){this.el=e,this.$el=$(this.el),this.initialize(),this.initializeDeprecatedSelector()}return r(t,e),t.prototype.initializeDeprecatedSelector=function(){return this.stateChooser=this.$el.find("#state_chooser"),this.divisionList=this.$el.find("#division_list_new"),this.attachStateChooserListener()},t.prototype.attachStateChooserListener=function(){return this.stateChooser.on("click.chooseState","li:not(.selected)",function(e){return function(t){var n,o,r;return r=$(t.target),o=r.add(e.stateChooser.find("li.selected")),n=e.divisionList.find(".current").add(e.divisionList.find("ul."+r.attr("id"))),o.toggleClass("selected"),n.toggleClass("current")}}(this))},t}(DivisionSelector),window.DeprecatedDivisionSelector=o},{"../../../modules/division_selector/frontend/main":24}],24:[function(e,t,n){var o;o=function(){function e(e){this.el=e,this.$el=$(this.el),this.initialize()}return e.prototype.initialize=function(){return this.moduleDrawer=this.$el.find(".module"),this.moduleControl=this.$el.find(".module-control"),this.subscribeToggle=this.$el.find(".email-link"),this.attachToggleListener(),this.attachHideListener()},e.prototype.attachToggleListener=function(){return this.moduleControl.on("click.toggleDrawer",function(e){return function(t){return e.moduleDrawer.slideToggle()}}(this))},e.prototype.attachHideListener=function(){return this.$el.find(".hide-link").on("click.hideLink",function(e){return function(t){return e.moduleDrawer.slideUp()}}(this))},e.prototype.attachEmailListener=function(){return this.$el.find(".email-link").on("click.emailLink",function(e){return $("#email-address").focus()})},e}(),window.DivisionSelector=o},{}],25:[function(e,t,n){var o=[].slice;t.exports=Groupon.DFPAds={load:function(){var e;return e=document.head,e.querySelector("meta[name='dfp-slot']")||e.querySelector("meta[name='dfp-target']")?(Groupon.Utils.loadAsyncJS("//www.googletagservices.com/tag/js/gpt.js"),googletag.cmd.push(function(){var t,n,r,i,a,s,u;for(u=function(e){e=e.replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");try{e=JSON.parse(e)}catch(t){}return e},n=function(){var e,t,n,r,i,a,s;if(r=arguments[0],s=arguments[1],a=3<=arguments.length?o.call(arguments,2):[],r.name===s){for(e={},t=0,n=a.length;n>t;t++){i=a[t];try{e[i]=u(r.getAttribute("data-"+i))}catch(l){}}return e}},s=e.getElementsByTagName("meta"),r=0,i=s.length;i>r;r++)a=s[r],(t=n(a,"dfp-slot","target","size","div"))?googletag.defineSlot(t.target,t.size,t.div).addService(googletag.pubads()):(t=n(a,"dfp-target","key","val"))&&googletag.pubads().setTargeting(t.key,t.val);return googletag.pubads().enableSingleRequest(),googletag.enableServices()})):void 0}},document.head.querySelector("meta[name='dfp-manual']")||Groupon.DFPAds.load()},{}],26:[function(e,t,n){var o=function(e,t){return function(){return e.apply(t,arguments)}};Groupon.Widgets.BackToTopButton=function(){function e(){this.bind=o(this.bind,this),this.showOrHide=o(this.showOrHide,this),this.requestTick=o(this.requestTick,this);var e;(this.$back2top=$("#ls-back-to-top")).length&&(this.offset=1.5*$(".header-v2 header.header").height(),this.visible=!1,e=window.requestAnimationFrame?this.requestTick:this.showOrHide,$(window).on("scroll",_.throttle(e,1e3)),this.bind())}return e.prototype.requestTick=function(){return window.requestAnimationFrame(this.showOrHide)},e.prototype.showOrHide=function(){var e,t;return t=window.scrollY||window.pageYOffset||document.documentElement.scrollTop,e=t>this.offset,e&&!this.visible?(this.$back2top.css({"z-index":200}),this.$back2top.addClass("ls-back-to-top-visible").attr("aria-hidden","false"),this.visible=!0):this.visible&&!e?(this.$back2top.attr("aria-hidden","true").removeClass("ls-back-to-top-visible"),this.visible=!1):void 0},e.prototype.bind=function(){return this.$back2top.on("click",function(e){return function(){return $("body, html").animate({scrollTop:0},500,function(){return e.$back2top.attr("aria-hidden","true")})}}(this)),this.$back2top.on("transitionend",function(e){return function(){return"0"===e.$back2top.css("opacity")?e.$back2top.css({"z-index":-1}):void 0}}(this))},e}()},{}],27:[function(e,t,n){var o;o=function(){function e(e){this.el=e,this.$el=$(this.el),this.$body=$("#ls-body"),this.initialize()}return e.prototype.initialize=function(){return this.delay=300,Cookie.get("acknowledge_cookies")?void 0:(this.$body.addClass("ls-visible-cookieBanner"),this.$el.fadeIn(this.delay),this.attachHideListener())},e.prototype.attachHideListener=function(){var e;return e=this.$el.find("#ls-accept-cookies"),e.one("click.cookie-banner-action",function(e){return function(t){return t.preventDefault(),Groupon.Utils.setSiteCookies({acknowledge_cookies:!0}),e.$el.fadeOut(e.delay).remove(),e.$body.removeClass("ls-visible-cookieBanner")}}(this))},e}(),window.CookieBanner=o},{}],28:[function(e,t,n){var o=function(e,t){function n(){this.constructor=e}for(var o in t)r.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},r={}.hasOwnProperty;e("../../../../core/frontend/groupon_modules/groupon"),e("../../../../core/frontend/groupon_modules/ariaKeyNavigation"),e("../../../../modules/gig_header/frontend/views/pn_primarynav"),e("../../../../modules/gig_header_responsive_menu/frontend/view/responsive_menu"),Groupon.LS.Header.PNHeaderV2=function(e){function t(e){this.el=e,this.$el=$(this.el),this.$primaryNav=this.$el.find(".primary-nav"),this.initialize(),this.modifyDOM(),this.bind()}return o(t,e),t.prototype.initialize=function(){var e;return $("#ls-lite-header").length||new Groupon.LS.Header.PNPrimaryNav(this.$primaryNav),$("body").is(".responsive-funnel, .ls-responsive")&&(new Groupon.LS.Header.PNResponsiveMenu,(e=$("#ls-resp-lang-menu")).length)?new LanguageSelector(e):void 0},t.prototype.modifyDOM=function(){return $('.user-menu-action[data-bhw*="UserSign"], #sign-out').each(function(){var e,t;return e=location.href,e=e.replace(/(\?|&)?(return_to|ref)=.*/,""),t=/\?/.test(this.href)?"&":"?",t+="return_to="+encodeURIComponent(e),this.href+=t})},t.prototype.truncateTo=function(e,t){var n;for(n=e.text().trim();e.width()>t;)e.text(n=n.replace(/..$/,"â€¦"))},t.prototype.bind=function(){var e,t,n;return(t=$(".user-name")).length?(e=$("#ls-my-stuff"),"IE"===("undefined"!=typeof TrackingHub&&null!==TrackingHub&&null!=(n=TrackingHub.BrowserDetect)?n.browser:void 0)&&this.truncateTo(t,95),Groupon.LS.hasTouch?t.on("tap",function(t){return t.preventDefault(),t.stopImmediatePropagation(),e.toggle(),e.attr("aria-hidden","true"!==e.attr("aria-hidden")),$("html").trigger("tap"),e.is(":visible")?$("html").one("tap",function(t){return 0===$(t.target).closest(".user-name, .my-stuff").length?e.hide().attr("aria-hidden","true"):void 0}):void 0}):this.initMenuNavigation(t,e,e.find("a"))):void 0},t}(Groupon.AriaMenuNavigation)},{"../../../../core/frontend/groupon_modules/ariaKeyNavigation":2,"../../../../core/frontend/groupon_modules/groupon":8,"../../../../modules/gig_header/frontend/views/pn_primarynav":29,"../../../../modules/gig_header_responsive_menu/frontend/view/responsive_menu":31}],29:[function(e,t,n){var o=function(e,t){return function(){return e.apply(t,arguments)}},r=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;e("../../../../core/frontend/groupon_modules/ariaKeyNavigation"),Groupon.LS.Header.PNPrimaryNav=function(e){function t(e){this.$primaryNav=e,this.calcNavWidth=o(this.calcNavWidth,this),this.setRailSlide=o(this.setRailSlide,this),this.moveActiveMarker=o(this.moveActiveMarker,this),this.openSubnav=o(this.openSubnav,this),this.handleOpenSubnav=o(this.handleOpenSubnav,this),this.initialize(),this.bind()}return r(t,e),t.prototype.initialize=function(){return this.$primaryTabs=this.$primaryNav.find(".primary-nav-tab"),this.setTabsDivider(),this.$subnavs=$(".subnav-flyout"),this.localHeightCalculated=!1,this.timeoutID=0,this.$railSlide=$("#ls-rail-slide"),this.enableActiveMarker=$("body.ui-v3").length,setTimeout(this.moveActiveMarker,100),this.setAriaAttributes()},t.prototype.bind=function(){var e,t,n,o,r,i,a,s;return $("html.no-flexboxtweener.no-flexbox").length&&($(window).on("load resize",function(e){return function(){return e.calcNavWidth()}}(this)),$("#global-container").is(":visible")||$("#ls-body").one("runTruncateHtml",function(e){return function(){return e.calcNavWidth()}}(this))),$("body.ls-resp").length&&(i=function(e){return function(t){return e.moveActiveMarker()}}(this),$(window).on("resize",_.debounce(i,50))),o=function(e){return function(){return $(".primary-nav:hover").length||(e.closeSubnav(),window.clearTimeout(e.timeoutID),e.enableActiveMarker)?void 0:e.$railSlide.hide()}}(this),s=function(e){return function(){return e.hovTimeout=setTimeout(o,50)}}(this),n=function(e){return function(){return clearTimeout(e.hovTimeout)}}(this),a=function(e){return function(){return e.activeMarkerTimeout=setTimeout(e.moveActiveMarker,50)}}(this),t=function(e){return function(){return clearTimeout(e.activeMarkerTimeout)}}(this),this.$primaryNav.on({mouseenter:function(){return n(),t()},mouseleave:function(){return s(),a()}}),this.enableActiveMarker&&this.$primaryTabs.on({mouseenter:function(e){return function(n){return t(),e.moveActiveMarker($(n.currentTarget))}}(this)}),this.$subnavs.on({mouseenter:function(){return n(),t()},mouseleave:function(){return s(),a()}}),r="mouseenter",e=this.$primaryTabs.find("a").map(function(){return $("#subnav-"+this.parentNode.id).length?this:void 0}),Groupon.LS.hasTouch&&(r="tap",e.on(r,function(e){return function(t){var n;return n=t.currentTarget.parentNode,t.preventDefault(),t.stopImmediatePropagation(),$("#subnav-"+n.id).is(":visible")?e.closeVisibleSubnav():$(n).trigger(r),!1}}(this)),$("html").on(r,function(e){return function(t){return $(".subnav").height()&&0===$(t.target).closest(".primary-nav, .subnav-flyout","#ls-channel-nav").length?e.closeVisibleSubnav():void 0}}(this))),this.$primaryTabs.on(r,function(e){return function(t){return t.stopPropagation(),e.handleOpenSubnav(t)}}(this)),this.ariaBindMenuTrigger(e)},t.prototype.closeSubnav=function(){var e;return null!=(e=this.$currentFlyoutLinks)&&e.attr("tabindex","-1"),this.$subnavs.hide(),this.$primaryTabs.find("a.active").removeClass("active")},t.prototype.closeVisibleSubnav=function(e){return this.enableActiveMarker||this.$railSlide.hide(),this.closeSubnav(),null!=e&&e.focus(),this.$primaryTabs.find("a.active").removeClass("active")},t.prototype.handleOpenSubnav=function(e){var t,n,o,r,i;return window.clearTimeout(this.timeoutID),r=$(".subnav-flyout").is(":visible")?0:300,this.closeSubnav(),n=$(e.currentTarget),n.is("a")&&(n=n.parent()),o=e.type,t=$("#subnav-"+n.attr("id")),t.length?($(".typeahead-response").hide(),i=function(e){return function(){return e.openSubnav(n,t,o)}}(this),r?this.timeoutID=setTimeout(i,r):i()):this.enableActiveMarker?void 0:this.$railSlide.hide()},t.prototype.openSubnav=function(e,t,n){var o,r,i,a;return o=e.find("a").eq(0),o.addClass("active"),this.enableActiveMarker||this.setRailSlide(o),t.show(),t.find(".ls-lazy").lazyload(),i=t.find(".subnav-megamind-widget:visible").eq(0),a=i.width()/440*420,$("body.ui-v3").length||this.equalizeHeight(t.find(".column:visible"),a),"keydown"===n?(r=t.find("a"),r.attr("tabindex","-1").eq(0).focus().attr("tabindex","0"),this.initMenuNavigation(o,t,r)):void 0},t.prototype.equalizeHeight=function(e,t){return null==t&&(t=0),e.css("height","").each(function(){return t=Math.max(t,$(this).height())}),e.height(t)},t.prototype.moveActiveMarker=function(e){var t,n,o;return null==e&&(e=this.$primaryTabs.filter(".default")),e=e.find("a"),this.enableActiveMarker?(e.length||(e=this.$primaryNav.find(".current")),e.length?(t=e.position().left,n=t-10,o=e.width()+20,this.$railSlide.show().css("left",n).css("width",o)):this.$railSlide.hide()):void 0},t.prototype.setRailSlide=function(e){var t,n;return e.length?(n=e.position().left,t=n+e.width()/2,this.$railSlide.show().css("left",t)):void 0},t.prototype.setTabsDivider=function(){var e,t;return t='<li class="p-nav-divider">|</li>',e=this.$primaryNav.find("li"),e.length<=4&&(e.eq(0).before(t),e.eq(-1).after(t)),e.not(":last").after(t)},t.prototype.calcNavWidth=function(){var e,t,n,o,r;return r=this.$primaryNav.width(),t=this.$primaryTabs,e=t.find("a"),n=_.reduce(e,function(e,t){return e+$(t).outerWidth()},0),n+=8*e.length,t.length>4?(o=(r-n)/(t.length-1),t.first().width(t.first().find("a").outerWidth()+Math.floor(o/2)),t.last().width(t.last().find("a").outerWidth()+Math.floor(o/2)),t.last().addClass("last"),t=t.not(":first").not(":last")):o=(r-n)/t.length,$.each(t,function(e,t){var n;return n=_.reduce($(t).find("a"),function(e,t){return e+$(t).outerWidth()},0),$(t).width(n+Math.floor(o))})},t.prototype.ariaBindMenuTrigger=function(e){return e.off("keydown"),e.on("keydown",function(e){return function(t){var n,o,r,i;return r=Groupon.Keymap,o=r.SPACE,n=r.DOWN,(i=t.keyCode)===o||i===n?e.handleOpenSubnav(t):void 0}}(this))},t.prototype.ariaCloseMenu=function(e){return this.closeVisibleSubnav(e)},t.prototype.setAriaAttributes=function(){var e,t,n,o,r,i,a,s;for(r=this.$primaryTabs,i=[],n=0,o=r.length;o>n;n++)a=r[n],t=$(a),s=a.id,e=$("#subnav-"+s),i.push(this.initAriaAttributes(t.find("a"),e,e.find("a")));return i},t}(Groupon.AriaMenuNavigation)},{"../../../../core/frontend/groupon_modules/ariaKeyNavigation":2}],30:[function(e,t,n){var o,r=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;e("../../../core/frontend/groupon_modules/groupon"),e("../../../core/frontend/groupon_modules/changeUserLanguage"),e("../../../core/frontend/groupon_modules/ariaKeyNavigation"),o=function(e){function t(e){this.bind(e)}return r(t,e),t.prototype.bind=function(e){var t,n,o,r;return t=e,r=t.find(".ls-lang-selected"),n=t.find(".ls-lang-list"),o=t.find(".lang-list-item"),r.length&&n.length&&o.length&&(Groupon.LS.hasTouch?r.on("tap",function(e){return e.preventDefault(),e.stopImmediatePropagation(),n.toggle(),n.attr("aria-hidden","true"!==n.attr("aria-hidden")),$("html").trigger("tap"),n.is(":visible")?$("html").one("tap",function(e){return 0===$(e.target).closest(".lang-menu").length?n.hide().attr("aria-hidden","true"):void 0}):void 0}):this.initMenuNavigation(r,n,o)),o.on("click.selectLang",function(e){var t;return e.preventDefault(),t=$(this).data("locale"),Groupon.Utils.changeUserLanguage(t)})},t}(Groupon.AriaMenuNavigation),window.LanguageSelector=o},{"../../../core/frontend/groupon_modules/ariaKeyNavigation":2,"../../../core/frontend/groupon_modules/changeUserLanguage":3,"../../../core/frontend/groupon_modules/groupon":8}],31:[function(e,t,n){var o=function(e,t){return function(){return e.apply(t,arguments)}};Groupon.LS.Header.PNResponsiveMenu=function(){function e(){this.getVisibility=o(this.getVisibility,this),this.bind=o(this.bind,this),this.alterDOM=o(this.alterDOM,this),this.constructLanguageMenu=o(this.constructLanguageMenu,this),this.constructUserMenu=o(this.constructUserMenu,this),this.constructUserNavigation=o(this.constructUserNavigation,this),this.initialize=o(this.initialize,this);var e,t;this.initialize(),this.$subnavs=this.constructSubNavFlyouts(),
e=this.constructPrimaryNavigation(this.$subnavs),t=this.constructUserNavigation(this.constructUserMenu(),this.constructLanguageMenu()),this.$menu.append(e,t),this.alterDOM(),this.bind()}return e.prototype.initialize=function(){return this.$menu=$("#ls-resp-menu"),this.$body=$("body"),this.$headerRow=$("#ls-header-top-row"),this.$overlay=$("#ls-resp-overlay"),this.$searchBar=$("#ls-search-bar-wrapper"),this.$userMenu=$("#ls-my-stuff"),this.$responsiveMenuWrapper=$("#ls-resp-menu-wrapper"),this.greenHeader=$(".ui-v3").length,this.popoverActiveClass="responsive-show-500",this.popoverTriggerActiveClass="ls-resp-active"},e.prototype.constructPrimaryNavigation=function(e){var t;return t=$("#ls-channel-nav li:not(li.p-nav-divider)").clone().attr({role:"menuitem",style:null,"class":"ls-resp-menu-item"}).each(function(){var t,n,o,r,i;for(o="subnav-"+this.id,n=0,r=e.length;r>n;n++)i=e[n],i.id===o&&i.children.length&&(i.id="ls-resp-"+this.id.replace("-tab","-menu"),$(i).attr({"aria-labelled":null,"aria-labelledby":null,"aria-hidden":null}),t=$(this),t.children("a").attr({id:null,role:null,tabindex:null,"aria-haspopup":null,"aria-owns":null}),t.addClass("icon-arrow-down-large").append(i));return this.id="ls-resp-"+this.id.replace("-tab","-trigger")}),t.find(".icon-home").removeClass(),t.find(".responsive-hide").removeClass(),t},e.prototype.constructSubNavFlyouts=function(){var e;return e=$(".subnav-flyout").clone().attr({"aria-hidden":"true",role:"menu","class":"ls-resp-submenu hide",style:null}),e.find(".subnav-megamind-widget").remove(),e.find(".subnav-link").addClass("ls-resp-submenu-item").unwrap(),e},e.prototype.constructUserNavigation=function(e,t){var n,o,r,i;return i=$(".ls-user-item, .user-menu-item").clone().wrap('<li class="ls-resp-menu-item"></li>').parent(),t.length&&(i=t.add(i)),(r=i.find(".user-name")).length&&(r.attr({href:null,id:"ls-resp-user-name","class":"icon-user",role:null,tabindex:null,"aria-haspopup":null,"aria-owns":null,"aria-describedby":null}).text(r.attr("data-user-name")).parent().attr({id:"subnav-usermenu-menu","class":"ls-resp-menu-item ls-resp-menu-item-user icon-arrow-down-large"}).append(e),o=this.$userMenu.find("#sign-out").clone().attr({id:null,"class":null}).wrap('<li class="ls-resp-menu-item"></li>').parent(),i=i.add(o)),(n=i.find(".cart-widget")).length&&(n=n.find("a"),i.find(".cart-widget").replaceWith(n)),i.find(".ls-user-item, .user-menu-item").removeClass(),i.eq(0).addClass("ls-resp-menu-divider"),i},e.prototype.constructUserMenu=function(){var e;return e={},this.$userMenu.length&&(e=this.$userMenu.clone().attr({"class":"ls-resp-submenu hide",id:"ls-resp-user-menu",role:"menu","aria-labelled":null,"aria-labelledby":null,"aria-hidden":null}),e.find("#sign-out").remove(),e.find("a").addClass("ls-resp-submenu-item").each(function(){return this.id="ls-resp-"+this.id}),this.$subnavs=this.$subnavs.add(e)),e},e.prototype.constructLanguageMenu=function(){var e,t;return t={},$(".lang-menu").length&&(t=$("<span />").text($("#ls-lang-selected").text().trim()).wrap("<li></li>").parent().attr({id:"ls-resp-lang-trigger","class":"ls-resp-menu-item ls-resp-lang-trigger icon-arrow-down-large"}),e=$("#ls-lang-list").clone().attr({id:"ls-resp-lang-menu","class":"ls-resp-submenu hide",role:"menu","aria-labelled":null,"aria-labelledby":null,"aria-hidden":null}),e.find("a").addClass("ls-resp-submenu-item"),t.append(e),this.$subnavs=this.$subnavs.add(e)),t},e.prototype.dedupIDs=function(){return this.$responsiveMenuWrapper.find("*[id]").each(function(){return this.id.match(/ls-resp-/)?void 0:this.id="ls-resp-"+this.id})},e.prototype.alterDOM=function(){return this.$menuTrigger=$("#ls-resp-menu-trigger"),this.$searchTrigger=$("#ls-resp-search-trigger"),$(".header").prepend([this.$menuTrigger,this.$searchTrigger]),$(".header-v2").after(this.$overlay),this.$body.prepend(this.$responsiveMenuWrapper)},e.prototype.bind=function(){var e;return this.$searchTrigger.on("tap",function(e){return function(t){var n,o,r;return t.preventDefault(),t.stopImmediatePropagation(),o=e.getVisibility(),n=o.menuVisible,r=o.searchVisible,n&&e.hideRespMenu(),n||e.toggleOverlay(),e.greenHeader?n||e.$body.toggleClass("noscroll"):e.$body.removeClass("noscroll"),e.$overlay.addClass("ls-resp-overlay-search-v3"),e.$searchTrigger.toggleClass(e.popoverTriggerActiveClass),e.$searchBar.toggleClass(e.popoverActiveClass),$("#search").focus()}}(this)),this.$menuTrigger.on("tap",function(e){return function(t){var n;return t.stopImmediatePropagation(),n=e.getVisibility().searchVisible,n&&e.hideRespSearch(),n||e.toggleOverlay(),e.greenHeader?n||e.$body.toggleClass("noscroll"):e.$body.toggleClass("noscroll"),e.$body.toggleClass("show-responsive-menu"),e.$overlay.removeClass("ls-resp-overlay-search-v3"),e.$menuTrigger.toggleClass(e.popoverTriggerActiveClass),e.toggleAriaHidden(e.$responsiveMenuWrapper)}}(this)),this.$overlay.on("tap",function(e){return function(t){return t.preventDefault(),e.hideRespSearch(),e.hideRespMenu(),e.hideOverlay()}}(this)),e=$(".ls-resp-submenu").parent("li"),e.on("tap",function(t){return function(n){var o,r,i;return r=$(n.currentTarget),i=t.$subnavs.not(".hide").addClass("hide"),e.removeClass("ls-resp-open-menu"),o=r.children(".ls-resp-submenu"),o.length&&!o.is(i)?(r.addClass("ls-resp-open-menu"),o.removeClass("hide"),o.find(".ls-lazy").lazyload()):void 0}}(this)),$(".ls-resp-submenu a").on("tap",function(e){return e.stopImmediatePropagation()})},e.prototype.toggleAriaHidden=function(e){var t;return t=e.attr("aria-hidden"),t="true"===t?"false":"true",e.attr("aria-hidden",t)},e.prototype.getAttributes=function(e,t){var n,o,r,i;for(n=[],r=0,i=e.length;i>r;r++)o=e[r],n.push($(o).attr(t).parent("li").removeClass("ls-resp-open-menu"));return n},e.prototype.getVisibility=function(){return{searchVisible:this.$searchBar.is(":visible"),menuVisible:this.$responsiveMenuWrapper.is(":visible")}},e.prototype.hideRespSearch=function(){return this.$searchBar.is(":visible")?(this.$searchTrigger.removeClass(this.popoverTriggerActiveClass),this.$searchBar.removeClass(this.popoverActiveClass)):void 0},e.prototype.hideRespMenu=function(){return this.$body.removeClass("show-responsive-menu"),this.$menuTrigger.removeClass(this.popoverTriggerActiveClass)},e.prototype.hideOverlay=function(){return this.$overlay.hide(),this.$body.removeClass("noscroll")},e.prototype.toggleOverlay=function(){return this.$overlay.toggle()},e.prototype.removeAria=function(e,t){return $(e).attr({"aria-labelled":null,"aria-labelledby":null,"aria-hidden":null})},e}()},{}],32:[function(e,t,n){var o,r;o="/layout/get_location_sort?callback=?",t.exports=r={getClosestDivision:function(e){var t,n,r,i,a,s,u,l;return null==e&&(e={}),a=e.loc,r=e.lat,i=e.lng,l=e.success,t=e.error,n=document.head.getAttribute("data-language"),s=document.head.getAttribute("data-locale"),null!=(u=this._xhr)&&u.abort(),this._xhr=$.getJSON(o,{loc:a,lat:r,lng:i,lang:n,locale:s},l),this._xhr.fail(t)},abort:function(){var e;return null!=(e=this._xhr)?e.abort():void 0}}},{}],33:[function(e,t,n){var o,r,i,a=function(e,t){return function(){return e.apply(t,arguments)}};o=e("./closest_division"),i=e("../../../../core/frontend/groupon_modules/presentAddress"),t.exports=r=function(){function e(){this._googleGeocodeSuccessHandler=a(this._googleGeocodeSuccessHandler,this)}return e.prototype.geocode=function(e){var t,n,r,i;return null==e&&(e={}),t=e.address,i=e.location,n=e.country,r=e.current_location,null!=t||null!=i?(o.abort(),this.getLatLng({address:r?void 0:t,location:r?i:void 0,country:n,success:_.partial(this._googleGeocodeSuccessHandler,e),error:_.partial(this._googleGeocodeErrorHandler,e)})):void 0},e.prototype.getLatLng=function(e){var t,n;return null==e&&(e={}),n=e.success,t=e.error,Groupon.Utils.GoogleMaps.load(function(o){var r,i,a,s;return r=e.address,a=e.location,i=e.country,n=e.success,t=e.error,null!=o?"function"==typeof t?t():void 0:(s={location:a},null!=r&&(s={address:r}),"US"!==i&&(s.componentRestrictions={country:i}),(new window.google.maps.Geocoder).geocode(s,function(e,t){return"function"==typeof n?n({results:e,status:t}):void 0}))})},e.prototype.fetchClosestDivision=function(e){var t,n,r,i,a;return t=e.address,r=e.lat,i=e.lng,a=_.partial(this._closestDivisionSuccessHandler,e),n=_.partial(this._closestDivisionErrorHandler,e),o.getClosestDivision({loc:t,lat:r,lng:i,success:a,error:n})},e.prototype._googleGeocodeSuccessHandler=function(e,t){var n,o,r,a,s,u,l,c,d,h,p,f,g,v,m,y,b,$,w,k;return n=e.address,l=e.geocoderSuccess,u=e.geocoderError,o=e.country,r=e.current_location,w=t.results,k=t.status,"OK"!==k?(k="ZERO_RESULTS"===k?"BAD_LOCATION":"UNAVAILABLE",u({address:n,status:k})):("US"!==o||r||(w=_.filter(w,function(e){var t;return t=e.address_components,_.some(t,function(e){var t;return t=e.short_name,"US"===t||"CA"===t})})),b=function(e){return _.some(e.types,function(e){return"street_address"===e||"locality"===e||"sublocality"===e||"country"===e||"political"===e||"postal_code"===e})},($=_.find(w,b))?(c=function(e,t){var n;return n=e.address_components,_.find(n,function(e){var n;return n=e.types,_.some(n,function(e){return e===t})})},a=i($.formatted_address),s={fullAddress:a,friendlyName:a,lat:$.geometry.location.lat(),lng:$.geometry.location.lng(),locality:null!=(p=c($,"locality"))?p.long_name:void 0,administrative_area:null!=(f=c($,"administrative_area_level_1"))?f.short_name:void 0,sublocality:null!=(g=c($,"sublocality_level_1"))?g.short_name:void 0,postal_code:null!=(v=c($,"postal_code"))?v.short_name:void 0,neighborhood:null!=(m=c($,"neighborhood"))?m.short_name:void 0},r&&(y=e.location,d=y.lat,h=y.lng,s.lat=d,s.lng=h),d=s.lat,h=s.lng,e=_.extend({},e,{geocoderData:s,lat:d,lng:h}),this.fetchClosestDivision(e)):u({address:n,status:"BAD_LOCATION"}))},e.prototype._googleGeocodeErrorHandler=function(e,t){var n;return(n=e.geocoderError)("abort"===t?{status:"ABORT"}:{address:e.address,status:"UNAVAILABLE"})},e.prototype._closestDivisionSuccessHandler=function(e,t){var n,o,r,i,a,s,u,l,c,d;return n=e.address,i=e.geocoderData,s=e.geocoderSuccess,a=e.geocoderError,r=e.current_location,"ok"!==(null!=t?t.status:void 0)&&null==t.geoData?a({address:n,data:i,status:"BAD_LOCATION"}):(d=t.location,u=d.lat,l=d.lng,o=d.closest_division,c=_.extend({},i,{lat:u,lng:l,closestDivision:o}),t={address:n,locationData:c},null!=r&&(t.current_location=r),s(t))},e.prototype._closestDivisionErrorHandler=function(e,t,n){var o,r,i,a;return i=e.geocoderData,o=e.address,a=e.geocoderError,r="abort"===n?{status:"ABORT"}:{address:o,data:i,status:"UNAVAILABLE"},a(r)},e}()},{"../../../../core/frontend/groupon_modules/presentAddress":16,"./closest_division":32}],34:[function(e,t,n){var o,r,i,a,s,u,l,c;l=9,r=13,i=27,o=40,u=39,c=38,s=37,t.exports=a={isValidCharKeyPress:function(e){return null==e.which?!1:this.isCharKeyPress(e)&&this.isValidKeyPress(e.which)?!0:!1},isCharKeyPress:function(e){return"number"==typeof e.which&&e.which>0?!e.ctrlKey&&!e.metaKey&&!e.altKey:!1},isValidKeyPress:function(e){return!(e===l||e===r||e===i||e===c||e===o||e===s||e===u)},isTabKey:function(e){return e===l},isEnterKey:function(e){return e===r},isEscapeKey:function(e){return e===i},isUpArrowKey:function(e){return e===c},isDownArrowKey:function(e){return e===o}}},{}],35:[function(e,t,n){var o,r,i,a,s,u,l,c,d,h=[].slice;a="LS_geolocation",o=function(e){return{get:function(){return e},set:function(t){return e=t}}}(null),i=function(e){return e?decodeURIComponent(e).replace(/\+/g," "):void 0},u=function(){return i(Groupon.Utils.unparam().address)},l=function(){var e,t,n,o;if(o={},null!=(n=Cookie.get("search_loc")))try{o=JSON.parse(decodeURIComponent(n))}catch(t){e=t;try{o=decodeURIComponent(JSON.parse(n))}catch(r){}}return o},d=function(e){var t,n,r;return t=null!=e?e.closestDivision:void 0,n=null!=(r=o.get())?r.id:void 0,t===n},s=function(){var e;return e=l(),d(e)?i(e.fullAddress):void 0},c=function(){var e;return e=l(),d(e)?_.pick(e,["lat","lng","administrative_area","locality","sublocality","neighborhood","postal_code"]):void 0},t.exports=r={setDivision:o.set,getDivision:o.get,setSearchLocCookie:function(e){return e=_.pick(e,["lat","lng","closestDivision","friendlyName","fullAddress","administrative_area","locality","sublocality","neighborhood","postal_code"]),Cookie.set("search_loc",encodeURIComponent(JSON.stringify(e)))},getInitialLocation:function(){var e,t,n,o;return null!=(e=null!=(t=null!=(n=null!=(o=this.getInitalGeolocationAddress())?o:u())?n:s())?t:this.userFriendlyLocation())?e:""},getInitialLocationData:function(){var e,t,n,r,i;return t=function(){var e,t,n,o,r,i,a;for(a=2<=arguments.length?h.call(arguments,0,n=arguments.length-1):(n=0,[]),i=arguments[n++],o=0,r=a.length;r>o&&(t=a[o],e=_.pick(t||{},i),_.isEmpty(e));o++);return e},i=Groupon.Utils.unparam(),r=c(),n=t(i,r,o.get(),["lat","lng"]),e=t(i,r,["administrative_area","locality","sublocality","neighborhood","postal_code"]),_.extend(n,e)},getInitalGeolocationAddress:function(){return Cookie.get("division")===this.getGeolocationData("current_location").closestDivision?i(this.getGeolocationData("current_location").address):void 0},userFriendlyLocation:function(e){var t,n,r;return null==e&&(e=o.get()),null==e?"":(n=e.name,t=null!=(r=e.state)?r.abbreviation:void 0,null!=t?n+", "+t:n)},getGeolocationData:function(e){var t,n;n=function(){var e;return null!=(e=Cookie.get(a))?decodeURIComponent(e):void 0};try{t="undefined"!=typeof localStorage&&null!==localStorage?localStorage[a]:void 0}catch(o){t=n()}return null!=t&&("object"!=typeof t&&(t=JSON.parse(t)),null!=e&&(t=t[e])),t||{}},setGeolocationData:function(e,t){var n;if(null!=e&&null!=t){("undefined"!=typeof localStorage&&null!==localStorage?localStorage[a]:void 0)||(localStorage[a]="{}"),n=this.getGeolocationData(),n[e]=t,n=JSON.stringify(n);try{return localStorage[a]=n}catch(o){return Cookie.set(a,encodeURIComponent(n))}}},removeGeolocationData:function(e){var t;if(null!=e){t=this.getGeolocationData(),delete t[e],t=JSON.stringify(t);try{return"undefined"!=typeof localStorage&&null!==localStorage?localStorage[a]=t:void 0}catch(n){return Cookie.set(a,encodeURIComponent(t))}}}}},{}],36:[function(e,t,n){var o,r,i,a,s,u,l,c,d,h,p,f,g,v,m,y=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};r=e("../common/location"),v=e("../../../../core/frontend/groupon_modules/normalizeQuery"),s=e("underscore"),a=i=void 0,o=["administrative_area","locality","sublocality","neighborhood","postal_code"],u=function(e){var t,n,r;switch(t=((null!=e&&null!=(r=e.address)?r.split(","):void 0)||[]).map(function(e){return e.trim()}),e=s.omit(e,o),n={friendlyName:e.address,fullAddress:e.address},t.length){case 1:n.postal_code=t[0];break;case 2:n.locality=t[0],n.administrative_area=t[1];break;case 3:n.neighborhood=t[0],n.locality=t[1],n.administrative_area=t[2]}return e.geocoderData=n,e},l=function(e){var t,n,o,r,i;if(a=(window.Groupon.Modules.SearchBar||{}).SearchOverrides,null!=a&&e)for(e=e.toLowerCase().trim(),t=0,n=a.length;n>t;t++)if(r=a[t],o=r.link,i=r.terms,!(y.call(i,e)<0))return o;return null},h=function(){var e;return(e=r.getDivision())?{lat:e.lat,lng:e.lng,fullAddress:r.userFriendlyLocation(e),closestDivision:e.id}:void 0},c=function(e){return e.locale=document.head.getAttribute("data-locale"),$.param(s.pick(e,s.identity)).replace(/\s|%20/g,"+")},g=function(e,t){var n,o,r,i,a,u,l,d,h,p;return p=c(t),h="/browse/"+e+"?"+p,a=null!=(l=window.Groupon.LS.Experiments)?l["LS-1774-LocationRedirect"]:void 0,a&&!t.query&&(u=new RegExp(Cookie.get("division"),"i"),i=u.test(window.location.pathname),i?location.pathname.match(/browse/)&&(d=Groupon.Utils.unparam(),n=d.category,o=d.category2,r=d.category3,t=s.extend(t,{category:n,category2:o,category3:r}),p=c(t),h="/browse/"+e+"?"+p):h=window.location.pathname+window.location.search),h},d=function(e,t){var n,o,r,i,u,l,c,d,h,p,f,g;if(a=(window.Groupon.Modules.SearchBar||{}).SearchOverrides,null!=a)for(t=v(null!=t?t.toLowerCase().trim():void 0),e=v(null!=e?e.toLowerCase().trim():void 0),n=0,i=a.length;i>n;n++)if(p=a[n],c=p.link,g=p.terms,h=p.locations,null!=h&&null!=g){if(h=s.map(h,v),g=s.map(g,v),y.call(h,t)>=0&&y.call(g,e)>=0)return c;for(o=0,u=h.length;u>o;o++)for(d=h[o],r=0,l=g.length;l>r;r++)if(f=g[r],e===f+"-"+d||e===d+"-"+f)return c}return null},f=function(e,t){var n,o,r,i,a,s,u,c;if(n=t.address,r=t.lat,i=t.lng,a=t.query,u=l(a),null!=u){"/travel"===u&&(u+="?lat={lat}&lng={lng}&query={query}&address={address}"),s={address:n,lat:r,lng:i,query:a,division:e};for(o in s)c=s[o],u=u.replace("{"+o+"}",c);return u.replace(/\s/g,"+")}},p=function(e){var t,n,o,r,a,s,u;if(t=e.address,i=(window.Groupon.Modules.SearchBar||{}).LocationOverrides,null!=i)for(n=0,o=i.length;o>n;n++)if(u=i[n],r=u.link,a=u.locations,!(y.call(a,t)<0))return s=c(e),r+"?"+s;return null},m=function(e,t){return e?r.setGeolocationData("current_location",t):r.removeGeolocationData("current_location")},t.exports={breakDownAddress:u,findSearchOverridesLink:l,getFormattedQueryString:c,getGeoSearchOverrideUrl:d,getLocationForSearch:h,getLocationOverrideUrl:p,getSearchOverrideUrl:f,getSearchUrl:g,GEO_DATA:o,storeGeolocationData:m}},{"../../../../core/frontend/groupon_modules/normalizeQuery":14,"../common/location":35,underscore:50}],37:[function(e,t,n){var o,r,i,a,s,u,l,c,d,h,p,f,g,v,m;h=e("../../../../core/frontend/groupon_modules/normalizeQuery"),v=e("../../../../src/helpers/camelCase").toCamelCase,m=void 0,o=[],d=function(e,t){var n;return t>-1&&(n="<a class='typeahead-match typeahead-match-highlight",e[t].match(/<a class='/)?e[t]=e[t].replace(/<a class='/,n+" "):e[t]=e[t].replace(/<a/,n+"'")),{list:e,index:t}},r=function(e,t,n){var o,r,i,a,s,u,l,c,d,p,f,g;for(p=t.length+2,s=e.length-1,o=-1,u=[],c="";r=e.shift();)a=r.lat,l=r.lng,i=r.label,g=r.value,a&&(c=" data-lat='"+a+"' data-lng='"+l+"'"),d=s-e.length,p>=g.length&&t===h(g)&&(o=d+n),f="<li role='listitem' class='icon-arrow-right-large'>\n  <a tabindex='1' data-bhc='result-"+d+":"+g+"' data-value='"+g+"'"+c+">"+i+"</a>\n</li>",u.push(f);return{list:u,index:o}},i=function(e,t){var n,o,r;if(m=m||$("#ls-search-bar-wrapper").data()||[],o=function(e){var n,o,r,i;for(r=[];o=e.shift();)n=p(o),i="<li role='listitem'>\n  <a tabindex='1' data-bhc='"+t+":"+n+"' data-value='"+o+"'>"+o+"</a>\n</li>",r.push(i);return r.unshift("<li class='ls-deal-widget-heading'>"+m.recentsearchesheading+"</li>"),r},r=function(e){var n,o,r,i,a,s;for(i=[];r=e.shift();)s=r.text,o=r.icon,o=o?"class='"+o+"'":"",n=p(s),a="<li role='listitem'>\n  <a "+o+" tabindex='1' data-bhc='"+t+":"+n+"' data-value='"+s+"'>"+s+"</a>\n</li>",i.push(a);return i.unshift("<li class='ls-deal-widget-heading'>"+m.suggestedsearchesheading+"</li>"),i},e.length)switch(t){case"recentSearches":n=o(e);break;case"suggestedSearches":n=r(e)}return{list:n||[]}},a=function(e,t,n,o){var r,i,a;switch(m=m||$("#ls-search-bar-wrapper").data()||[],r=function(e,n){var o,r;return r=h(m.currentlocationlabel),o=["<li role='listitem'>\n  <a class='current-location icon-compass-needle' tabindex='1' data-bhw='"+t+"'>"+m.currentlocationlabel+"</a>\n</li>"],e>-1&&(e+=1),n===r&&(e+=1),{list:o,index:e}},t){case"geolocation":a=r(o,n),i=a.list,o=a.index}return{list:i||[],index:o}},u=function(e,t){var n,o,s,u,l,c,p,f,g,m,y,b,$,w,_;for(w=[],l=-1,c=0,g=h(t),u=0,p=e.length;p>u;u++){switch(m=e[u],o=m.collection,_=m.widget,n={type:"bhw",val:v(_)},_){case"autocomplete":t&&(y=r(o,g,c),f=y.list,l=y.index,n={type:"bhc",val:"UserTyped:"+t});break;case"geolocation":c++,b=a(o,_,g,l),f=b.list,l=b.index;break;case"recentSearches":case"suggestedSearches":f=i(o,_).list}w.push.apply(w,f)}return $=d(w,l),s=$.list,l=$.index,{list:s,index:l,bh:n}},l=function(){return o.length?o:o=JSON.parse(("undefined"!=typeof localStorage&&null!==localStorage?localStorage.LS_recentSearches:void 0)||"[]")},g=function(e){try{return localStorage.LS_recentSearches=JSON.stringify(e)}catch(t){}},f=function(e){var t;return e=_.escape(e),t=_.uniq([e.toLowerCase().trim()].concat(l())).slice(0,10),g(t)},c=function(e){if(e)try{return JSON.parse(e)}catch(t){}},s=function(e){var t;return e.length?(t=(window.Groupon.Modules.SearchBar||[]).SearchOverrides,e.constructor===Array&&e[0].link&&(e=e.map(function(e){return{terms:[e.text.toLowerCase().trim()],link:e.link}}),t.push.apply(t,e)),t):void 0},p=function(e){return e.toLowerCase().replace(/[^\w\d]+/g,"_")},t.exports={buildAutocompleteList:r,buildDealWidgetList:i,buildLocationWidgetList:a,extendSearchOverrides:s,getAutocompleteList:u,getRecentSearches:l,getSearchSuggestion:c,prepareBloodhoundTag:p,saveRecentSearch:f}},{"../../../../core/frontend/groupon_modules/normalizeQuery":14,"../../../../src/helpers/camelCase":51}],38:[function(e,t,n){var o,r,i,a,s,u,l,c,d,h,p,f,g,v;d=e("../../../modules/gig_search_bar/frontend/views/search_bar"),s=e("./common/location"),i=e("./common/keypress"),a=e("./views/keyword_bar"),u=e("./views/location_bar"),l=e("./views/location_error"),h=e("./views/typeahead"),v=e("../../../core/frontend/groupon_modules/unparam"),o=e("./common/closest_division"),r=e("./common/geocoder"),t.exports=c={Common:{Keypress:i},Autocomplete:{},KeywordBar:a,LocationBar:u,LocationError:l,View:{Typeahead:h},init:function(e){var t,n,o,r,i;return c.GOOGLE_GEO_URL=e.google_geo_url,s.setDivision(e.division),(t=$("form#search-bar")).length?(o=s.getInitialLocation(),r=s.getInitialLocationData(),n=v().query,i=new d({$el:t,initialKeyword:n,initialLocation:o,initialLocationData:r})):void 0}},$(function(){var e;return(e=Groupon.Modules.SearchBar.Config)?Groupon.Modules.SearchBar.init(e):void 0}),null==(p=window.Groupon).Utils&&(p.Utils={}),_.extend(Groupon.Utils,{ClosestDivision:o,Geocoder:r}),null==(f=window.Groupon).Modules&&(f.Modules={}),null==(g=window.Groupon.Modules).SearchBar&&(g.SearchBar={}),_.extend(window.Groupon.Modules.SearchBar,c)},{"../../../core/frontend/groupon_modules/unparam":20,"../../../modules/gig_search_bar/frontend/views/search_bar":42,"./common/closest_division":32,"./common/geocoder":33,"./common/keypress":34,"./common/location":35,"./views/keyword_bar":39,"./views/location_bar":40,"./views/location_error":41,"./views/typeahead":43}],39:[function(e,t,n){var o,r,i;i=e("./typeahead"),o=e("../common/keypress"),t.exports=r=function(){function e(e){var t,n,o,r,a;n=e.el,this.$el=n,this.$input=this.$el.find("#search"),this.$input.PlaceholderField(),o=Groupon.LS.Experiments["LS-1740-recentSearches"],a=Groupon.LS.Experiments["LS-1811-SuggestedSearches"],this.bind(),!Groupon.LS.hasTouch&&this.$input.data("focus")&&(t=o||a||Groupon.LS.Experiments["LS-1900-SearchPrompt"],$("#search-bar").data("nosearchbarfocus")||t||this.$input.focus()),this.typeahead=new i({el:this.$input,enableRecentSearches:o,enableSearchSuggestion:a,endpoint:null!=(r=Groupon.endpoints)?r.deals:void 0}),this.placeholder=this.$input.attr("placeholder")}return e.prototype.bind=function(){return this.$input.on("keydown",function(e){return function(t){return o.isEnterKey(t.which)?(e.$el.trigger("submit"),e.typeahead.$typeaheadContainer.hide()):void 0}}(this))},e.prototype.val=function(e){var t;return null!=e?(this.$input.val(e),this.$input.removeClass("prompting")):(t=this.$input.val(),_.isBlank(t)||t===this.placeholder?null:t.trim())},e}()},{"../common/keypress":34,"./typeahead":43}],40:[function(e,t,n){var o,r,i,a,s=function(e,t){return function(){return e.apply(t,arguments)}};o=e("../common/keypress"),e("../../../../modules/gig_search_bar/frontend/views/location_error"),a=e("./typeahead"),i=e("./location_error"),t.exports=r=function(){function e(e){var t,n;t=e.el,this.onKeydown=s(this.onKeydown,this),this.$el=t,this.$input=this.$el.find("#location").bind({keydown:this.onKeydown}),this.$input.PlaceholderField(),this.bind(),this.typeahead=new a({el:this.$input,endpoint:null!=(n=Groupon.endpoints)?n.locations:void 0,showCurrentLocation:Groupon.LS.Experiments["LS-1714-geolocationSearch"]}),this.errorView=new i}return e.prototype.val=function(e,t){var n,o;return null==t&&(t={}),o=t.silent,null==e?(n=this.$input.val(),_.isBlank(n)?null:n.trim()):(this.$input.val(e).removeClass("prompting"),o?void 0:this.trigger("change",e))},e.prototype.bind=function(){return this.$input.parent("label").on("click",function(e){var t;return e.target===$("#location .geolocation-indicator")[0]||(e.preventDefault(),e.stopImmediatePropagation(),t=$(e.currentTarget),t.hasClass("active-search"))?void 0:($(".ls-searchbar-deal, .ls-searchbar-location, .search-box").removeClass("active-search"),t.addClass("active-search"))}),this.$input.on({focusin:function(e){return function(){return e.storeLocation(),e.$input.val(""),e.$input.PlaceholderField()}}(this),focusout:function(e){return function(){return e.storeLocation(),e.$input.val(e.$input.data("previous-value"))}}(this),change:function(e){return function(){return e.$input.data({manual:!0})}}(this),keypress:function(e){return function(){return e.$input.data("manual")!==!0?e.$input.trigger("change"):void 0}}(this)})},e.prototype.storeLocation=function(){var e;return e=this.$input.val(),_.isBlank(e)?void 0:this.$input.data("previous-value",e)},e.prototype.onKeydown=function(e){var t;this.errorView.removeError(),o.isEnterKey(e.which)&&(e.preventDefault(),(t=this.typeahead.$typeaheadContainer.find("a.typeahead-match.typeahead-match-highlight")).length?t.trigger("click"):(this.$el.trigger("submit","manual"),this.typeahead.$typeaheadContainer.hide()))},e.prototype.displayBadLocationError=function(e){return this.errorView.displayBadLocationError(e)},e.prototype.displayAvailabilityError=function(e){return this.errorView.displayAvailabilityError(e)},e}()},{"../../../../modules/gig_search_bar/frontend/views/location_error":41,"../common/keypress":34,"./location_error":41,"./typeahead":43}],41:[function(e,t,n){var o,r,i,a,s=function(e,t){return function(){return e.apply(t,arguments)}};i="generic",r="bad_location",o="availability",t.exports=a=function(){function e(){this.removeError=s(this.removeError,this),this.displayError=s(this.displayError,this),this.$el=$("#ls-search-bar-wrapper"),this.$location=this.$el.find("#location").parent()}return e.prototype.errorTemplate=function(e,t){return e=_.escape(e),t=_.escape(t),"<div data-bhw='SearchBarError' class='error-dialog icon-circle-alert'>\n  <span data-bhc='location-not-found:"+e+"'>"+t+"</span>\n</div>"},e.prototype.displayError=function(e,t){var n;return $(window).trigger("click"),e||(e=this.translateError(i)),n=$(this.errorTemplate(t,e)),$("#ls-typeahead-location").hide(),$("#location").trigger("blur"),this.$location.addClass("error").append(n),$(window).one("mousedown",function(e){return function(){return e.removeError()}}(this))},e.prototype.removeError=function(){return this.$location.removeClass("error").find(".error-dialog").remove()},e.prototype.displayBadLocationError=function(e){var t;return t=this.translateError(r),this.displayError(t,e)},e.prototype.displayAvailabilityError=function(e){var t;return t=this.translateError(o),this.displayError(t,e)},e.prototype.translateError=function(e){return this.$el.attr("data-error-"+e)},e}()},{}],42:[function(e,t,n){var o,r,i,a,s,u,l,c,d,h,p,f,g,v,m,y,b=function(e,t){return function(){return e.apply(t,arguments)}},w=[].slice;e("../../../../core/frontend/groupon_modules/groupon"),r=e("../common/geocoder"),a=e("../common/location"),m=e("../../../../core/frontend/groupon_modules/setSiteCookies"),Groupon.setWindowLocation=e("../../../../core/frontend/groupon_modules/setWindowLocation"),s=e("./location_bar"),i=e("./keyword_bar"),g=e("../common/searchbar_helper"),l=g.breakDownAddress,c=g.getGeoSearchOverrideUrl,d=g.getLocationForSearch,h=g.getLocationOverrideUrl,p=g.getSearchOverrideUrl,f=g.getSearchUrl,o=g.GEO_DATA,y=g.storeGeolocationData,v=e("../common/typeahead_helper.coffee").saveRecentSearch,t.exports=u=function(){function e(e){this._enableLocationBar=b(this._enableLocationBar,this),this._enableKeywordBar=b(this._enableKeywordBar,this),this._searchUsingLocationAutocomplete=b(this._searchUsingLocationAutocomplete,this),this._geocoderErrorHandler=b(this._geocoderErrorHandler,this),this._geoCodeWithGMaps=b(this._geoCodeWithGMaps,this),this._getGeolocation=b(this._getGeolocation,this),this._cleanGeolocationTraces=b(this._cleanGeolocationTraces,this),this.unfreezeElements=b(this.unfreezeElements,this),this.setSearchbarFocusTracking=b(this.setSearchbarFocusTracking,this),this.onFormSubmit=b(this.onFormSubmit,this),this.gatherData=b(this.gatherData,this),this.getQuery=b(this.getQuery,this);var t;this.$el=t=e.$el,this.options=e,this.$location=t.find("#location"),this.$search=t.find("#search"),this.$primaryNavTabs=$(".primary-nav-tab"),this.$overlay=$("#ls-resp-overlay"),this.render(),this.bind(),this.country=document.head.getAttribute("data-country")||"US",g=$("#ls-search-bar-wrapper").data()||[],this.geolocationData=a.getGeolocationData(),this.$currentLocationIcon=t.find(".geolocation-indicator"),this.currentLocationEnabled=Groupon.LS.Experiments["LS-1714-geolocationSearch"],this.currentLocationEnabled&&null!=this.geolocationData&&this.bindGeolocation(this.geolocationData)}var t,n,u,g;return t=document.head||document.getElementsByTagName("head")[0],n=g=void 0,e.prototype.bind=function(){return $("body.ui-v3").length||this.$el.find("input").on({focusin:function(e){return $(e.currentTarget).parent().hasClass("active-search")?void 0:($(".ls-searchbar-deal, .ls-searchbar-location, .search-box").removeClass("active-search"),$(e.currentTarget).parent("label").addClass("active-search"))},focusout:function(e){return function(t){var n,o;return $(t.currentTarget).parent("label").removeClass("active-search"),o=e.$search.parent("label"),n=e.$location.parent("label"),o.is(".active-search")||n.is(".active-search")?void 0:o.addClass("active-search")}}(this)}),this.$el.on("submit",function(e){return function(t,n){return t.state=n,e.onFormSubmit(t)}}(this))},e.prototype.bindGeolocation=function(e){var t,n,o,r;return $(".location-search").on("click",".current-location",function(e){return function(t){return t.preventDefault(),e.$el.trigger("submit","geolocate")}}(this)),this.$currentLocationIcon.on("click",function(e){return function(t){return t.preventDefault(),e.$currentLocationIcon.trigger("mouseout"),e.$el.trigger("submit","geolocate")}}(this)),r=function(e){return function(){return e.$currentLocationIcon.length?(e.$currentLocationIcon.on("mouseenter",function(){return $(".error-dialog").is(":visible")||$("#ls-typeahead-location").is(":visible")?void 0:$("#ls_current_location_hint").addClass("tooltip-toggle")}),e.$currentLocationIcon.on("mouseout",function(){return $("#ls_current_location_hint").removeClass("tooltip-toggle")})):void 0}}(this),n=Groupon.LS.Experiments,void 0===e.geoLocationGranted?(null!=n?n["LS-1722-GrouponPrompt"]:void 0)&&(t=$("#ls_location_prompt")).length?(o="click.prompt",t.show(),t.find("#location_deny").one(o,function(e){return e.preventDefault(),$(this).parent().hide().off(o),a.setGeolocationData("geoLocationGranted",!1),Groupon.Utils.trackEvent("client-geolocate-denied"),r()}),t.find("#location_accept").on(o,function(e){return function(t){return t.preventDefault(),t.stopImmediatePropagation(),$(t.currentTarget).parent().hide().off(o),e._getGeolocation()}}(this)),t.on(o,function(e){return e.preventDefault(),e.stopImmediatePropagation()}),$("body, #search, #location").one(o,function(){return $("#location_deny").trigger(o)}),this.$search.one("input.prompt",function(){return $("#location_deny").trigger(o)})):(null!=n?n["LS-1722-BrowserPrompt"]:void 0)&&this._getGeolocation():r(),e.current_location?this.$currentLocationIcon.addClass("geolocation-enabled"):void 0},e.prototype.render=function(){return this._enableLocationBar({initialLocation:this.options.initialLocation,initialLocationData:this.options.initialLocationData}),this._enableKeywordBar({initialKeyword:this.options.initialKeyword}),this.setSearchbarFocusTracking()},e.prototype.getQuery=function(){var e;return n=null!=(e=this.keywordBar)?e.val():void 0,_.isBlank(n)?void 0:n},e.prototype.gatherData=function(e){
var t,r,i,a,s,u,l,c,d,h;if(this.currentLocationEnabled&&(a=null!=(c=this.geolocationData)?c.current_location:void 0),r=this.getQuery(),u=this.locationBar.val(),null!=r||null!=u){if(null!=r&&Groupon.LS.Experiments["LS-1740-recentSearches"]&&v(r),(l=$("#ls-typeahead-location .typeahead-match")).length)t=_.pick(l.data(),"lat","lng");else switch(s=this.$location.data(),s.manual&&void 0===e&&(e="manual"),e){case"autocomplete":case"manual":t=_.pick(s,"lat","lng","closestDivision");break;default:t=_.pick.apply(_,[s,"lat","lng","closestDivision"].concat(w.call(o))),i=null!=(d=Groupon.Modules.SearchBar.geolocationOptions)?d.maximumAge:void 0,i&&Date.now()-(null!=a?a.timeStamp:void 0)>i&&(e="geolocate")}return a&&t.closestDivision||(t.closestDivision=null!=(h=Groupon.division)?h.id:void 0),{data:_.extend(t,{address:u,query:n}),state:e}}},e.prototype.onFormSubmit=function(e){var t,n,o,r,i;if(e.preventDefault(),i=e.state,r=this.gatherData(i),t=r.data,i=r.state,null!=t){if(this.$location.eventPause("pause").addClass("search-hide-selection"),this.$primaryNavTabs.eventPause("pause"),o=c(t.query,t.address),null!=o)return Groupon.setWindowLocation(o);switch(i){case"geolocate":t.currentLocation=!0,n=this._getGeolocation;break;case"autocomplete":n=this._searchUsingLocationAutocomplete,a.removeGeolocationData("current_location");break;case"manual":n=this._geoCodeWithGMaps,a.removeGeolocationData("current_location");break;default:this.currentLocationEnabled||a.removeGeolocationData("current_location"),n=u}return n(t)}},e.prototype.setSearchbarFocusTracking=function(){return this.$el.on("focusin.searchbar",function(e){return function(t){return t.target&&$(t.currentTarget).find(t.target).length?(Groupon.Utils.trackEvent("searchbar-focusin"),e.$el.off("focusin.searchbar"),e.$el.on("focusout.searchbar",function(t){return $(t.currentTarget).find(t.relatedTarget).length?void 0:(Groupon.Utils.trackEvent("searchbar-focusout"),e.$el.off("focusout.searchbar"),e.setSearchbarFocusTracking())})):void 0}}(this))},e.prototype.unfreezeElements=function(){return this.$location.eventPause("active"),this.$primaryNavTabs.eventPause("active")},e.prototype._cleanGeolocationTraces=function(){var e,t,n,o,r;return a.removeGeolocationData("current_location"),a.setGeolocationData("geoLocationGranted",!1),this.$currentLocationIcon.removeClass("geolocation-enabled icon-g-loader").addClass("icon-compass-needle").eventPause("active"),g.currentlocationlabel===this.$location.val()&&null!=(e=Groupon.division)?(t=e.lat,n=e.lng,o=e.name,r={address:o,lat:t,lng:n,geocoderSuccess:function(e){return function(t){var n;return n=t.locationData,e.$location.data(n).val(n.friendlyName),a.setSearchLocCookie(n)}}(this),geocoderError:function(){}},this._geoCodeWithGMaps(r)):void 0},e.prototype._getGeolocation=function(e){var t,n,o;return null==e&&(o=this.$search.val().trim(),e={address:g.currentlocationlabel,query:o}),this.$currentLocationIcon.removeClass("icon-compass-needle geolocation-enabled").addClass("icon-g-loader").eventPause("pause"),$(".typeahead-response.location").hide(),n=function(t){return function(n){var o,r;return o=n.lat,r=n.lng,t.$location.val(e.address),e=_.extend(e,{lat:o,lng:r,current_location:!0}),Groupon.Utils.trackEvent("location-bar-geolocation-success",{lat:o,lng:r}),a.setGeolocationData("geoLocationGranted",!0),t._geoCodeWithGMaps(e)}}(this),t=function(e){return function(t){return e._cleanGeolocationTraces(),Groupon.Utils.trackEvent("location-bar-geolocation-error",t),e.locationBar.displayAvailabilityError("current-location"),e.unfreezeElements()}}(this),Groupon.Utils.detectCurrentLocation(n,t)},e.prototype._geoCodeWithGMaps=function(e){var t,n,o,i,a,s;return null==e&&(e={}),t=e.address,n=e.current_location,a=e.lat,s=e.lng,i=e.geocoderSuccess,o=e.geocoderError,e={address:t,location:{lat:a,lng:s},current_location:n,country:this.country,geocoderSuccess:i,geocoderError:o},i||o||(e=_.extend({},e,{geocoderSuccess:this._geocoderSuccessHandler,geocoderError:this._geocoderErrorHandler})),this.geocoder||(this.geocoder=new r),this.geocoder.geocode(e)},e.prototype._geocoderSuccessHandler=function(e){var t,o,r,i,s,l;return t=e.address,i=e.locationData,o=e.current_location,s=n,null!=i.fullAddress&&(t=i.fullAddress),l="location-bar-geocode-search-success",o&&(t=g.currentlocationlabel,i.address=i.fullAddress=i.friendlyName=t,l="location-bar-geolocation-search-success"),a.setSearchLocCookie(i),Groupon.Utils.trackEvent(l,{address:t,locationData:i,query:s}),(r=i||d())?(r=_.omit(r,["fullAddress","friendlyName"]),r=_.extend(r,{timeStamp:(new Date).getTime()}),y(o,r),r=_.extend({},r,{address:t,query:s}),u(r)):void 0},e.prototype._geocoderErrorHandler=function(e){var t,n,o;return t=e.address,o=e.status,n=e.data,this.unfreezeElements(),"ABORT"!==o?("BAD_LOCATION"===o?this.locationBar.displayBadLocationError(t):"UNAVAILABLE"===o&&this.locationBar.displayAvailabilityError(t),Groupon.Utils.trackEvent("location-bar-geocode-search-error",{address:t,data:n})):void 0},e.prototype._searchUsingLocationAutocomplete=function(e){var t,n;return t=e.address,n=e.query,Groupon.Utils.trackEvent("location-bar-autocomplete-successful-match",{query:n,address:t}),"US"===this.country&&(e=l(e)),e=_.extend({},e,{geocoderSuccess:this._geocoderSuccessHandler,geocoderError:this._geocoderErrorHandler}),(new r).fetchClosestDivision(e)},e.prototype._enableKeywordBar=function(e){return null==e&&(e={}),this.$el.addClass("free-text-search-enabled"),this.keywordBar=new i({el:this.$el}),_.isBlank(e.initialKeyword)?void 0:this.keywordBar.val(e.initialKeyword,{silent:!0})},e.prototype._enableLocationBar=function(e){var t,n,r,i;return null==e&&(e={}),this.locationBar=new s({el:this.$el}),r=e.initialLocationData,n=e.initialLocation,t={manual:!1,city:null!=(i=Groupon.division)?i.name:void 0},r&&(t=_.extend({},t,_.pick.apply(_,[r,"lat","lng"].concat(w.call(o))))),this.$location.data(t),_.isBlank(n)?void 0:this.$location.val(n)},u=function(e){var t,n,o,r,i,a;return n=e.closestDivision,null!=n?(e=_.omit(e,"closestDivision","timeStamp"),o=h(e)||p(n,e)||f(n,e),t=e.address,r=e.query,m({division:n}),i=null!=Cookie.get("search_loc"),r||(a="location-search"),r&&!i&&(a="deal-search-with-no-loc-cookie"),r&&i&&(a="deal-search-with-loc-cookie"),Groupon.Utils.trackEvent(a,{address:t,query:r}),Groupon.setWindowLocation(o)):void 0},e}()},{"../../../../core/frontend/groupon_modules/groupon":8,"../../../../core/frontend/groupon_modules/setSiteCookies":17,"../../../../core/frontend/groupon_modules/setWindowLocation":18,"../common/geocoder":33,"../common/location":35,"../common/searchbar_helper":36,"../common/typeahead_helper.coffee":37,"./keyword_bar":39,"./location_bar":40}],43:[function(e,t,n){var o,r,i,a,s,u,l,c,d,h;d=e("../common/keypress"),l=d.isTabKey,u=d.isEnterKey,c=d.isUpArrowKey,s=d.isDownArrowKey,h=e("../common/typeahead_helper"),i=h.getAutocompleteList,r=h.extendSearchOverrides,a=h.getRecentSearches,t.exports=o=function(){function e(e){var t,n,o,i;this.$input=e.el,this.query="",this.lat="undefined"!=typeof Groupon&&null!==Groupon&&null!=(t=Groupon.division)?t.lat:void 0,this.lng="undefined"!=typeof Groupon&&null!==Groupon&&null!=(n=Groupon.division)?n.lng:void 0,this.locale=document.head.getAttribute("data-locale"),this.endpoint=e.endpoint,this.dealWidget=e.enableRecentSearches,this.showCurrentLocation=e.showCurrentLocation||!1,this.hasRecentSearches=!1,this.hasSuggestedSearches=!1,e.enableRecentSearches&&(this.recentKeywords=a(),this.hasRecentSearches=(null!=(o=this.recentKeywords)?o.length:void 0)>0),e.enableSearchSuggestion&&(this.suggestedKeywords=Groupon.LS.Experiments.searchSuggestions||[],this.hasSuggestedSearches=(null!=(i=this.suggestedKeywords)?i.length:void 0)>0,r(this.suggestedKeywords)),this.searchQuery=!1,this.$input.length&&(this.initialize(),this.bind())}return e.prototype.initialize=function(){var e;return e=this.$input.attr("id"),this.containers=$(".typeahead-response"),this.$typeaheadContainer=$("#ls-typeahead-"+e),this.$autocompleteList=this.$typeaheadContainer.find("ul"),this.$typeaheadContainer.append(this.$autocompleteList),this.$input.after(this.$typeaheadContainer),this.oldAddress=$("#location").val()},e.prototype.fetch=function(e){var t,n,o;return t=Cookie.get("snickerdoodle"),e===this.query&&(null!=(o=this.result)?o.length:void 0)?void this.buildView(_.deepClone(this.result),e):(this.query=e,n={limit:10,lat:this.lat,lng:this.lng,query:this.query,locale:this.locale},null!=t&&(n.consumer_id=t),$.ajax({url:this.endpoint,contentType:"application/json; charset=utf-8",dataType:"jsonp",type:"get",data:n,cache:!1,success:function(e){return function(t){var n,o,r;o=t.locationsAutocompleteResults,n=t.dealsAutocompleteResults,r=[],(null!=n?n.length:void 0)&&(r=[{collection:n,widget:"autocomplete"}]),(null!=o?o.length:void 0)&&(r=[{collection:o,widget:"autocomplete"}]),e.showCurrentLocation&&o&&r.unshift({collection:[],widget:"geolocation"}),e.result=_.deepClone(r),e.buildView(r,e.query)}}(this),error:function(e){return function(){return e.reset()}}(this)}))},e.prototype.buildView=function(e,t){var n,o,r,a,s,u;this.reset(),n=this.$autocompleteList,o=this.$typeaheadContainer,u=i(e,t),s=u.list,a=u.index,r=u.bh,(null!=s?s.length:void 0)&&("object"==typeof r&&n.attr("data-"+r.type,r.val).html(s.join("")),o.append(n).show(),o.attr("aria-hidden",!1),a>-1&&this.handleMatchedHighlighting(n))},e.prototype.hideWidget=function(e){return e.hide().attr("aria-hidden","true")},e.prototype.reset=function(){return this.containers.hide().attr("aria-hidden","true"),this.containers.find("ul").empty()},e.prototype.updateValueAndLatLng=function(e){var t,n,o,r,i;return t=e.data(),i=t.value,o=t.lat,r=t.lng,n=t.division,t={lat:o,lng:r,division:n,manual:!1},this.$input.val(i).data(t),{lat:o,lng:r}},e.prototype.selectAndFill=function(e){var t,n,o,r;return t=$(e.currentTarget),o="typeahead-match",t.hasClass(o)||this.$typeaheadContainer.find(".typeahead-match").removeClass(o),this.updateValueAndLatLng(t),n=this.$typeaheadContainer.hide(),r=n.is("#ls-typeahead-location")?"autocomplete":void 0,$("#search-bar").trigger("submit",r)},e.prototype.selectAndTab=function(e){return this.updateValueAndLatLng($(e.currentTarget)),this.$typeaheadContainer.hide(),$("#location").focus()},e.prototype.bind=function(){var e;return $("#ls-body").on("click",function(e){return function(){return e.reset()}}(this)),this.$input.on({focusin:function(){return $("body").eventPause("pause")},focusout:function(){return $("body").eventPause("active")},"focus keyup":function(e){return function(t){var n,o,r;if(t.preventDefault(),r=t.currentTarget,n=r.id,o=r.value,o=o.trim())return e.fetch(o);switch(n){case"search":return e.showDealWidget();case"location":return e.showLocationWidget()}}}(this),keydown:function(e){return function(t){return l(t.which)&&e.reset(),s(t.which)?(e.$typeaheadContainer.is(":visible")&&e.$typeaheadContainer.find("a").eq(0).focus(),e.$typeaheadContainer.find(".typeahead-match").removeClass("typeahead-match-highlight"),t.preventDefault()):void 0}}(this)}),(e=function(e){return function(t){return e.$typeaheadContainer.on(t,"a")}}(this))({click:function(e){return function(t){return $(t.currentTarget).hasClass("current-location")?void 0:e.selectAndFill(t)}}(this),keydown:function(e){return function(t){var n,o,r,i;return t.preventDefault(),r=e.$typeaheadContainer,o=r.find("a"),u(i=t.which)?(n=$(t.currentTarget),n.hasClass("current-location")?n.click():e.selectAndFill(t)):l(i)&&r.is("#ls-typeahead-search")?e.selectAndTab(t):c(i)?o.eq(o.index(t.currentTarget)-1).focus():s(i)?o.eq(o.index(t.currentTarget)+1).focus():e.$input.focus()}}(this)})},e.prototype.handleMatchedHighlighting=function(e){var t;return t=e.find(".typeahead-match"),e.on({mouseenter:function(){return document.activeElement.blur(),t.removeClass("typeahead-match-highlight")},mouseleave:function(){return t.addClass("typeahead-match-highlight")}})},e.prototype.showDealWidget=function(){var e,t,n,o,r,i;return t=this.hasRecentSearches,n=this.hasSuggestedSearches,t||n?(e=[],t&&(o=null!=(r=this.recentKeywords)?r.slice(0):void 0,n&&(null!=o?o.length:void 0)>5&&(o=o.slice(0,5)),e.push.apply(e,[{collection:o,widget:"recentSearches"}])),n&&e.push.apply(e,[{collection:null!=(i=Groupon.LS.Experiments)?i.searchSuggestions.slice(0):void 0,widget:"suggestedSearches"}]),(null!=e?e.length:void 0)?this.buildView(e):void 0):this.reset()},e.prototype.showLocationWidget=function(){var e;return this.showCurrentLocation?(e=[{collection:[],widget:"geolocation"}],this.buildView(e)):this.reset()},e}()},{"../common/keypress":34,"../common/typeahead_helper":37}],44:[function(e,t,n){var o,r,i,a,s,u,l,c,d,h;a="layout-service",u="//mapproxy.groupon.com",s="//mapproxy-eu.groupon.com",r=3,o=["geometry"],h=!1,l=[],d=function(){var e,t,n,o;for(o=[],t=0,n=l.length;n>t;t++)e=l[t],o.push(e());return o},c=function(){var e;return e=document.head.getAttribute("data-country"),"US"===e||"CL"===e||"CO"===e||"MX"===e||"PA"===e||"PE"===e||"PR"===e||"UY"===e?u:s},t.exports=i={load:function(e){var t,n,i;return null==e&&(e=function(){}),null!=(null!=(i=window.google)?i.maps:void 0)?e():(l.push(e),h?void 0:(h=!0,t="layoutServiceGoogleMapsCallback",window[t]=d,n=$.param({sensor:!1,v:r,libraries:o.join(","),callback:t,region:document.head.getAttribute("data-country")||"US",language:document.head.getAttribute("data-language")||"en-US",channel:a}),$.getScript(c()+"/maps/api/js?"+n).fail(function(){return e(new Error("Unable to load Google Maps Library"))})))}}},{}],45:[function(e,t,n){var o,r;o=e("./google_maps"),null==(r=window.Groupon).Utils&&(r.Utils={}),window.Groupon.Utils.GoogleMaps=o},{"./google_maps":44}],46:[function(e,t,n){var o;e("../../../core/frontend/groupon_modules/groupon"),o=function(){function e(){}var t,n,o,r;return e.prototype.requestNowAuthorization=function(e,n){var o,r,i;return r=Cookie.get("checkGoogleNow"),null===r?(o=86400,Groupon.Utils.setSiteCookies({checkGoogleNow:"true"},o),i=Cookie.get("c"),t(i,e,n)):void 0},t=function(e,t,n){var r,i,a;return r={consumerId:e},a=Groupon.endpoints.googleNowVerify+e,i=new XMLHttpRequest,i.withCredentials=!0,i.onreadystatechange=function(){return 4===i.readyState&&404===i.status?n.load("now",function(){return o(t,e,n)}):void 0},i.open("GET",a,!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.send(JSON.stringify(r))},o=function(e,t,n){var o,i;return i=function(e){return null!=e.code?r(t,e.code):void 0},o=function(e){return Groupon.Utils.trackEvent("google-now-get-auth-code-failed",{response:e})},n.now.getCode([e],{client_id:Groupon.endpoints.googleNowClientId}).then(i,o)},r=function(e,t){var n,o,r;return n={consumerId:e,authorizationCode:t,redirectUri:"xhr"},r=Groupon.endpoints.googleNowAuthorizationCode,o=new XMLHttpRequest,o.withCredentials=!0,o.onreadystatechange=function(){return 4===o.readyState?200===o.status:void 0},o.open("PUT",r,!0),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.send(JSON.stringify(n))},n=function(){return Cookie.get("c")},e}(),window.Groupon.GoogleNow=o},{"../../../core/frontend/groupon_modules/groupon":8}],47:[function(e,t,n){var o,r=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};o=function(){function e(e){this.el=e,this.$el=$(this.el),this.$body=$("#ls-body"),this.initialize()}return e.prototype.initialize=function(){return this.attachDismissListener(),this.showMessages()},e.prototype.getMessageId=function(){var e,t,n,o,r;return e=null!=(o=this.$el.find('[id^="message-"]'))?o.attr("id"):void 0,e?(r=e.split("-"),n=r[0],t=r[1],t):void 0},e.prototype.getBlockedMessageIds=function(){var e;return e=Cookie.get("msg_hide"),e?e.split(","):[]},e.prototype.setBlockedMessageIds=function(e){var t;return e.length>20&&e.shift(),t=e.join(","),Cookie.set("msg_hide",t)},e.prototype.showMessages=function(){var e,t;return t=this.getMessageId(),t&&t>0&&(e=this.getBlockedMessageIds(),r.call(e,t)<0)?(this.$el.removeClass("hide"),this.$body.addClass("ls-visible-inAppMessage")):void 0},e.prototype.blockMessage=function(e){var t;return t=this.getBlockedMessageIds(),r.call(t,e)<0?(t.push(e),this.setBlockedMessageIds(t)):void 0},e.prototype.attachDismissListener=function(){return this.$el.find(".hide-link").one("click",function(e){return function(t){var n;return t.preventDefault(),e.$el.addClass("hide"),e.$body.removeClass("ls-visible-inAppMessage"),n=e.getMessageId(),n&&n>0?e.blockMessage(n):void 0}}(this))},e}(),window.InAppMessage=o},{}],48:[function(e,t,n){var o,r,i=function(e,t){return function(){return e.apply(t,arguments)}};e("../../../core/frontend/groupon_modules/groupon"),e("../../../core/frontend/groupon_modules/makeTag"),r=Groupon.Utils.makeTag,o=864e5,Groupon.Widgets.Points=function(){function e(e){var t;this.el=e,this.showUpdatedPoints=i(this.showUpdatedPoints,this),this.checkForMessage=i(this.checkForMessage,this),this.hidePointsFlyoutForLoggedOutUser=i(this.hidePointsFlyoutForLoggedOutUser,this),this.checkPointsFlyoutForLoggedOutUser=i(this.checkPointsFlyoutForLoggedOutUser,this),this.showPointsFlyoutForLoggedOutUser=i(this.showPointsFlyoutForLoggedOutUser,this),this.handleExpirationPopup=i(this.handleExpirationPopup,this),this.hideExpirationPopup=i(this.hideExpirationPopup,this),this.buildPointsExpirationPopup=i(this.buildPointsExpirationPopup,this),this.showPointsExpirationPopup=i(this.showPointsExpirationPopup,this),this.showPointsExpirationMessage=i(this.showPointsExpirationMessage,this),this.loadLoggedInFlyout=i(this.loadLoggedInFlyout,this),this.onComplete=i(this.onComplete,this),this.$el=$(this.el),this.getLocalPoints(),this.$userWrapper=$(".user-wrapper"),this.$points=this.$el.find(".ls-points-text"),this.pointsText=this.$points.data("template"),this.noPointsText=this.$points.data("nopoints"),this.$pointsMessage=$(".ls-points-message"),this.$pointsLink=$(".ls-points-link"),this.$pointsLinkUpdate=$(".ls-points-link-update"),this.$flyoutLoggedOut=$("#points-logged-out-flyout"),this.$flyoutLoggedOutPoints=$("#points-logged-out-flyout .reward-points"),this.$flyoutLoggedOutPointsText=this.$flyoutLoggedOutPoints.data("template"),this.$recentActivities=$("#points-logged-in-flyout .recent-activities"),this.$recentActivitiesData=this.$recentActivities.data(),this.$expirationPopup=$("#points-expiration-popup"),this.user_id=Cookie.get("c"),this.user_id&&(this.user_id=this.user_id.replace(/\"/g,"")),t=Modernizr.prefixed("transition"),this.transitionEventName="WebkitTransition"===t?"webkitTransitionEnd":t?"transitionend":void 0,this.$el.length&&null!=this.user_id&&(this.bind(),this.showPoints(),this.fetch())}return e.prototype.bind=function(){return this.$pointsLink.one(this.transitionEventName,this.checkForMessage)},e.prototype.fetch=function(){var e;return e=this.onComplete,$.ajax({type:"GET",contentType:"application/json; charset=utf-8",dataType:"jsonp",cache:!1,url:Groupon.endpoints.points.replace("{user_id}",this.user_id),success:function(e){return function(t){return e.onComplete(t)}}(this)})},e.prototype.onComplete=function(e){var t,n,o,r,i,a;try{if(r=e.points,t=r.balance,n=r.events,o=r.expiring,!isFinite(t))throw new Error("bad api response");this.getLocalPoints(),$(".signed-in").length&&this.loadLoggedInFlyout(n,o,t)}catch(s){}return t>(null!=(i=this.localPoints)?i.balance:void 0)&&this.user_id===(null!=(a=this.localPoints)?a.user_id:void 0)?(this.showPoints(this.localPoints.balance),this.showAnimation(t,n),this.setLocalPoints(t,n)):(this.setLocalPoints(t,n),this.showPoints(t))},e.prototype.showPoints=function(e){var t,n,o;return null==e&&(e=null!=(n=this.localPoints)?n.balance:void 0),t=null!=e&&this.user_id===(null!=(o=this.localPoints)?o.user_id:void 0),this.$points.text(t?this.pointsText.replace("pointsBalance",I18n.toNumber(e)):this.noPointsText),this.$userWrapper.addClass("points-widget"),this.$el.show(),this.$pointsMessage.width(this.$userWrapper.width()-10),t&&!$(".signed-in").length&&e>0?this.showPointsFlyoutForLoggedOutUser(e):void 0},e.prototype.loadLoggedInFlyout=function(e,t,n){var o;return _.each(e,function(e){return function(t){var n,o,r,i,a,s;return s=t.reason_text,o=t.amount,s=s.replace(/\.$/,""),o>0&&(o="+"+o),i=e.$recentActivitiesData.badge.replace("{points}",o),s=s.replace("{{amount}}",i),/\{\{deal}}/.test(s)&&(a=null!=t.deal_url?(r="href='"+t.deal_url+"' data-bhw='LoyaltyPointsFlyoutDealLink'","<a "+r+">"+t.deal_text+"</a>"):t.deal_text,s=s.replace("{{deal}}",a)),/\{\{redemption}}/.test(s)&&(s=s.replace("{{redemption}}",t.redemption_text)),n=e.$recentActivitiesData.template.replace("{text}",s),e.$recentActivities.append(n)}}(this)),n>=3e3&&null!=t&&this.showPointsExpirationMessage(t),o=$("#points-logged-in-flyout"),o.addClass("loyalty-flyout-enabled"),this.$el.one("mouseenter",function(e){return function(){return e.hideExpirationPopup(),o.find(".ls-lazy").lazyload({skip_invisible:!1})}}(this)),Groupon.LS.hasTouch&&o.length?this.$pointsLink.on("tap",function(e){return e.preventDefault(),e.stopImmediatePropagation(),o.toggle(),$("html").trigger("tap"),o.is(":visible")?(o.find(".ls-lazy").lazyload({skip_invisible:!1}),$("html").one("tap",function(e){return 0===$(e.target).closest(".ls-points, #points-logged-in-flyout",".points-widget").length?o.hide().attr("aria-hidden","true"):void 0})):void 0}):void 0},e.prototype.showPointsExpirationMessage=function(e){var t,n,o,i,a,s,u,l,c,d,h,p,f;return t=e.amount,c=new Date(e.when),i=this.getDaysRemaining(c),7>=i?(this.showPointsExpirationPopup(t,i),a=this.$recentActivitiesData.badge.replace("{points}",I18n.toNumber(t)),f=this.$recentActivitiesData.expiretext,h=f.one,p=f.other,l=1===i?h:p,l=l.replace("%{count}",i),n=this.$pointsLink.attr("href"),d=this.$recentActivitiesData.expirelink,s=r.a({"data-bhw":"LoyaltyPointsFlyoutExpiryClaimLink",href:n},o=d),u=this.$recentActivitiesData.expiry.replace("{text}",""+a+l+s),this.$recentActivities.append(u)):void 0},e.prototype.showPointsExpirationPopup=function(e,t){var n,r,i,a,s,u,l,c;if(this.localPopupData=JSON.parse(("undefined"!=typeof localStorage&&null!==localStorage?localStorage.getItem("LS_points_expiring"):void 0)||"null"),u=Date.now(),null==this.localPopupData)a=s=u,c=1;else if(l=this.localPopupData,a=l.firstSeen,s=l.lastSeen,c=l.timesSeen,i=new Date(a),i.setMonth(i.getMonth()+1),n=this.getDaysRemaining(i),1>n)a=s=u,c=1;else{if(r=Math.round((u-s)/o),c>=2||1>r)return;s=u,c+=1}return this.setPopupLocalStorage(a,s,c),this.buildPointsExpirationPopup(e,t)},e.prototype.setPopupLocalStorage=function(e,t,n){return localStorage.setItem("LS_points_expiring",JSON.stringify({firstSeen:e,lastSeen:t,timesSeen:n}))},e.prototype.buildPointsExpirationPopup=function(e,t){var n,o,i,a,s,u,l,c;return a=this.$expirationPopup.data("amount").replace("{amount}",I18n.toNumber(e)),c=this.$recentActivitiesData.expiretext,n=c.one,o=c.other,u=this.$pointsLink.attr("href"),l=1===t?n:o,l=l.replace("%{count}",t),s=this.$expirationPopup.data("text").replace("{text}",a+" "+l),i=r.a({"data-bhw":"LoyaltyPointsExpiryPopup",href:u,"class":"ls-expiry-popup-link"},s),this.$expirationPopup.html(i).addClass("show"),this.handleExpirationPopup(),$("body").not(this.$expirationPopup).one("click",this.hideExpirationPopup),setTimeout(this.hideExpirationPopup,1e4)},e.prototype.hideExpirationPopup=function(){return this.$expirationPopup.removeClass("show")},e.prototype.handleExpirationPopup=function(){return this.$expirationPopup.is(":visible")?$(".subnav-flyout").is(":visible")?this.hideExpirationPopup():setTimeout(this.handleExpirationPopup,500):void 0},e.prototype.showPointsFlyoutForLoggedOutUser=function(e){return Cookie.get("ls-logged-out-points-flyout")?void 0:(Cookie.set("ls-logged-out-points-flyout","seen"),e=I18n.toNumber(e),e='<span class="points">'+e+"</span>",this.$flyoutLoggedOutPoints.html(this.$flyoutLoggedOutPointsText.replace("{points}",e)),this.$flyoutLoggedOut.addClass("show"),this.checkPointsFlyoutForLoggedOutUser(),$("body").not(this.$flyoutLoggedOut).one("click",this.hidePointsFlyoutForLoggedOutUser),setTimeout(this.hidePointsFlyoutForLoggedOutUser,1e4))},e.prototype.checkPointsFlyoutForLoggedOutUser=function(){return this.$flyoutLoggedOut.is(":visible")?$(".subnav-flyout").is(":visible")?this.hidePointsFlyoutForLoggedOutUser():setTimeout(this.checkPointsFlyoutForLoggedOutUser,500):void 0},e.prototype.hidePointsFlyoutForLoggedOutUser=function(){return this.$flyoutLoggedOut.removeClass("show")},e.prototype.getLocalPoints=function(){return this.localPoints=JSON.parse(("undefined"!=typeof localStorage&&null!==localStorage?localStorage.getItem("LS_points"):void 0)||"null")},e.prototype.setLocalPoints=function(e,t){return localStorage.setItem("LS_points",JSON.stringify({user_id:this.user_id,balance:e,events:t})),this.getLocalPoints()},e.prototype.showAnimation=function(e,t){return this.transitionEventName?(this.$pointsLinkUpdate.find(".ls-points-text").text(this.pointsText.replace("pointsBalance",I18n.toNumber(e))),_.each(t,function(t){return function(n){var o,r,i,a,s,u;return u=n.reason_text,a=n.deal_text,o=n.amount,s=n.processed_last,s&&e-t.localPoints.balance===o?(t.$pointsMessage.data("show","true"),r='<span class="ls-points-increase-badge">+'+o+"</span>",i='<span class="ls-points-increase-deal">'+a+"</span>",u=n.reason_text.replace("{{amount}}",r).replace("{{deal}}",i),t.$pointsMessage.html(u)):void 0}}(this)),this.$pointsLink.addClass("animate")):this.$el.find(".ls-points-text").text(this.pointsText.replace("pointsBalance",I18n.toNumber(e)))},e.prototype.checkForMessage=function(){var e;return this.$pointsLink.remove(),(e="true"===this.$pointsMessage.data("show"))?(this.$pointsMessage.one(this.transitionEventName,_.partial(this.showUpdatedPoints,e)),void this.$pointsMessage.addClass("show-points-message")):this.showUpdatedPoints(e)},e.prototype.showUpdatedPoints=function(e){return e?this.$pointsMessage.addClass("hide-points-message").one(this.transitionEventName,function(e){return function(){return e.$pointsLinkUpdate.addClass("animate")}}(this)):this.$pointsLinkUpdate.addClass("animate")},e.prototype.getDaysRemaining=function(e){return Math.round(Math.abs((e-Date.now())/o))},e}()},{"../../../core/frontend/groupon_modules/groupon":8,"../../../core/frontend/groupon_modules/makeTag":13}],49:[function(e,t,n){Groupon.qualtrics=function(e,t,n,o){this.get=function(e){var t,n,o,r;for(e+="=",n=document.cookie.split(";"),t=0,r=n.length;r>t;){for(o=n[t];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(e))return o.substring(e.length,o.length);t++}return null},this.set=function(e,t){var n;n=new Date,n.setTime(n.getTime()+6048e5),n="; expires="+n.toGMTString(),document.cookie=e+"="+t+n+"; path=/; "},this.check=function(){var o,r;if(o=this.get(n))o=o.split(":");else{if(100===e)return!0;"v"===t&&(e=Math.random()>=e/100?0:100),o=[t,e,0],this.set(n,o.join(":"))}if(r=o[1],100===r)return!0;switch(o[0]){case"v":return!1;case"r":return r=o[2]%Math.floor(100/r)}return!0},this.go=function(){var e;this.check()&&(e=document.createElement("script"),e.type="text/javascript",e.src=o+"&t="+(new Date).getTime(),document.body&&document.body.appendChild(e))},this.start=function(){var e;e=this,window.addEventListener?window.addEventListener("load",function(){e.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){e.go()})}}},{}],50:[function(e,t,n){(function(){function e(e){function t(t,n,o,r,i,a){for(;i>=0&&a>i;i+=e){var s=r?r[i]:i;o=n(o,t[s],s,t)}return o}return function(n,o,r,i){o=w(o,i,4);var a=!A(n)&&$.keys(n),s=(a||n).length,u=e>0?0:s-1;return arguments.length<3&&(r=n[a?a[u]:u],u+=e),t(n,o,r,a,u,s)}}function o(e){return function(t,n,o){n=_(n,o);for(var r=x(t),i=e>0?0:r-1;i>=0&&r>i;i+=e)if(n(t[i],i,t))return i;return-1}}function r(e,t,n){return function(o,r,i){var a=0,s=x(o);if("number"==typeof i)e>0?a=i>=0?i:Math.max(i+s,a):s=i>=0?Math.min(i+1,s):i+s+1;else if(n&&i&&s)return i=n(o,r),o[i]===r?i:-1;if(r!==r)return i=t(h.call(o,a,s),$.isNaN),i>=0?i+a:-1;for(i=e>0?a:s-1;i>=0&&s>i;i+=e)if(o[i]===r)return i;return-1}}function i(e,t){var n=O.length,o=e.constructor,r=$.isFunction(o)&&o.prototype||l,i="constructor";for($.has(e,i)&&!$.contains(t,i)&&t.push(i);n--;)i=O[n],i in e&&e[i]!==r[i]&&!$.contains(t,i)&&t.push(i)}var a=this,s=a._,u=Array.prototype,l=Object.prototype,c=Function.prototype,d=u.push,h=u.slice,p=l.toString,f=l.hasOwnProperty,g=Array.isArray,v=Object.keys,m=c.bind,y=Object.create,b=function(){},$=function(e){return e instanceof $?e:this instanceof $?void(this._wrapped=e):new $(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=$),n._=$):a._=$,$.VERSION="1.8.3";var w=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,r){return e.call(t,n,o,r)};case 4:return function(n,o,r,i){return e.call(t,n,o,r,i)}}return function(){return e.apply(t,arguments)}},_=function(e,t,n){return null==e?$.identity:$.isFunction(e)?w(e,t,n):$.isObject(e)?$.matcher(e):$.property(e)};$.iteratee=function(e,t){return _(e,t,1/0)};var k=function(e,t){return function(n){var o=arguments.length;if(2>o||null==n)return n;for(var r=1;o>r;r++)for(var i=arguments[r],a=e(i),s=a.length,u=0;s>u;u++){var l=a[u];t&&void 0!==n[l]||(n[l]=i[l])}return n}},S=function(e){if(!$.isObject(e))return{};if(y)return y(e);b.prototype=e;var t=new b;return b.prototype=null,t},L=function(e){return function(t){return null==t?void 0:t[e]}},C=Math.pow(2,53)-1,x=L("length"),A=function(e){var t=x(e);return"number"==typeof t&&t>=0&&C>=t};$.each=$.forEach=function(e,t,n){t=w(t,n);var o,r;if(A(e))for(o=0,r=e.length;r>o;o++)t(e[o],o,e);else{var i=$.keys(e);for(o=0,r=i.length;r>o;o++)t(e[i[o]],i[o],e)}return e},$.map=$.collect=function(e,t,n){t=_(t,n);for(var o=!A(e)&&$.keys(e),r=(o||e).length,i=Array(r),a=0;r>a;a++){var s=o?o[a]:a;i[a]=t(e[s],s,e)}return i},$.reduce=$.foldl=$.inject=e(1),$.reduceRight=$.foldr=e(-1),$.find=$.detect=function(e,t,n){var o;return o=A(e)?$.findIndex(e,t,n):$.findKey(e,t,n),void 0!==o&&-1!==o?e[o]:void 0},$.filter=$.select=function(e,t,n){var o=[];return t=_(t,n),$.each(e,function(e,n,r){t(e,n,r)&&o.push(e)}),o},$.reject=function(e,t,n){return $.filter(e,$.negate(_(t)),n)},$.every=$.all=function(e,t,n){t=_(t,n);for(var o=!A(e)&&$.keys(e),r=(o||e).length,i=0;r>i;i++){var a=o?o[i]:i;if(!t(e[a],a,e))return!1}return!0},$.some=$.any=function(e,t,n){t=_(t,n);for(var o=!A(e)&&$.keys(e),r=(o||e).length,i=0;r>i;i++){var a=o?o[i]:i;if(t(e[a],a,e))return!0}return!1},$.contains=$.includes=$.include=function(e,t,n,o){return A(e)||(e=$.values(e)),("number"!=typeof n||o)&&(n=0),$.indexOf(e,t,n)>=0},$.invoke=function(e,t){var n=h.call(arguments,2),o=$.isFunction(t);return $.map(e,function(e){var r=o?t:e[t];return null==r?r:r.apply(e,n)})},$.pluck=function(e,t){return $.map(e,$.property(t))},$.where=function(e,t){return $.filter(e,$.matcher(t))},$.findWhere=function(e,t){return $.find(e,$.matcher(t))},$.max=function(e,t,n){var o,r,i=-(1/0),a=-(1/0);if(null==t&&null!=e){e=A(e)?e:$.values(e);for(var s=0,u=e.length;u>s;s++)o=e[s],o>i&&(i=o)}else t=_(t,n),$.each(e,function(e,n,o){r=t(e,n,o),(r>a||r===-(1/0)&&i===-(1/0))&&(i=e,a=r)});return i},$.min=function(e,t,n){var o,r,i=1/0,a=1/0;if(null==t&&null!=e){e=A(e)?e:$.values(e);for(var s=0,u=e.length;u>s;s++)o=e[s],i>o&&(i=o)}else t=_(t,n),$.each(e,function(e,n,o){r=t(e,n,o),(a>r||r===1/0&&i===1/0)&&(i=e,a=r)});return i},$.shuffle=function(e){for(var t,n=A(e)?e:$.values(e),o=n.length,r=Array(o),i=0;o>i;i++)t=$.random(0,i),t!==i&&(r[i]=r[t]),r[t]=n[i];return r},$.sample=function(e,t,n){return null==t||n?(A(e)||(e=$.values(e)),e[$.random(e.length-1)]):$.shuffle(e).slice(0,Math.max(0,t))},$.sortBy=function(e,t,n){return t=_(t,n),$.pluck($.map(e,function(e,n,o){return{value:e,index:n,criteria:t(e,n,o)}}).sort(function(e,t){var n=e.criteria,o=t.criteria;if(n!==o){if(n>o||void 0===n)return 1;if(o>n||void 0===o)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,n,o){var r={};return n=_(n,o),
$.each(t,function(o,i){var a=n(o,i,t);e(r,o,a)}),r}};$.groupBy=T(function(e,t,n){$.has(e,n)?e[n].push(t):e[n]=[t]}),$.indexBy=T(function(e,t,n){e[n]=t}),$.countBy=T(function(e,t,n){$.has(e,n)?e[n]++:e[n]=1}),$.toArray=function(e){return e?$.isArray(e)?h.call(e):A(e)?$.map(e,$.identity):$.values(e):[]},$.size=function(e){return null==e?0:A(e)?e.length:$.keys(e).length},$.partition=function(e,t,n){t=_(t,n);var o=[],r=[];return $.each(e,function(e,n,i){(t(e,n,i)?o:r).push(e)}),[o,r]},$.first=$.head=$.take=function(e,t,n){return null!=e?null==t||n?e[0]:$.initial(e,e.length-t):void 0},$.initial=function(e,t,n){return h.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},$.last=function(e,t,n){return null!=e?null==t||n?e[e.length-1]:$.rest(e,Math.max(0,e.length-t)):void 0},$.rest=$.tail=$.drop=function(e,t,n){return h.call(e,null==t||n?1:t)},$.compact=function(e){return $.filter(e,$.identity)};var E=function(e,t,n,o){for(var r=[],i=0,a=o||0,s=x(e);s>a;a++){var u=e[a];if(A(u)&&($.isArray(u)||$.isArguments(u))){t||(u=E(u,t,n));var l=0,c=u.length;for(r.length+=c;c>l;)r[i++]=u[l++]}else n||(r[i++]=u)}return r};$.flatten=function(e,t){return E(e,t,!1)},$.without=function(e){return $.difference(e,h.call(arguments,1))},$.uniq=$.unique=function(e,t,n,o){$.isBoolean(t)||(o=n,n=t,t=!1),null!=n&&(n=_(n,o));for(var r=[],i=[],a=0,s=x(e);s>a;a++){var u=e[a],l=n?n(u,a,e):u;t?(a&&i===l||r.push(u),i=l):n?$.contains(i,l)||(i.push(l),r.push(u)):$.contains(r,u)||r.push(u)}return r},$.union=function(){return $.uniq(E(arguments,!0,!0))},$.intersection=function(e){for(var t=[],n=arguments.length,o=0,r=x(e);r>o;o++){var i=e[o];if(!$.contains(t,i)){for(var a=1;n>a&&$.contains(arguments[a],i);a++);a===n&&t.push(i)}}return t},$.difference=function(e){var t=E(arguments,!0,!0,1);return $.filter(e,function(e){return!$.contains(t,e)})},$.zip=function(){return $.unzip(arguments)},$.unzip=function(e){for(var t=e&&$.max(e,x).length||0,n=Array(t),o=0;t>o;o++)n[o]=$.pluck(e,o);return n},$.object=function(e,t){for(var n={},o=0,r=x(e);r>o;o++)t?n[e[o]]=t[o]:n[e[o][0]]=e[o][1];return n},$.findIndex=o(1),$.findLastIndex=o(-1),$.sortedIndex=function(e,t,n,o){n=_(n,o,1);for(var r=n(t),i=0,a=x(e);a>i;){var s=Math.floor((i+a)/2);n(e[s])<r?i=s+1:a=s}return i},$.indexOf=r(1,$.findIndex,$.sortedIndex),$.lastIndexOf=r(-1,$.findLastIndex),$.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var o=Math.max(Math.ceil((t-e)/n),0),r=Array(o),i=0;o>i;i++,e+=n)r[i]=e;return r};var G=function(e,t,n,o,r){if(!(o instanceof t))return e.apply(n,r);var i=S(e.prototype),a=e.apply(i,r);return $.isObject(a)?a:i};$.bind=function(e,t){if(m&&e.bind===m)return m.apply(e,h.call(arguments,1));if(!$.isFunction(e))throw new TypeError("Bind must be called on a function");var n=h.call(arguments,2),o=function(){return G(e,o,t,this,n.concat(h.call(arguments)))};return o},$.partial=function(e){var t=h.call(arguments,1),n=function(){for(var o=0,r=t.length,i=Array(r),a=0;r>a;a++)i[a]=t[a]===$?arguments[o++]:t[a];for(;o<arguments.length;)i.push(arguments[o++]);return G(e,n,this,this,i)};return n},$.bindAll=function(e){var t,n,o=arguments.length;if(1>=o)throw new Error("bindAll must be passed function names");for(t=1;o>t;t++)n=arguments[t],e[n]=$.bind(e[n],e);return e},$.memoize=function(e,t){var n=function(o){var r=n.cache,i=""+(t?t.apply(this,arguments):o);return $.has(r,i)||(r[i]=e.apply(this,arguments)),r[i]};return n.cache={},n},$.delay=function(e,t){var n=h.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},$.defer=$.partial($.delay,$,1),$.throttle=function(e,t,n){var o,r,i,a=null,s=0;n||(n={});var u=function(){s=n.leading===!1?0:$.now(),a=null,i=e.apply(o,r),a||(o=r=null)};return function(){var l=$.now();s||n.leading!==!1||(s=l);var c=t-(l-s);return o=this,r=arguments,0>=c||c>t?(a&&(clearTimeout(a),a=null),s=l,i=e.apply(o,r),a||(o=r=null)):a||n.trailing===!1||(a=setTimeout(u,c)),i}},$.debounce=function(e,t,n){var o,r,i,a,s,u=function(){var l=$.now()-a;t>l&&l>=0?o=setTimeout(u,t-l):(o=null,n||(s=e.apply(i,r),o||(i=r=null)))};return function(){i=this,r=arguments,a=$.now();var l=n&&!o;return o||(o=setTimeout(u,t)),l&&(s=e.apply(i,r),i=r=null),s}},$.wrap=function(e,t){return $.partial(t,e)},$.negate=function(e){return function(){return!e.apply(this,arguments)}},$.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,o=e[t].apply(this,arguments);n--;)o=e[n].call(this,o);return o}},$.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},$.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},$.once=$.partial($.before,2);var D=!{toString:null}.propertyIsEnumerable("toString"),O=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];$.keys=function(e){if(!$.isObject(e))return[];if(v)return v(e);var t=[];for(var n in e)$.has(e,n)&&t.push(n);return D&&i(e,t),t},$.allKeys=function(e){if(!$.isObject(e))return[];var t=[];for(var n in e)t.push(n);return D&&i(e,t),t},$.values=function(e){for(var t=$.keys(e),n=t.length,o=Array(n),r=0;n>r;r++)o[r]=e[t[r]];return o},$.mapObject=function(e,t,n){t=_(t,n);for(var o,r=$.keys(e),i=r.length,a={},s=0;i>s;s++)o=r[s],a[o]=t(e[o],o,e);return a},$.pairs=function(e){for(var t=$.keys(e),n=t.length,o=Array(n),r=0;n>r;r++)o[r]=[t[r],e[t[r]]];return o},$.invert=function(e){for(var t={},n=$.keys(e),o=0,r=n.length;r>o;o++)t[e[n[o]]]=n[o];return t},$.functions=$.methods=function(e){var t=[];for(var n in e)$.isFunction(e[n])&&t.push(n);return t.sort()},$.extend=k($.allKeys),$.extendOwn=$.assign=k($.keys),$.findKey=function(e,t,n){t=_(t,n);for(var o,r=$.keys(e),i=0,a=r.length;a>i;i++)if(o=r[i],t(e[o],o,e))return o},$.pick=function(e,t,n){var o,r,i={},a=e;if(null==a)return i;$.isFunction(t)?(r=$.allKeys(a),o=w(t,n)):(r=E(arguments,!1,!1,1),o=function(e,t,n){return t in n},a=Object(a));for(var s=0,u=r.length;u>s;s++){var l=r[s],c=a[l];o(c,l,a)&&(i[l]=c)}return i},$.omit=function(e,t,n){if($.isFunction(t))t=$.negate(t);else{var o=$.map(E(arguments,!1,!1,1),String);t=function(e,t){return!$.contains(o,t)}}return $.pick(e,t,n)},$.defaults=k($.allKeys,!0),$.create=function(e,t){var n=S(e);return t&&$.extendOwn(n,t),n},$.clone=function(e){return $.isObject(e)?$.isArray(e)?e.slice():$.extend({},e):e},$.tap=function(e,t){return t(e),e},$.isMatch=function(e,t){var n=$.keys(t),o=n.length;if(null==e)return!o;for(var r=Object(e),i=0;o>i;i++){var a=n[i];if(t[a]!==r[a]||!(a in r))return!1}return!0};var P=function(e,t,n,o){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof $&&(e=e._wrapped),t instanceof $&&(t=t._wrapped);var r=p.call(e);if(r!==p.call(t))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var i="[object Array]"===r;if(!i){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,s=t.constructor;if(a!==s&&!($.isFunction(a)&&a instanceof a&&$.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],o=o||[];for(var u=n.length;u--;)if(n[u]===e)return o[u]===t;if(n.push(e),o.push(t),i){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!P(e[u],t[u],n,o))return!1}else{var l,c=$.keys(e);if(u=c.length,$.keys(t).length!==u)return!1;for(;u--;)if(l=c[u],!$.has(t,l)||!P(e[l],t[l],n,o))return!1}return n.pop(),o.pop(),!0};$.isEqual=function(e,t){return P(e,t)},$.isEmpty=function(e){return null==e?!0:A(e)&&($.isArray(e)||$.isString(e)||$.isArguments(e))?0===e.length:0===$.keys(e).length},$.isElement=function(e){return!(!e||1!==e.nodeType)},$.isArray=g||function(e){return"[object Array]"===p.call(e)},$.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},$.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){$["is"+e]=function(t){return p.call(t)==="[object "+e+"]"}}),$.isArguments(arguments)||($.isArguments=function(e){return $.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&($.isFunction=function(e){return"function"==typeof e||!1}),$.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},$.isNaN=function(e){return $.isNumber(e)&&e!==+e},$.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===p.call(e)},$.isNull=function(e){return null===e},$.isUndefined=function(e){return void 0===e},$.has=function(e,t){return null!=e&&f.call(e,t)},$.noConflict=function(){return a._=s,this},$.identity=function(e){return e},$.constant=function(e){return function(){return e}},$.noop=function(){},$.property=L,$.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},$.matcher=$.matches=function(e){return e=$.extendOwn({},e),function(t){return $.isMatch(t,e)}},$.times=function(e,t,n){var o=Array(Math.max(0,e));t=w(t,n,1);for(var r=0;e>r;r++)o[r]=t(r);return o},$.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},$.now=Date.now||function(){return(new Date).getTime()};var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},N=$.invert(M),U=function(e){var t=function(t){return e[t]},n="(?:"+$.keys(e).join("|")+")",o=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,o.test(e)?e.replace(r,t):e}};$.escape=U(M),$.unescape=U(N),$.result=function(e,t,n){var o=null==e?void 0:e[t];return void 0===o&&(o=n),$.isFunction(o)?o.call(e):o};var B=0;$.uniqueId=function(e){var t=++B+"";return e?e+t:t},$.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\u2028|\u2029/g,j=function(e){return"\\"+F[e]};$.template=function(e,t,n){!t&&n&&(t=n),t=$.defaults({},t,$.templateSettings);var o=RegExp([(t.escape||I).source,(t.interpolate||I).source,(t.evaluate||I).source].join("|")+"|$","g"),r=0,i="__p+='";e.replace(o,function(t,n,o,a,s){return i+=e.slice(r,s).replace(R,j),r=s+t.length,n?i+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":o?i+="'+\n((__t=("+o+"))==null?'':__t)+\n'":a&&(i+="';\n"+a+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var a=new Function(t.variable||"obj","_",i)}catch(s){throw s.source=i,s}var u=function(e){return a.call(this,e,$)},l=t.variable||"obj";return u.source="function("+l+"){\n"+i+"}",u},$.chain=function(e){var t=$(e);return t._chain=!0,t};var q=function(e,t){return e._chain?$(t).chain():t};$.mixin=function(e){$.each($.functions(e),function(t){var n=$[t]=e[t];$.prototype[t]=function(){var e=[this._wrapped];return d.apply(e,arguments),q(this,n.apply($,e))}})},$.mixin($),$.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=u[e];$.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],q(this,n)}}),$.each(["concat","join","slice"],function(e){var t=u[e];$.prototype[e]=function(){return q(this,t.apply(this._wrapped,arguments))}}),$.prototype.value=function(){return this._wrapped},$.prototype.valueOf=$.prototype.toJSON=$.prototype.value,$.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return $})}).call(this)},{}],51:[function(e,t,n){var o;o=function(e){var t;return t=function(e){return e.charAt().toUpperCase()+e.slice(1)},e.split(/[-\s_.,&]+/g).map(t).join("")},t.exports={toCamelCase:o}},{}]},{},[22]);
;!function(){function a(){return["Symbol","Arial","Courier New","Times New Roman","Georgia","Trebuchet MS","Verdana","Impact","Comic Sans MS","Webdings","Tahoma","Microsoft Sans Serif","Wingdings","Arial Black","Lucida Console","Marlett","Lucida Sans Unicode","Courier","Franklin Gothic Medium","Palatino Linotype","Sylfaen","Estrangelo Edessa","Tunga","Mangal","Raavi","Latha","Gautami","Shruti","MV Boli","Calibri","Cambria","Constantia","Candara","Corbel","Consolas","Cambria Math","Segoe UI","MS Mincho","Wingdings 2","Wingdings 3","Vrinda","Kartika","Century Gothic","Arial Narrow","Garamond","Book Antiqua","Bookman Old Style","MS Reference Sans Serif","MS Reference Specialty","Bookshelf Symbol 7","Monotype Corsiva","Meiryo","Arial Unicode MS","Century","Gabriola","Plantagenet Cherokee","Segoe Print","Segoe Script","Meiryo UI","MT Extra","SimSun","Batang","Gulim","MS PMincho","MS PGothic","MS Gothic","Mongolian Baiti","Microsoft Yi Baiti","PMingLiU","Microsoft Himalaya","SimHei","MingLiU","Segoe UI Light","Simplified Arabic","Cordia New","Miriam Fixed","EucrosiaUPC","Simplified Arabic Fixed","Rod","Angsana New","Narkisim","FrankRuehl","JasmineUPC","Dotum","DotumChe","IrisUPC","FreesiaUPC","GulimChe","LilyUPC","DilleniaUPC","Miriam","MS UI Gothic","Traditional Arabic","Levenim MT","David","KodchiangUPC","Iskoola Pota","SimSun-ExtB","BrowalliaUPC","Euphemia","CordiaUPC","Browallia New","AngsanaUPC","Nyala","NSimSun","Kalinga","GungsuhChe","MingLiU_HKSCS-ExtB","MingLiU_HKSCS","MingLiU-ExtB","PMingLiU-ExtB","BatangChe","Gungsuh","Aharoni","Andalus","Gisha","Microsoft Uighur","MoolBoran","DokChampa","DaunPenh","Microsoft Tai Le","Leelawadee","Malgun Gothic","Microsoft JhengHei","Microsoft YaHei","Arabic Typesetting","Segoe UI Semibold","Segoe UI Symbol","Ebrima","Khmer UI","Lao UI","FangSong","Microsoft New Tai Lue","KaiTi","Microsoft PhagsPa","Kokila","DFKai-SB","Sakkal Majalla","Utsaah","Shonar Bangla","Vani","Vijaya","Aparajita","Mistral","Haettenschweiler","MS Outlook","Lucida Sans","Lucida Handwriting","Lucida Bright","Freestyle Script","Juice ITC","Tempus Sans ITC","Kristen ITC","Stencil","Jokerman","Bell MT","Vivaldi","Cooper Black","Bauhaus 93","Harrington","Matura MT Script Capitals","Baskerville Old Face","Playbill","Modern No. 20","Colonna MT","Onyx","Britannic Bold","Bernard MT Condensed","Footlight MT Light","Papyrus","Wide Latin","Brush Script MT","Lucida Calligraphy","Lucida Fax","Centaur","Broadway","Californian FB","Berlin Sans FB Demi","Berlin Sans FB","Algerian","Old English Text MT","High Tower Text","Niagara Solid","Magneto","Poor Richard","Kunstler Script","Harlow Solid Italic","Viner Hand ITC","Informal Roman","Snap ITC","Bodoni MT Poster Compressed","Niagara Engraved","Showcard Gothic","Ravie","Parchment","Vladimir Script","Chiller","Century Schoolbook","Bradley Hand ITC","Franklin Gothic Book","French Script MT","Pristina","Copperplate Gothic Bold","Copperplate Gothic Light","Curlz MT","Edwardian Script ITC","Engravers MT","Rockwell","Rockwell Extra Bold","Perpetua","Arial Rounded MT Bold","Franklin Gothic Demi","Franklin Gothic Heavy","Franklin Gothic Demi Cond","Franklin Gothic Medium Cond","Gill Sans MT","Lucida Sans Typewriter","Felix Titling","Maiandra GD","Eras Light ITC","Goudy Old Style","Calisto MT","OCR A Extended","Blackadder ITC","Eras Demi ITC","Gloucester MT Extra Condensed","Imprint MT Shadow","Gill Sans Ultra Bold","Tw Cen MT","Perpetua Titling MT","Gigi","Agency FB","Script MT Bold","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Elephant","Castellar","Goudy Stout","Eras Medium ITC","Bodoni MT Condensed","Bodoni MT","Bodoni MT Black","Gill Sans Ultra Bold Condensed","Forte","Eras Bold ITC","Rockwell Condensed","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","Rage Italic","Palace Script MT","System","Terminal","Fixedsys","MS Sans Serif","Small Fonts","MS Serif","Modern","Roman","Script","Courier New CE","Times New Roman CE","Times New Roman Greek","Courier New Baltic","Arial CYR","Arial CE","Times New Roman TUR","Courier New Greek","Arial Baltic","Courier New TUR","Times New Roman CYR","Arial Greek","Arial TUR","Times New Roman Baltic","Courier New CYR","Times New Roman Cyr","Courier New Cyr","Arial Cyr","Calibri Light","Myriad Pro","Hobo Std","Trajan Pro","Minion Pro","Giddyup Std","Adobe Caslon Pro","Blackoak Std","Chaparral Pro","OCR A Std","Birch Std","Adobe Garamond Pro","Tekton Pro","Adobe Caslon Pro Bold","Cooper Std Black","Myriad Pro Cond","Adobe Garamond Pro Bold","Kozuka Mincho Pro EL","Myriad Pro Light","Kozuka Mincho Pro B","Kozuka Mincho Pro L","Kozuka Mincho Pro M","Kozuka Gothic Pro B","Kozuka Gothic Pro R","Kozuka Gothic Pro L","Kozuka Gothic Pro M","Kozuka Gothic Pro H","Kozuka Gothic Pro EL","Poplar Std","Kozuka Mincho Pro R","Kozuka Mincho Pro H","Letter Gothic Std","Brush Script Std","Mesquite Std","Stencil Std","Orator Std","Charlemagne Std","Prestige Elite Std","Rosewood Std Regular","Minion Pro Med","Minion Pro SmBd","Lithos Pro Regular","Tekton Pro Ext","Nueva Std Cond","Tekton Pro Cond","Minion Pro Cond","Arabic Transparent","Adobe Ming Std L","Adobe Song Std L","Adobe Fangsong Std R","Adobe Myungjo Std M","Adobe Kaiti Std R","Adobe Heiti Std R","Kozuka Mincho Pr6N H","Kozuka Gothic Pr6N R","Kozuka Gothic Pr6N M","Kozuka Mincho Pr6N EL","Kozuka Mincho Pr6N L","Kozuka Mincho Pr6N R","Kozuka Mincho Pr6N M","Kozuka Gothic Pr6N L","Kozuka Mincho Pr6N B","Kozuka Gothic Pr6N H","Kozuka Gothic Pr6N B","Kozuka Gothic Pr6N EL","Adobe Fan Heiti Std B","Adobe Gothic Std B","Adobe Hebrew","Adobe Arabic","Swis721 BT","Swis721 Lt BT","Swis721 Blk BT","OCR-A BT","OCR-B 10 BT","Eccentric Std","Bell Gothic Std Light","Bell Gothic Std Black","WP CyrillicA","WP CyrillicB","Futura Md BT","Nueva Std","Adobe Devanagari","Myriad Hebrew","Myriad Arabic","Freehand521 BT","Adobe Naskh Medium","Chaparral Pro Light","Swis721 Hv BT","WP Greek Courier","WP Greek Century","DejaVu Sans","WP Greek Helve","WP MultinationalA Roman","WP MultinationalB Courier","WP MultinationalB Roman","DejaVu Sans Mono","WP MultinationalA Helve","WP MultinationalB Helve","WP MultinationalA Courier","DejaVu Serif","OpenSymbol","Swis721 Cn BT","DejaVu Sans Light","Swis721 LtEx BT","Swis721 BlkCn BT","DejaVu Sans Condensed","DejaVu Serif Condensed","WP ArabicScript Sihafa","Arno Pro","WP Arabic Sihafa","WP Hebrew David","Arno Pro Light Display","Arno Pro Display","Arno Pro Smbd Caption","Arno Pro Caption","Arno Pro Subhead","Arno Pro SmText","Arno Pro Smbd Display","Arno Pro Smbd SmText","Arno Pro Smbd","Arno Pro Smbd Subhead","Bickham Script Pro Regular","Bickham Script Pro Semibold","Garamond Premr Pro","Garamond Premr Pro Smbd","Gentium Book Basic","Gentium Basic","GothicI","GothicE","BankGothic Lt BT","BankGothic Md BT","Bickham Script Two","ISOCTEUR","ISOCPEUR","Dutch801 Rm BT","CommercialScript BT","ScriptS","TeamViewer8","Swis721 BlkEx BT","Swis721 BdCnOul BT","Monotxt","GothicG","Swis721 Ex BT","Swis721 LtCn BT","RomanD","Dutch801 XBd BT","Txt","Vineta BT","GreekS","Monospac821 BT","ScriptC","CountryBlueprint","Complex","Swis721 BlkOul BT","GreekC","Simplex","ISOCP2","Technic","ISOCP3","Swis721 BdOul BT","ISOCP","TechnicBold","RomanS","WST_Engl","TechnicLite","RomanT","Romantic","Symeteo","WST_Fren","CityBlueprint","ISOCT2","Symath","ISOCT3","GDT","Syastro","Symap","ISOCT","RomanC","ItalicC","SansSerif","EuroRoman","Symusic","ItalicT","CommercialPi BT","Proxy 1","Proxy 2","WST_Czec","Proxy 6","Proxy 5","Proxy 4","Proxy 3","PanRoman","Italic","Stylus BT","Proxy 9","Proxy 8","WST_Germ","Proxy 7","SuperFrench","UniversalMath1 BT","WST_Ital","WST_Swed","WST_Span","AmdtSymbols","AMGDT","AcadEref","AIGDT","ZWAdobeF","Bickham Script One","Microsoft JhengHei UI","Amadeus","Microsoft YaHei UI","Copyist","Gadugi","Nirmala UI","Segoe UI Semilight","Ariston","Heather Script One","Carolina","Myriad Web Pro","Alexandra Script","Square721 BT","AnastasiaScript","GENISO","Calligraph","Ouverture script","Decor","Helvetica","Annabelle","Clarendon Lt BT","Clarendon Blk BT","Liberation Sans Narrow","Clarendon BT","Ceremonious Two","Eurostile"]}!function(a){a.fn.spotlight=function(b){var c=a.extend({},{opacity:.5,speed:400,color:"#333",easing:"ease-out",exitEvent:"click",onShow:function(){},onHide:function(){}},b);if(0==a("#spotlight").size()){var d=a('<div id="spotlight"></div>');d.css({position:"fixed",background:c.color,opacity:0,filter:"alpha(opacity=0)",top:0,left:0,right:0,bottom:0,"z-index":"9998"}),d.css("transition","opacity "+c.speed+"ms "+c.easing),d.appendTo(a("body")),d.css("opacity"),d.css("opacity",c.opacity),d.css("filter","alpha(opacity="+100*c.opacity+")");var e=a(this),f=e.css("position");"static"==f&&e.css("position","relative"),e.css("z-index","9999"),d.on(c.exitEvent,function(){d.css("opacity",0),d.css("filter","alpha(opacity=0)"),setTimeout(function(){"static"==f&&e.css("position","static"),e.css("z-index","1"),d.remove(),c.onHide.call(this)},c.speed)}),this.hideSpotlight=function(){d.trigger(c.exitEvent)}}return this}}(jQuery);var b=function(a){function j(a){var c=!1;for(var d in b){f.style.fontFamily=a+","+b[d],e.appendChild(f);var i=f.offsetWidth!=g[b[d]]||f.offsetHeight!=h[b[d]];e.removeChild(f),c=c||i}return c}a=void 0!==a?a:3;var b=["monospace","sans-serif","serif"];a>0&&4>a&&(b=b.slice(0,a));var c="mmmmmmmmmmlli",d="72px",e=document.getElementsByTagName("body")[0],f=document.createElement("span");f.style.fontSize=d,f.innerHTML=c;var g={},h={};for(var i in b)f.style.fontFamily=b[i],e.appendChild(f),g[b[i]]=f.offsetWidth,h[b[i]]=f.offsetHeight,e.removeChild(f);this.detect=j};void function(){var a;a=function(){function k(){var a;return a=new Date,c=a.getTime(),this.version="2.7.2",null!=("undefined"!=typeof Groupon&&null!=Groupon&&null!=Groupon.division?Groupon.division.id:void 0)?d=Groupon.division.id:null!=Cookie.get("division")&&(d=Cookie.get("division")),b=this._get_app_name(),k._should_show_doi()?void k._get_doi_modal_and_show("#333"):(a=new Date,"undefined"!=typeof OptimizeSuite&&null!=OptimizeSuite&&null!=OptimizeSuite.TrackingHub&&"function"==typeof OptimizeSuite.TrackingHub.add&&OptimizeSuite.TrackingHub.add("subscriptionUIdelegated",{goalType:"subscription",_useSDS:window._useSDS,totalLatency:a.getTime()-c}),f=window.location.href.indexOf("subs_force=")>-1,f&&null!=("undefined"!=typeof OptimizeSuite&&null!=OptimizeSuite?OptimizeSuite.TrackingHub:void 0)&&OptimizeSuite.TrackingHub.add("subscriptionUIForced",{goalType:"subscription"}),void(window._useSDS||this._should_not_show_subsUI()||this._show_subscribe_drawer()))}var a,b,c,d,e,f,g,h,i,j;return i=31536e4,e=3600,b=null,d="chicago",f=!1,c=0,h=0,g=0,j=["googlebot","bingbot","ask jeeves","yahoo! slurp","seoagent","AdsBot-Google","AdsBot-Google-Mobile","psbot","gosospider","sogou","google web preview","google wireless transcoder","mediapartners-google","baidu","gigabot","googlebot-image","libwww-perl","lwp-trivial","msnbot","siteuptime","slurp","teoma","uptakebot","voyager","wordpress","yahooseeker","zibb","zyborg","wget","curl"],k.increment_visited_cookie=function(){var a;return a=parseInt(Cookie.get("subscription_visited")),isNaN(a)?a=1:++a,Cookie.set("subscription_visited",a,i)},k.prototype.show_subscription_ui=function(){},k.prototype.show_user_initiated_modal_dialog=function(){},k.prototype.show_default_subscription_ui=function(){},k.prototype.run_subscription_experiment=function(){},k._should_show_doi=function(){return!("user_sessions"===b||"itier/subscription_center"===b||"sub_center"===b)&&!Cookie.get("subscription_doi_dismissed")&&(Cookie.get("optin")||Cookie.get("optin_reminder"))},k.prototype._show_subscribe_drawer=function(){var a;return Cookie.get("close_subscribe_drawer")?void 0:(a=$("#subscribe-division"),"false"===a.attr("data-options_decoded")&&(a.attr({"data-options_decoded":"true"}),$("#subscribe-division > option").each(function(){var a;return a=$(this).text().split("").reverse().join(""),$(this).text(a)})),$("#subscribe-drawer").show())},k.prototype._user_has_sub_cookie=function(){var a,b,c;c=("undefined"!=typeof I18n&&null!=I18n?I18n.country.toLowerCase():void 0)+"_nl_subscribed",b=["subscriber_email","scid","l","user_id","c","snickerdoodle","macaroon",c];for(var d=0,e=b.length;e>d;++d)if(a=b[d],Cookie.get(a))return!0;return!1},k.prototype._should_not_show_subsUI=function(){return f?!1:this._user_has_sub_cookie()||this._is_bot()||this._skip_subscription_ui()||this._is_email_click_traffic()?!0:Cookie.get("hide_sub_modal")&&this._should_hide_subscribe_drawer()?!0:"user_sessions"===b?!0:!1},k.prototype._should_hide_subscribe_drawer=function(){var a;return a=Cookie.get("close_subscribe_drawer")||Cookie.get("hide_sub_banner"),a?!0:"undefined"!=typeof subscriptionsUI_hideSubscribeDrawer&&null!=subscriptionsUI_hideSubscribeDrawer&&subscriptionsUI_hideSubscribeDrawer?"pull"===b||"gsm-ita"===b?!1:!0:void 0},k.prototype._is_email_click_traffic=function(){var a;return a=RegExp("[\\?&]utm_medium=([^&#]*)").exec(window.location.href),null!=a&&null!=a[1]&&"email"===a[1].toLowerCase()||"email"===Cookie.get("_tpmed")?!0:!1},k.prototype._skip_subscription_ui=function(){return RegExp("[\\?&]z=skip").test(window.location.href)?!0:void 0},a=function(a,b){return a.toUpperCase().indexOf(b.toUpperCase())>-1},k.prototype._is_bot=function(){var b,c;if(c=navigator.userAgent)for(var d=0,e=j.length;e>d;++d)if(b=j[d],a(c,b))return!0;return!1},k.prototype._get_page_info=function(){var a;return a={},null!=$("head").attr("data-app")&&$("head").attr("data-app").length>0?a.app=encodeURIComponent($("head").attr("data-app")):null!=("undefined"!=typeof Optimize&&null!=Optimize&&null!=Optimize.suiteData?Optimize.suiteData.app:void 0)&&("undefined"!=typeof Optimize&&null!=Optimize&&null!=Optimize.suiteData?Optimize.suiteData.app.length:void 0)>0&&(a.app=encodeURIComponent(Optimize.suiteData.app)),a},k.prototype._get_app_name=function(){var a;return a=this._get_page_info().app,b=null!=a?a.toLowerCase():null},k.prototype._dismiss_subscribe_modal=function(a){return a.hide(),a.hideSpotlight&&a.hideSpotlight()},k._get_doi_modal_and_show=function(a){var b,d,f;return f="/app/subscriptions/doi",d=new Date,h=d.getTime(),b=$.get(f,function(b){var f;return d=new Date,g=d.getTime(),f=$('<div id="subscribe_doi_modal_container" />'),f.css({display:"none",position:"fixed","z-index":"9999"}),f.html(b),$(document.body).append(f),$("#no_doi").length>0?void 0:setTimeout(function(){var b,i,j,l;return i=f.width(),b=f.height(),j=($(window).width()-i)/2,l=($(window).height()-b)/2,a=null!=a?a:"#eee",f.css({top:l,left:j}),f.show(),f.spotlight({opacity:.7,color:a,exitEvent:"none"}),d=new Date,null!=("undefined"!=typeof OptimizeSuite&&null!=OptimizeSuite?OptimizeSuite.TrackingHub:void 0)&&OptimizeSuite.TrackingHub.add("subscriptionDOIDialogShown",{goalType:"subscription",uiType:"modal-dialog",loadingLatency:g-h,totalLatency:d.getTime()-c}),$("#doi_dlg").on("dismiss",function(){return k._dismiss_subscribe_modal(f),Cookie.set("subscription_doi_dismissed",!0,e),null!=("undefined"!=typeof OptimizeSuite&&null!=OptimizeSuite?OptimizeSuite.TrackingHub:void 0)?OptimizeSuite.TrackingHub.add("subscriptionDOIDialogHidden",{goalType:"subscription",uiType:"modal-dialog"}):void 0})},500)})},k}(),window.SubscriptionsUI=a,window.SubscriptionsUI.increment_visited_cookie()}.call(this),function(a,b,c){"undefined"!=typeof module&&module.exports?module.exports=c():"function"==typeof define&&define.amd?define(c):b[a]=c()}("Fingerprint",this,function(){"use strict";var c=function(a){var b,c;b=Array.prototype.forEach,c=Array.prototype.map,this.each=function(a,c,d){if(null!==a)if(b&&a.forEach===b)a.forEach(c,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(c.call(d,a[e],e,a)==={})return}else for(var g in a)if(a.hasOwnProperty(g)&&c.call(d,a[g],g,a)==={})return},this.map=function(a,b,d){var e=[];return null==a?e:c&&a.map===c?a.map(b,d):(this.each(a,function(a,c,f){e[e.length]=b.call(d,a,c,f)}),e)},"object"==typeof a?(this.hasher=a.hasher,this.screen_resolution=a.screen_resolution,this.canvas=a.canvas,this.ie_activex=a.ie_activex,this.css_fonts=a.css_fonts):"function"==typeof a&&(this.hasher=a)};return c.prototype={get:function(){var a=[];if(a.push(navigator.userAgent),a.push(navigator.language),a.push(screen.colorDepth),this.screen_resolution){var b=this.getScreenResolution();void 0!==b&&a.push(this.getScreenResolution().join("x"))}return a.push((new Date).getTimezoneOffset()),a.push(this.hasSessionStorage()),a.push(this.hasLocalStorage()),a.push(!!window.indexedDB),document.body?a.push(typeof document.body.addBehavior):a.push("undefined"),a.push(typeof window.openDatabase),a.push(navigator.cpuClass),a.push(navigator.platform),a.push(navigator.doNotTrack),a.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&a.push(this.getCanvasFingerprint()),this.css_fonts&&a.push(this.getCSSFontDetection(this.css_fonts)),this.hasher?this.hasher(a.join("###"),31):this.murmurhash3_32_gc(a.join("###"),31)},murmurhash3_32_gc:function(a,b){var c,d,e,f,g,h,i,j;for(c=3&a.length,d=a.length-c,e=b,g=3432918353,h=461845907,j=0;d>j;)i=255&a.charCodeAt(j)|(255&a.charCodeAt(++j))<<8|(255&a.charCodeAt(++j))<<16|(255&a.charCodeAt(++j))<<24,++j,i=(65535&i)*g+(((i>>>16)*g&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*h+(((i>>>16)*h&65535)<<16)&4294967295,e^=i,e=e<<13|e>>>19,f=5*(65535&e)+((5*(e>>>16)&65535)<<16)&4294967295,e=(65535&f)+27492+(((f>>>16)+58964&65535)<<16);switch(i=0,c){case 3:i^=(255&a.charCodeAt(j+2))<<16;case 2:i^=(255&a.charCodeAt(j+1))<<8;case 1:i^=255&a.charCodeAt(j),i=(65535&i)*g+(((i>>>16)*g&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*h+(((i>>>16)*h&65535)<<16)&4294967295,e^=i}return e^=a.length,e^=e>>>16,e=2246822507*(65535&e)+((2246822507*(e>>>16)&65535)<<16)&4294967295,e^=e>>>13,e=3266489909*(65535&e)+((3266489909*(e>>>16)&65535)<<16)&4294967295,e^=e>>>16,e>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(a){return!0}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(a){return!0}},isCanvasSupported:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))},isIE:function(){return"Microsoft Internet Explorer"===navigator.appName?!0:"Netscape"===navigator.appName&&/Trident/.test(navigator.userAgent)?!0:!1},getPluginsString:function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},getRegularPluginsString:function(){return this.map(navigator.plugins,function(a){var b=this.map(a,function(a){return[a.type,a.suffixes].join("~")}).join(",");return[a.name,a.description,b].join("::")},this).join(";")},getIEPluginsString:function(){if(window.ActiveXObject){var a=new IEActiveXHandler;return a.detect()}return""},getScreenResolution:function(){return[screen.height,screen.width]},getCanvasFingerprint:function(){var a=document.createElement("canvas"),b=a.getContext("2d"),c="http://valve.github.io";return b.textBaseline="top",b.font="14px 'Arial'",b.textBaseline="alphabetic",b.fillStyle="#f60",b.fillRect(125,1,62,20),b.fillStyle="#069",b.fillText(c,2,15),b.fillStyle="rgba(102, 204, 0, 0.7)",b.fillText(c,4,17),a.toDataURL()},getCSSFontDetection:function(c){var d=new b(c),e=new a;return this.map(e,function(a){return d.detect(a)?a:""}).join(";")}},c}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};null==window.Groupon&&(window.Groupon={}),Groupon.FingerprintFrontendInterface=function(){function c(){this._current_time_in_millis=a(this._current_time_in_millis,this),this._log_track_call=a(this._log_track_call,this),this._computeAttrHash=a(this._computeAttrHash,this),this.getAttrHash=a(this.getAttrHash,this),this.track=a(this.track,this),this.version="0.1.0"}var b;return b=600,c.prototype.track=function(){var a,c,d,e,f,g;return a=Cookie.get("ah"),a?void 0:(e=this._computeAttrHash(),a=e.attributeHashes,g=e.v1,d=e.hashDuration,c={attributeHashes:a,b:Cookie.get("b"),c:Cookie.get("c")},f=this._current_time_in_millis(),$.ajax({method:"POST",url:"/app/subscriptions/fingerprint/v2/track",data:c,cache:!1,timeout:1e3,success:function(e){return function(h){var i;return Cookie.set("ah",a,b),Cookie.set("f",g,b),i=e._current_time_in_millis()-f,$.extend(c,{hashDuration:d,latency:i,data:h}),e._log_track_call("success",c)}}(this),error:function(a){return function(b,e){var g;return g=a._current_time_in_millis()-f,$.extend(c,{hashDuration:d,latency:g,errorStatus:e}),a._log_track_call("error",c)}}(this)}))},c.prototype.getAttrHash=function(){var a;return a=Cookie.get("ah"),a||(a=this._computeAttrHash().attributeHashes),a},c.prototype._computeAttrHash=function(){var a,b,c,d,e,f,g,h;return c=this._current_time_in_millis(),g=new Fingerprint({hasher:md5,canvas:!0,screen_resolution:!0}).get(),h=new Fingerprint({canvas:!0,screen_resolution:!0}).get(),d={v1:g,v2:h},a=function(){var a;a=[];for(e in d)f=d[e],a.push(e+":"+f);return a}().join(",").toLowerCase(),b=this._current_time_in_millis()-c,{attributeHashes:a,v1:g,hashDuration:b}},c.prototype._log_track_call=function(a,b){var c,d;return c="subscription",$.extend(b,{goalType:c,callResult:a}),"undefined"!=typeof OptimizeSuite&&null!==OptimizeSuite&&null!=(d=OptimizeSuite.TrackingHub)?d.add("subscriptionTrackCall",b):void 0},c.prototype._current_time_in_millis=function(){return(new Date).getTime()},c}(),Groupon.fingerprintFrontendInstance=new Groupon.FingerprintFrontendInterface,Groupon.fingerprintFrontendInstance.track()}.call(this)}();

