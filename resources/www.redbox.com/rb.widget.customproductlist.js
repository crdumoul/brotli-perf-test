rb.registerNamespace("rb.widget");rb.widget.customproductlist=rb.widget.base.extend({get_numberOfTitlesPerLine:function(){return this._numberOfTitlesPerLine},set_numberOfTitlesPerLine:function(a){this._numberOfTitlesPerLine=a},get_numberOfProducts:function(){return this._numberOfProducts},set_numberOfProducts:function(a){this._numberOfProducts=a},get_useGridView:function(){return this._useGridView},set_useGridView:function(a){this._useGridView=a},get_useTextView:function(){return this._useTextView},set_useTextView:function(a){this._useTextView=a},init:function(){this._super();this._header=null;this._widget=null;this._swipeContainer=null;this._numberOfTitlesPerLineMobile=3;this._numberOfTitlesPerLine=null;this._numberOfProducts=null;this._useGridView=false;this._useTextView=false;this._currentPage=1;this._mySwiper=null;this._productViewRollupWidget=null;this._inMobile=false;this._delegates={onArrowClick:rb.createDelegate(this,this._onArrowClick),onItemsRendered:rb.createDelegate(this,this._setupContainerSizes),onResize:rb.createDelegate(this,this._setupContainerSizes)}},_onLoad:function(b,a){this._super(b,a);this._widget=this.getControl("Widget");this._header=this.getControl("Header");this._seeAllLink=this.getControl("SeeAllLink");this._swipeContainer=this.getControl("SwipeContainer");this._productViewRollupWidget=this.findChildWidget("ProductListRollup").findChildWidget("ProductViewRollup");this._productViewRollupWidget.addItemsRendered(this._delegates.onItemsRendered);if(this._numberOfProducts<this._numberOfTitlesPerLine){this._numberOfProducts=this._numberOfTitlesPerLine}this._swipeContainer.addClass(this._id);this._initializeEnquire();this._swipeContainer.find(".arrow-left").click([{direction:"left"}],this._delegates.onArrowClick);this._swipeContainer.find(".arrow-right").click([{direction:"right"}],this._delegates.onArrowClick);$(window).on("resize",this._delegates.onResize);this._initSwiper()},_onResize:function(){this._setupContainerSizes()},_initSwiper:function(){this._setupContainerSizes();if(this._useGridView||this._useTextView){return}if(this._mySwiper&&this._mySwiper.destroy){this._mySwiper.destroy()}var a=this;this._mySwiper=$("."+this._id).swiper({onTouchEnd:function(){a._onAnimationEnd()},onMomentumBounce:function(){a._onAnimationEnd()},onResistanceAfter:function(){a._onAnimationEnd()},speed:200,resizeReInit:false,scrollContainer:true,cssWidthAndHeight:true})},_verticalToHorizontal:function(){var b=$("body").find(".custom-product-list:visible").not(".vertical-list").last();if(this._useTextView&&b.length>0){var a=this._widget.detach();b.after(a)}},_horizontalToVertical:function(){var a=$("body").find(".custom-product-list.coming-soon");if(this._useTextView&&a.length>0){var b=this._widget.detach();a.before(b)}},_initializeEnquire:function(){if(enquire){var a=this;enquire.register("screen and (max-width: 719px)",[{match:function(){a._inMobile=true;a._initSwiper();a._verticalToHorizontal()}}]).fire().listen();enquire.register("screen and (min-width: 720px) and (max-width: 1199px)",[{match:function(){a._inMobile=false;a._initSwiper();a._verticalToHorizontal()}}]).fire().listen();enquire.register("screen and (min-width: 1200px)",[{match:function(){a._inMobile=false;a._initSwiper();a._horizontalToVertical()}}]).fire().listen()}},_getApproxTranslateValue:function(){var a=this._inMobile?this._numberOfTitlesPerLineMobile:this._numberOfTitlesPerLine;var b=this._widget.width()/a;return(this._numberOfProducts-a)*b*-1},_onAnimationEnd:function(){var b=this._swipeContainer.find(".arrows");var a=this._getApproxTranslateValue();if(a==0){b.hide();return}if(this._useGridView||this._useTextView){return}var d=this;setTimeout(function(){if(a==0){b.hide();return}var g=10;var f=d._mySwiper.getWrapperTranslate();var e=Math.abs(f-a);if(e<g||f<a){d._swipeContainer.find(".arrow-left").show();d._swipeContainer.find(".arrow-right").hide()}else{if(f==0){d._swipeContainer.find(".arrow-left").hide();d._swipeContainer.find(".arrow-right").show()}else{if(f>a){d._swipeContainer.find(".arrow-left").show();d._swipeContainer.find(".arrow-right").show()}}}},500);var c=this._widget.find(".box-wrapper img").height();b.css("margin-top",c/2-b.height()/2)},_onArrowClick:function(a){var b=a.data[0].direction;this._scrollToPage(b,"0.3s")},_setupContainerSizes:function(){if(this._header){this._header.show()}if(this._useTextView&&this._seeAllLink){this._seeAllLink.show()}if(this.findChildWidget("ProductListRollup")&&this.findChildWidget("ProductListRollup")._widget){this.findChildWidget("ProductListRollup")._widget.show()}var b=this._inMobile?this._numberOfTitlesPerLineMobile:this._numberOfTitlesPerLine;var c=this._widget.width()/b;var a=c*this._numberOfProducts;if(!this._useGridView&&!this._useTextView){this._widget.find(".box-wrapper").width(c);this._widget.find(".product-container").width(a)}this._onAnimationEnd()},_scrollToPage:function(b,c){var a=this._mySwiper.getWrapperTranslate();var d=a+this._widget.width()*(b=="right"?-1:1);if(d>0){d=0}if(Modernizr.csstransforms){this._swipeContainer.find(".swiper-wrapper").css({transition:c,"-webkit-transition":c,transform:"translate3d("+d.toString()+"px, 0px, 0px)",transform3d:"translate3d("+d.toString()+"px, 0px, 0px)","-ms-transform":"translate("+d.toString()+"px, 0px)","-webkit-transform":"translate3d("+d.toString()+"px, 0px, 0px)"})}else{this._swipeContainer.find(".swiper-wrapper").css({left:d.toString()+"px"})}this._onAnimationEnd()}});