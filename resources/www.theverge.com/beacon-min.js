if(typeof phonographQueue==="undefined"){var phonographQueue=[]}if(typeof phonograph==="undefined"){var phonograph={pixelSrc:"https://m3jnlukh12.execute-api.us-east-1.amazonaws.com/prod/needle",cookieDomain:"voxmedia.com",cookieName:"chorus_beacon",thirdPartyPageHost:"phonograph-static.voxmedia.com",thirdPartyPagePath:"/thirdpartyisthecoolestparty.html",uuid:null,domainSpecificUuid:null,poller:null,generateUUID:function(){var c=window.crypto||window.msCrypto,b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",a=new RegExp(/[xy]/g);if(typeof(c)!="undefined"&&typeof(c.getRandomValues)!="undefined"){return b.replace(a,function(f){var e=c.getRandomValues(new Uint8Array(1))[0]%16|0,d=f=="x"?e:(e&3|8);return d.toString(16)})}return b.replace(a,function(f){var e=Math.random()*16|0,d=f=="x"?e:(e&3|8);return d.toString(16)})},getCookie:function(b){var a=(new RegExp("(?:^|; )"+encodeURIComponent(b)+"=([^;]*)")).exec(document.cookie);return a?a[1]:null},getUUIDCookie:function(){return this.getCookie(this.cookieName)||localStorage.getItem(this.cookieName)},setCookie:function(b,e,c){var a=(new Date((new Date).getTime()+63072000000)).toGMTString();var d=e+"="+b+"; expires="+a+"; path=/";if(c!==undefined){d+="; domain="+c}document.cookie=d;return this.getCookie(e)},loadUUIDFromCookie:function(b){var a=this.getUUIDCookie();if(a!=null){return a}return this.setCookie(this.generateUUID(),this.cookieName,b)},loadUUID:function(){this.uuid=this.getUUIDCookie()||this.setCookie(this.generateUUID(),this.cookieName,this.cookieDomain)||this.loadUUIDFromIframe()||this.setCookie(this.generateUUID(),this.cookieName)},loadUUIDFromIframe:function(){if(window.postMessage){var a=document.getElementsByTagName("body")[0],b=null,c=this;this.addEvent("message",function(e){var d=e.origin.split("/").slice(-1)[0];if(c.thirdPartyPageHost.indexOf(d)!=-1&&("uuid" in e.data)){c.uuid=e.data.uuid;c.setCookie(c.uuid,c.cookieName)}});b=document.createElement("iframe");b.style.display="none";b.setAttribute("src","//"+this.thirdPartyPageHost+this.thirdPartyPagePath);a.appendChild(b);return this.uuid}return null},addEvent:function(b,a){if(window.addEventListener){window.addEventListener(b,a,false)}else{window.attachEvent("on"+b,a)}},flatten:function(d){var a={};for(var b in d){if(d[b]===null){continue}if((typeof d[b])=="object"){var e=this.flatten(d[b]);for(var c in e){if(e.hasOwnProperty(c)){a[b+"."+c]=e[c]}}}else{a[b]=d[b]}}return a},createIFrame:function(b){try{iframe=document.createElement('<iframe name="'+b+'">')}catch(a){iframe=document.createElement("iframe");iframe.setAttribute("name",b)}iframe.style.display="none";return iframe},getBody:function(a){return a.body||a.getElementsByTagName("body")[0]},createPostRequest:function(g,c){var a=this.getBody(document);var h="phonograph-"+(new Date()).getTime();var e=this.createIFrame(h);var f=document.createElement("form");f.style.display="none";f.setAttribute("method","POST");f.setAttribute("action",c);f.setAttribute("target",h);for(var d in g){var b=document.createElement("input");b.setAttribute("type","text");b.setAttribute("name",d);b.setAttribute("value",g[d]);f.appendChild(b)}a.appendChild(f);a.appendChild(e);f.submit();return h},getRequestURL:function(a){var b=this.pixelSrc+"?";for(name in a){b+=encodeURIComponent(name)+"="+encodeURIComponent(a[name])+"&"}b+="_="+Math.random();return b},sendGetRequest:function(b){var a=document.createElement("img");a.style.height=1;a.style.width=1;a.src=b},extractData:function(a){var b={};b.data=(a.length>1)?JSON.stringify(a[1]):"";b.event=a[0];b.uid=this.uuid;b.suid=this.domainSpecificUuid;b.ref=document.referrer;return b},send:function(a){var b=this.extractData(a);var c=this.getRequestURL(b);if(c.length>=2048){return this.createPostRequest(b,this.pixelSrc)}else{this.sendGetRequest(c)}return c},stop:function(){if(this.poller){clearInterval(this.poller);this.poller=null}},start:function(){var a=this;this.stop();this.loadUUID();this.domainSpecificUuid=this.getCookie("domainSpecificUUID")||this.setCookie(this.generateUUID(),"domainSpecificUUID");setTimeout(function(){if(!a.uuid){a.uuid="unknown"}},3000);this.poller=setInterval(function(){while(phonographQueue.length&&a.uuid!=null){a.send(phonographQueue.shift())}},300)}};if((window.location.hostname+window.location.pathname)!=(phonograph.thirdPartyPageHost+phonograph.thirdPartyPagePath)){phonograph.start()}};